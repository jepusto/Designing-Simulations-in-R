<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Estimation procedures | Designing Monte Carlo Simulations in R</title>
  <meta name="description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Estimation procedures | Designing Monte Carlo Simulations in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="github-repo" content="jepusto/Designing-Simulations-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Estimation procedures | Designing Monte Carlo Simulations in R" />
  
  <meta name="twitter:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  

<meta name="author" content="Luke W. Miratrix and James E. Pustejovsky (Equal authors)" />


<meta name="date" content="2024-07-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap-DGP.html"/>
<link rel="next" href="running-the-simulation-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Designing Simulations in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#some-of-simulations-many-uses"><i class="fa fa-check"></i><b>1.1</b> Some of simulation’s many uses</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#comparing-statistical-approaches"><i class="fa fa-check"></i><b>1.1.1</b> Comparing statistical approaches</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#assessing-performance-of-complex-pipelines"><i class="fa fa-check"></i><b>1.1.2</b> Assessing performance of complex pipelines</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#assessing-performance-under-misspecification"><i class="fa fa-check"></i><b>1.1.3</b> Assessing performance under misspecification</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#assessing-the-finite-sample-performance-of-a-statistical-approach"><i class="fa fa-check"></i><b>1.1.4</b> Assessing the finite sample performance of a statistical approach</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#conducting-power-analyses"><i class="fa fa-check"></i><b>1.1.5</b> Conducting Power Analyses</a></li>
<li class="chapter" data-level="1.1.6" data-path="introduction.html"><a href="introduction.html#simulating-processess"><i class="fa fa-check"></i><b>1.1.6</b> Simulating processess</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-perils-of-simulation-as-evidence"><i class="fa fa-check"></i><b>1.2</b> The perils of simulation as evidence</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#simulation-hacking"><i class="fa fa-check"></i><b>1.3</b> Simulation-hacking</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#simulating-to-learn"><i class="fa fa-check"></i><b>1.4</b> Simulating to learn</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#organization-of-the-text"><i class="fa fa-check"></i><b>1.5</b> Organization of the text</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html"><i class="fa fa-check"></i><b>2</b> Programming Preliminaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#why-r"><i class="fa fa-check"></i><b>2.1</b> Why R?</a></li>
<li class="chapter" data-level="2.2" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#welcome-to-the-tidyverse"><i class="fa fa-check"></i><b>2.2</b> Welcome to the tidyverse</a></li>
<li class="chapter" data-level="2.3" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#functions"><i class="fa fa-check"></i><b>2.3</b> Functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#rolling-your-own"><i class="fa fa-check"></i><b>2.3.1</b> Rolling your own</a></li>
<li class="chapter" data-level="2.3.2" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#a-dangerous-function"><i class="fa fa-check"></i><b>2.3.2</b> A dangerous function</a></li>
<li class="chapter" data-level="2.3.3" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#function-skeletons"><i class="fa fa-check"></i><b>2.3.3</b> Function skeletons</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#pipe-dreams"><i class="fa fa-check"></i><b>2.4</b> <code>%&gt;%</code> (Pipe) dreams</a></li>
<li class="chapter" data-level="2.5" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#recipes-versus-patterns"><i class="fa fa-check"></i><b>2.5</b> Recipes versus Patterns</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html"><i class="fa fa-check"></i><b>3</b> An initial simulation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulating-a-single-scenario"><i class="fa fa-check"></i><b>3.1</b> Simulating a single scenario</a></li>
<li class="chapter" data-level="3.2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#a-non-normal-population-distribution"><i class="fa fa-check"></i><b>3.2</b> A non-normal population distribution</a></li>
<li class="chapter" data-level="3.3" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulating-across-different-scenarios"><i class="fa fa-check"></i><b>3.3</b> Simulating across different scenarios</a></li>
<li class="chapter" data-level="3.4" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#extending-the-simulation-design"><i class="fa fa-check"></i><b>3.4</b> Extending the simulation design</a></li>
<li class="chapter" data-level="3.5" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#exercises"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
<li class="chapter" data-level="3.6" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#challenges"><i class="fa fa-check"></i><b>3.6</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html"><i class="fa fa-check"></i><b>4</b> Structure of a simulation study</a>
<ul>
<li class="chapter" data-level="4.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#general-structure-of-a-simulation"><i class="fa fa-check"></i><b>4.1</b> General structure of a simulation</a></li>
<li class="chapter" data-level="4.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#tidy-simulations"><i class="fa fa-check"></i><b>4.2</b> Tidy simulations</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#the-data-generating-process-dgp"><i class="fa fa-check"></i><b>4.2.1</b> The Data Generating Process (DGP)</a></li>
<li class="chapter" data-level="4.2.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#estimation-procedures"><i class="fa fa-check"></i><b>4.2.2</b> Estimation procedures</a></li>
<li class="chapter" data-level="4.2.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#repetition"><i class="fa fa-check"></i><b>4.2.3</b> Repetition</a></li>
<li class="chapter" data-level="4.2.4" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#performance-summaries"><i class="fa fa-check"></i><b>4.2.4</b> Performance summaries</a></li>
<li class="chapter" data-level="4.2.5" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#why-the-tidy-approach"><i class="fa fa-check"></i><b>4.2.5</b> Why the tidy approach?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#multiple-scenarios"><i class="fa fa-check"></i><b>4.3</b> Multiple Scenarios</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="case-ANOVA.html"><a href="case-ANOVA.html"><i class="fa fa-check"></i><b>5</b> Case Study: Heteroskedastic ANOVA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#the-data-generating-model"><i class="fa fa-check"></i><b>5.1</b> The data-generating model</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#coding-remark"><i class="fa fa-check"></i><b>5.1.1</b> Coding remark</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="case-ANOVA.html"><a href="case-ANOVA.html#the-estimation-procedures"><i class="fa fa-check"></i><b>5.2</b> The estimation procedures</a></li>
<li class="chapter" data-level="5.3" data-path="case-ANOVA.html"><a href="case-ANOVA.html#running-the-simulation"><i class="fa fa-check"></i><b>5.3</b> Running the simulation</a></li>
<li class="chapter" data-level="5.4" data-path="case-ANOVA.html"><a href="case-ANOVA.html#analyzing-the-simulation"><i class="fa fa-check"></i><b>5.4</b> Analyzing the Simulation</a></li>
<li class="chapter" data-level="5.5" data-path="case-ANOVA.html"><a href="case-ANOVA.html#exAnovaExercises"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap-DGP.html"><a href="chap-DGP.html"><i class="fa fa-check"></i><b>6</b> Data-Generating Processes (DGPs)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chap-DGP.html"><a href="chap-DGP.html#a-statistical-model-is-a-recipe-for-data-generation"><i class="fa fa-check"></i><b>6.1</b> A statistical model is a recipe for data generation</a></li>
<li class="chapter" data-level="6.2" data-path="chap-DGP.html"><a href="chap-DGP.html#checking-the-data-generating-function"><i class="fa fa-check"></i><b>6.2</b> Checking the data-generating function</a></li>
<li class="chapter" data-level="6.3" data-path="chap-DGP.html"><a href="chap-DGP.html#case-cluster"><i class="fa fa-check"></i><b>6.3</b> Example: Simulating clustered data</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chap-DGP.html"><a href="chap-DGP.html#a-design-decision-what-do-we-want-to-manipulate"><i class="fa fa-check"></i><b>6.3.1</b> A design decision: What do we want to manipulate?</a></li>
<li class="chapter" data-level="6.3.2" data-path="chap-DGP.html"><a href="chap-DGP.html#a-model-for-a-cluster-rct"><i class="fa fa-check"></i><b>6.3.2</b> A model for a cluster RCT</a></li>
<li class="chapter" data-level="6.3.3" data-path="chap-DGP.html"><a href="chap-DGP.html#converting-our-model-to-code"><i class="fa fa-check"></i><b>6.3.3</b> Converting our model to code</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chap-DGP.html"><a href="chap-DGP.html#exercises-1"><i class="fa fa-check"></i><b>6.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="chap-DGP.html"><a href="chap-DGP.html#ex_dgp"><i class="fa fa-check"></i><b>6.4.1</b> The Welch test on a shifted-and-scaled <span class="math inline">\(t\)</span> distribution</a></li>
<li class="chapter" data-level="6.4.2" data-path="chap-DGP.html"><a href="chap-DGP.html#checking-and-extending-the-cluster-rct-dgp"><i class="fa fa-check"></i><b>6.4.2</b> Checking and extending the Cluster RCT DGP</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="chap-DGP.html"><a href="chap-DGP.html#extension-standardization-in-a-data-generating-process"><i class="fa fa-check"></i><b>6.5</b> Extension: Standardization in a data generating process</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html"><i class="fa fa-check"></i><b>7</b> Estimation procedures</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#validating-estimation-procedures"><i class="fa fa-check"></i><b>7.1</b> Validating Estimation Procedures</a></li>
<li class="chapter" data-level="7.2" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#checking-via-simulation"><i class="fa fa-check"></i><b>7.2</b> Checking via simulation</a></li>
<li class="chapter" data-level="7.3" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#including-multiple-estimation-procedures"><i class="fa fa-check"></i><b>7.3</b> Including Multiple estimation procedures</a></li>
<li class="chapter" data-level="7.4" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#exercises-2"><i class="fa fa-check"></i><b>7.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#more-welch-and-adding-the-bff-test"><i class="fa fa-check"></i><b>7.4.1</b> More Welch and adding the BFF test</a></li>
<li class="chapter" data-level="7.4.2" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#more-estimators-for-cluster-randomized-trials"><i class="fa fa-check"></i><b>7.4.2</b> More estimators for Cluster Randomized Trials</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html"><i class="fa fa-check"></i><b>8</b> Running the Simulation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html#writing-simulations-quick-with-the-simhelpers-package"><i class="fa fa-check"></i><b>8.1</b> Writing simulations quick with the simhelpers package</a></li>
<li class="chapter" data-level="8.2" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html#adding-checks-and-balances"><i class="fa fa-check"></i><b>8.2</b> Adding Checks and Balances</a></li>
<li class="chapter" data-level="8.3" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html#exercises-3"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="performance-criteria.html"><a href="performance-criteria.html"><i class="fa fa-check"></i><b>9</b> Performance criteria</a>
<ul>
<li class="chapter" data-level="9.1" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-vs.-estimation"><i class="fa fa-check"></i><b>9.1</b> Inference vs. Estimation</a></li>
<li class="chapter" data-level="9.2" data-path="performance-criteria.html"><a href="performance-criteria.html#ways-of-assessing-and-comparing-estimation-procedures"><i class="fa fa-check"></i><b>9.2</b> Ways of Assessing and Comparing Estimation Procedures</a></li>
<li class="chapter" data-level="9.3" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-point-estimator"><i class="fa fa-check"></i><b>9.3</b> Assessing a Point Estimator</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="performance-criteria.html"><a href="performance-criteria.html#comparing-the-performances-of-the-cluster-rct-estimation-procedures"><i class="fa fa-check"></i><b>9.3.1</b> Comparing the Performances of the Cluster RCT Estimation Procedures</a></li>
<li class="chapter" data-level="9.3.2" data-path="performance-criteria.html"><a href="performance-criteria.html#handling-estimands-not-represented-by-a-parameter"><i class="fa fa-check"></i><b>9.3.2</b> Handling Estimands Not Represented By a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-standard-error-estimator"><i class="fa fa-check"></i><b>9.4</b> Assessing a Standard Error Estimator</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="performance-criteria.html"><a href="performance-criteria.html#why-not-assess-the-estimated-se-directly"><i class="fa fa-check"></i><b>9.4.1</b> Why Not Assess the Estimated SE directly?</a></li>
<li class="chapter" data-level="9.4.2" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-ses-for-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>9.4.2</b> Assessing SEs for Our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-an-inferential-procedure-hypothesis-testing"><i class="fa fa-check"></i><b>9.5</b> Assessing an Inferential Procedure (Hypothesis Testing)</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="performance-criteria.html"><a href="performance-criteria.html#validity"><i class="fa fa-check"></i><b>9.5.1</b> Validity</a></li>
<li class="chapter" data-level="9.5.2" data-path="performance-criteria.html"><a href="performance-criteria.html#power"><i class="fa fa-check"></i><b>9.5.2</b> Power</a></li>
<li class="chapter" data-level="9.5.3" data-path="performance-criteria.html"><a href="performance-criteria.html#the-rejection-rate"><i class="fa fa-check"></i><b>9.5.3</b> The Rejection Rate</a></li>
<li class="chapter" data-level="9.5.4" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-in-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>9.5.4</b> Inference in our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-confidence-intervals"><i class="fa fa-check"></i><b>9.6</b> Assessing Confidence Intervals</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="performance-criteria.html"><a href="performance-criteria.html#confidence-intervals-in-our-cluster-rct-example"><i class="fa fa-check"></i><b>9.6.1</b> Confidence Intervals in our Cluster RCT Example</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="performance-criteria.html"><a href="performance-criteria.html#additional-thoughts-on-measuring-performance"><i class="fa fa-check"></i><b>9.7</b> Additional Thoughts on Measuring Performance</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="performance-criteria.html"><a href="performance-criteria.html#sec-relative-performance"><i class="fa fa-check"></i><b>9.7.1</b> Selecting Relative vs. Absolute Criteria</a></li>
<li class="chapter" data-level="9.7.2" data-path="performance-criteria.html"><a href="performance-criteria.html#robust-measures-of-performance"><i class="fa fa-check"></i><b>9.7.2</b> Robust Measures of Performance</a></li>
<li class="chapter" data-level="9.7.3" data-path="performance-criteria.html"><a href="performance-criteria.html#summary-of-peformance-measures"><i class="fa fa-check"></i><b>9.7.3</b> Summary of Peformance Measures</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="performance-criteria.html"><a href="performance-criteria.html#uncertainty-in-performance-estimates-the-mcse"><i class="fa fa-check"></i><b>9.8</b> Uncertainty in Performance Estimates (the MCSE)</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-for-relative-variance-estimators"><i class="fa fa-check"></i><b>9.8.1</b> MCSE for Relative Variance Estimators</a></li>
<li class="chapter" data-level="9.8.2" data-path="performance-criteria.html"><a href="performance-criteria.html#calculating-mcses-with-the-simhelpers-package"><i class="fa fa-check"></i><b>9.8.2</b> Calculating MCSEs With the <code>simhelpers</code> Package</a></li>
<li class="chapter" data-level="9.8.3" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-calculation-in-our-cluster-rct-example"><i class="fa fa-check"></i><b>9.8.3</b> MCSE Calculation in our Cluster RCT Example</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="performance-criteria.html"><a href="performance-criteria.html#exercises-4"><i class="fa fa-check"></i><b>9.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="case_Cronbach.html"><a href="case_Cronbach.html"><i class="fa fa-check"></i><b>10</b> Project: Cronbach Alpha</a>
<ul>
<li class="chapter" data-level="10.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#background"><i class="fa fa-check"></i><b>10.1</b> Background</a></li>
<li class="chapter" data-level="10.2" data-path="case_Cronbach.html"><a href="case_Cronbach.html#getting-started"><i class="fa fa-check"></i><b>10.2</b> Getting started</a></li>
<li class="chapter" data-level="10.3" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-data-generating-function"><i class="fa fa-check"></i><b>10.3</b> The data-generating function</a></li>
<li class="chapter" data-level="10.4" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-estimation-function"><i class="fa fa-check"></i><b>10.4</b> The estimation function</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercices-naive-confidence-intervals"><i class="fa fa-check"></i><b>10.4.1</b> Exercices (Naive confidence intervals)</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="case_Cronbach.html"><a href="case_Cronbach.html#estimator-performance"><i class="fa fa-check"></i><b>10.5</b> Estimator performance</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-calculating-performance"><i class="fa fa-check"></i><b>10.5.1</b> Exercises (Calculating Performance)</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="case_Cronbach.html"><a href="case_Cronbach.html#replication-and-the-simulation"><i class="fa fa-check"></i><b>10.6</b> Replication (and the simulation)</a></li>
<li class="chapter" data-level="10.7" data-path="case_Cronbach.html"><a href="case_Cronbach.html#extension-confidence-interval-coverage"><i class="fa fa-check"></i><b>10.7</b> Extension: Confidence interval coverage</a></li>
<li class="chapter" data-level="10.8" data-path="case_Cronbach.html"><a href="case_Cronbach.html#a-taste-of-multiple-scenarios"><i class="fa fa-check"></i><b>10.8</b> A taste of multiple scenarios</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-5"><i class="fa fa-check"></i><b>10.8.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html"><i class="fa fa-check"></i><b>11</b> Case study: Attrition in a simple randomized experiment</a>
<ul>
<li class="chapter" data-level="11.1" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#the-data-generating-process"><i class="fa fa-check"></i><b>11.1</b> The data generating process</a></li>
<li class="chapter" data-level="11.2" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#estimators"><i class="fa fa-check"></i><b>11.2</b> Estimators</a></li>
<li class="chapter" data-level="11.3" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#performance-criteria-1"><i class="fa fa-check"></i><b>11.3</b> Performance criteria</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="exp-design.html"><a href="exp-design.html"><i class="fa fa-check"></i><b>12</b> Designing the multifactor simulation experiment</a>
<ul>
<li class="chapter" data-level="12.1" data-path="exp-design.html"><a href="exp-design.html#choosing-parameter-combinations"><i class="fa fa-check"></i><b>12.1</b> Choosing parameter combinations</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="exp-design.html"><a href="exp-design.html#choosing-parameters-for-the-clustered-rct"><i class="fa fa-check"></i><b>12.1.1</b> Choosing parameters for the Clustered RCT</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="exp-design.html"><a href="exp-design.html#using-pmap-to-run-multifactor-simulations"><i class="fa fa-check"></i><b>12.2</b> Using pmap to run multifactor simulations</a></li>
<li class="chapter" data-level="12.3" data-path="exp-design.html"><a href="exp-design.html#ways-of-repeating-oneself"><i class="fa fa-check"></i><b>12.3</b> Ways of repeating oneself</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="exp-design.html"><a href="exp-design.html#getting-raw-results-ready-for-analysis"><i class="fa fa-check"></i><b>12.3.1</b> Getting raw results ready for analysis</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="exp-design.html"><a href="exp-design.html#running-the-cluster-rct-multifactor-experiment"><i class="fa fa-check"></i><b>12.4</b> Running the Cluster RCT multifactor experiment</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="exp-design.html"><a href="exp-design.html#making-analyze_data-quiet"><i class="fa fa-check"></i><b>12.4.1</b> Making analyze_data() quiet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html"><i class="fa fa-check"></i><b>13</b> Analyzing the multifactor experiment</a>
<ul>
<li class="chapter" data-level="13.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#bundling"><i class="fa fa-check"></i><b>13.1</b> Bundling</a></li>
<li class="chapter" data-level="13.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#aggregation"><i class="fa fa-check"></i><b>13.2</b> Aggregation</a></li>
<li class="chapter" data-level="13.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#regression-summarization"><i class="fa fa-check"></i><b>13.3</b> Regression Summarization</a></li>
<li class="chapter" data-level="13.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focus-on-subset-kick-rest-to-supplement"><i class="fa fa-check"></i><b>13.4</b> Focus on subset, kick rest to supplement</a></li>
<li class="chapter" data-level="13.5" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#analyzing-results-when-some-trials-have-failed"><i class="fa fa-check"></i><b>13.5</b> Analyzing results when some trials have failed</a></li>
<li class="chapter" data-level="13.6" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#a-demonstration-of-visualization"><i class="fa fa-check"></i><b>13.6</b> A demonstration of visualization</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#the-initial-analysis"><i class="fa fa-check"></i><b>13.6.1</b> The initial analysis</a></li>
<li class="chapter" data-level="13.6.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focusing-on-validity"><i class="fa fa-check"></i><b>13.6.2</b> Focusing on validity</a></li>
<li class="chapter" data-level="13.6.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#looking-at-main-effects"><i class="fa fa-check"></i><b>13.6.3</b> Looking at main effects</a></li>
<li class="chapter" data-level="13.6.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#recap"><i class="fa fa-check"></i><b>13.6.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#exercises-6"><i class="fa fa-check"></i><b>13.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html"><i class="fa fa-check"></i><b>14</b> Case study: Comparing different estimators</a>
<ul>
<li class="chapter" data-level="14.1" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-generating-process-1"><i class="fa fa-check"></i><b>14.1</b> The data generating process</a></li>
<li class="chapter" data-level="14.2" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-analysis-methods"><i class="fa fa-check"></i><b>14.2</b> The data analysis methods</a></li>
<li class="chapter" data-level="14.3" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-simulation-itself"><i class="fa fa-check"></i><b>14.3</b> The simulation itself</a></li>
<li class="chapter" data-level="14.4" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#calculating-performance-measures-for-all-our-estimators"><i class="fa fa-check"></i><b>14.4</b> Calculating performance measures for all our estimators</a></li>
<li class="chapter" data-level="14.5" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#improving-the-visualization-of-the-results"><i class="fa fa-check"></i><b>14.5</b> Improving the visualization of the results</a></li>
<li class="chapter" data-level="14.6" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#extension-the-bias-variance-tradeoff"><i class="fa fa-check"></i><b>14.6</b> Extension: The Bias-variance tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html"><i class="fa fa-check"></i><b>15</b> Presentation of simulation results</a>
<ul>
<li class="chapter" data-level="15.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#tabulation"><i class="fa fa-check"></i><b>15.1</b> Tabulation</a></li>
<li class="chapter" data-level="15.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#visualization"><i class="fa fa-check"></i><b>15.2</b> Visualization</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-1-biserial-correlation-estimation"><i class="fa fa-check"></i><b>15.2.1</b> Example 1: Biserial correlation estimation</a></li>
<li class="chapter" data-level="15.2.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-2-variance-estimation-and-meta-regression"><i class="fa fa-check"></i><b>15.2.2</b> Example 2: Variance estimation and Meta-regression</a></li>
<li class="chapter" data-level="15.2.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-heat-maps-of-coverage"><i class="fa fa-check"></i><b>15.2.3</b> Example: Heat maps of coverage</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#modeling"><i class="fa fa-check"></i><b>15.3</b> Modeling</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="sec-reproducability.html"><a href="sec-reproducability.html"><i class="fa fa-check"></i><b>16</b> Ensuring reproducibility</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-reproducability.html"><a href="sec-reproducability.html#seeds-and-pseudo-random-number-generators"><i class="fa fa-check"></i><b>16.1</b> Seeds and pseudo-random number generators</a></li>
<li class="chapter" data-level="16.2" data-path="sec-reproducability.html"><a href="sec-reproducability.html#including-seed-in-our-simulation-driver"><i class="fa fa-check"></i><b>16.2</b> Including seed in our simulation driver</a></li>
<li class="chapter" data-level="16.3" data-path="sec-reproducability.html"><a href="sec-reproducability.html#reasons-for-setting-the-seed"><i class="fa fa-check"></i><b>16.3</b> Reasons for setting the seed</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="optimize-code.html"><a href="optimize-code.html"><i class="fa fa-check"></i><b>17</b> Optimizing code (and why you often shouldn’t)</a>
<ul>
<li class="chapter" data-level="17.1" data-path="optimize-code.html"><a href="optimize-code.html#hand-building-functions"><i class="fa fa-check"></i><b>17.1</b> Hand-building functions</a></li>
<li class="chapter" data-level="17.2" data-path="optimize-code.html"><a href="optimize-code.html#sec_comp_efficiency"><i class="fa fa-check"></i><b>17.2</b> Computational efficiency versus simplicity</a></li>
<li class="chapter" data-level="17.3" data-path="optimize-code.html"><a href="optimize-code.html#reusing-code-to-speed-up-computation"><i class="fa fa-check"></i><b>17.3</b> Reusing code to speed up computation</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html"><i class="fa fa-check"></i><b>18</b> Error trapping and other headaches</a>
<ul>
<li class="chapter" data-level="18.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#safe_code"><i class="fa fa-check"></i><b>18.1</b> Safe code</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#making-a-safe-function-call"><i class="fa fa-check"></i><b>18.1.1</b> Making a safe function call</a></li>
<li class="chapter" data-level="18.1.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#what-to-do-with-warnings-in-simulations"><i class="fa fa-check"></i><b>18.1.2</b> What to do with warnings in simulations</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#about-stopifnot"><i class="fa fa-check"></i><b>18.2</b> Protecting your functions with “stop”</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="saving-files.html"><a href="saving-files.html"><i class="fa fa-check"></i><b>19</b> Saving files and results</a>
<ul>
<li class="chapter" data-level="19.1" data-path="saving-files.html"><a href="saving-files.html#saving-simulations-in-general"><i class="fa fa-check"></i><b>19.1</b> Saving simulations in general</a></li>
<li class="chapter" data-level="19.2" data-path="saving-files.html"><a href="saving-files.html#saving-simulations-as-you-go"><i class="fa fa-check"></i><b>19.2</b> Saving simulations as you go</a></li>
<li class="chapter" data-level="19.3" data-path="saving-files.html"><a href="saving-files.html#dynamically-making-directories"><i class="fa fa-check"></i><b>19.3</b> Dynamically making directories</a></li>
<li class="chapter" data-level="19.4" data-path="saving-files.html"><a href="saving-files.html#loading-and-combining-files-of-simulation-results"><i class="fa fa-check"></i><b>19.4</b> Loading and combining files of simulation results</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="parallel-processing.html"><a href="parallel-processing.html"><i class="fa fa-check"></i><b>20</b> Parallel Processing</a>
<ul>
<li class="chapter" data-level="20.1" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-on-your-computer"><i class="fa fa-check"></i><b>20.1</b> Parallel on your computer</a></li>
<li class="chapter" data-level="20.2" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-off-your-computer"><i class="fa fa-check"></i><b>20.2</b> Parallel off your computer</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="parallel-processing.html"><a href="parallel-processing.html#what-is-a-command-line-interface"><i class="fa fa-check"></i><b>20.2.1</b> What is a command-line interface?</a></li>
<li class="chapter" data-level="20.2.2" data-path="parallel-processing.html"><a href="parallel-processing.html#running-a-job-on-a-cluster"><i class="fa fa-check"></i><b>20.2.2</b> Running a job on a cluster</a></li>
<li class="chapter" data-level="20.2.3" data-path="parallel-processing.html"><a href="parallel-processing.html#checking-on-a-job"><i class="fa fa-check"></i><b>20.2.3</b> Checking on a job</a></li>
<li class="chapter" data-level="20.2.4" data-path="parallel-processing.html"><a href="parallel-processing.html#running-lots-of-jobs-on-a-cluster"><i class="fa fa-check"></i><b>20.2.4</b> Running lots of jobs on a cluster</a></li>
<li class="chapter" data-level="20.2.5" data-path="parallel-processing.html"><a href="parallel-processing.html#resources-for-harvards-odyssey"><i class="fa fa-check"></i><b>20.2.5</b> Resources for Harvard’s Odyssey</a></li>
<li class="chapter" data-level="20.2.6" data-path="parallel-processing.html"><a href="parallel-processing.html#acknowledgements-1"><i class="fa fa-check"></i><b>20.2.6</b> Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html"><i class="fa fa-check"></i><b>21</b> Using simulation as a power calculator</a>
<ul>
<li class="chapter" data-level="21.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#getting-design-parameters-from-pilot-data"><i class="fa fa-check"></i><b>21.1</b> Getting design parameters from pilot data</a></li>
<li class="chapter" data-level="21.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#the-data-generating-process-2"><i class="fa fa-check"></i><b>21.2</b> The data generating process</a></li>
<li class="chapter" data-level="21.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#running-the-simulation-2"><i class="fa fa-check"></i><b>21.3</b> Running the simulation</a></li>
<li class="chapter" data-level="21.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#evaluating-power"><i class="fa fa-check"></i><b>21.4</b> Evaluating power</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#checking-validity-of-our-models"><i class="fa fa-check"></i><b>21.4.1</b> Checking validity of our models</a></li>
<li class="chapter" data-level="21.4.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-precision-se"><i class="fa fa-check"></i><b>21.4.2</b> Assessing Precision (SE)</a></li>
<li class="chapter" data-level="21.4.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-power"><i class="fa fa-check"></i><b>21.4.3</b> Assessing power</a></li>
<li class="chapter" data-level="21.4.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-minimum-detectable-effects"><i class="fa fa-check"></i><b>21.4.4</b> Assessing Minimum Detectable Effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html"><i class="fa fa-check"></i><b>22</b> Simulation under the Potential Outcomes Framework</a>
<ul>
<li class="chapter" data-level="22.1" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#finite-vs.-superpopulation-inference"><i class="fa fa-check"></i><b>22.1</b> Finite vs. Superpopulation inference</a></li>
<li class="chapter" data-level="22.2" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#data-generation-processes-for-potential-outcomes"><i class="fa fa-check"></i><b>22.2</b> Data generation processes for potential outcomes</a></li>
<li class="chapter" data-level="22.3" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#finite-sample-performance-measures"><i class="fa fa-check"></i><b>22.3</b> Finite sample performance measures</a></li>
<li class="chapter" data-level="22.4" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#nested-finite-simulation-procedure"><i class="fa fa-check"></i><b>22.4</b> Nested finite simulation procedure</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html"><i class="fa fa-check"></i><b>23</b> Simulations as evidence</a>
<ul>
<li class="chapter" data-level="23.1" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#use-extensive-multi-factor-simulations"><i class="fa fa-check"></i><b>23.1</b> Use extensive multi-factor simulations</a></li>
<li class="chapter" data-level="23.2" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#beat-them-at-their-own-game"><i class="fa fa-check"></i><b>23.2</b> Beat them at their own game</a></li>
<li class="chapter" data-level="23.3" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#calibrated-simulations"><i class="fa fa-check"></i><b>23.3</b> Calibrated simulations</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>24</b> The Parametric bootstrap</a>
<ul>
<li class="chapter" data-level="24.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#air-conditioners-a-stolen-case-study"><i class="fa fa-check"></i><b>24.1</b> Air conditioners: a stolen case study</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="on_functions.html"><a href="on_functions.html"><i class="fa fa-check"></i><b>25</b> Appendix: Coding tidbits</a>
<ul>
<li class="chapter" data-level="25.1" data-path="on_functions.html"><a href="on_functions.html#repeating-oneself"><i class="fa fa-check"></i><b>25.1</b> Other ways of repeating yourself</a></li>
<li class="chapter" data-level="25.2" data-path="on_functions.html"><a href="on_functions.html#default-arguments"><i class="fa fa-check"></i><b>25.2</b> Default arguments for functions</a></li>
<li class="chapter" data-level="25.3" data-path="on_functions.html"><a href="on_functions.html#testing-and-debugging-code-in-your-scripts"><i class="fa fa-check"></i><b>25.3</b> Testing and debugging code in your scripts</a></li>
<li class="chapter" data-level="25.4" data-path="on_functions.html"><a href="on_functions.html#keep-multiple-files-of-code"><i class="fa fa-check"></i><b>25.4</b> Keep multiple files of code</a></li>
<li class="chapter" data-level="25.5" data-path="on_functions.html"><a href="on_functions.html#the-source-command-and-keeping-things-organized"><i class="fa fa-check"></i><b>25.5</b> The source command and keeping things organized</a></li>
<li class="chapter" data-level="25.6" data-path="on_functions.html"><a href="on_functions.html#debugging-with-browser"><i class="fa fa-check"></i><b>25.6</b> Debugging with browser</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="further-readings-and-resources.html"><a href="further-readings-and-resources.html"><i class="fa fa-check"></i><b>26</b> Further readings and resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Designing Monte Carlo Simulations in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimation-procedures-1" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Estimation procedures<a href="estimation-procedures-1.html#estimation-procedures-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the abstract, a function that implements an estimation procedure should have the following form:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="estimation-procedures-1.html#cb131-1" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb131-2"><a href="estimation-procedures-1.html#cb131-2" tabindex="-1"></a></span>
<span id="cb131-3"><a href="estimation-procedures-1.html#cb131-3" tabindex="-1"></a>  <span class="co"># calculations/model-fitting/estimation procedures</span></span>
<span id="cb131-4"><a href="estimation-procedures-1.html#cb131-4" tabindex="-1"></a>  </span>
<span id="cb131-5"><a href="estimation-procedures-1.html#cb131-5" tabindex="-1"></a>  <span class="fu">return</span>(estimates)</span>
<span id="cb131-6"><a href="estimation-procedures-1.html#cb131-6" tabindex="-1"></a>}</span></code></pre></div>
<p>The function takes a data set as input, fits a model or otherwise calculates an estimate, possibly with associated standard errors and so forth, and produces as output these estimates.
In principle, you should be able to run your function on real data as well as simulated.</p>
<p>The estimates could be point-estimates of parameters, standard errors, confidence intervals, etc.
Depending on the research question, this function might involve a combination of several procedures (e.g., a diagnostic test for heteroskedasticity, followed by the conventional formula or heteroskedasticity-robust formula for standard errors).
Also depending on the research question, we might need to create <em>several</em> functions that implement different estimation procedures to be compared.</p>
<p>In Chapter <a href="case-ANOVA.html#case-ANOVA">5</a>, for example, we saw different functions for some of the methods Brown and Forsythe considered for heteroskedastic ANOVA.</p>
<div id="validating-estimation-procedures" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Validating Estimation Procedures<a href="estimation-procedures-1.html#validating-estimation-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Just as with the data-generating function, it is important to verify the accuracy of the estimation functions.
For our Welch test, we can actually check our results against the built-in <code>oneway.test</code> function. Let’s do that with a fresh set of data:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="estimation-procedures-1.html#cb132-1" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(<span class="at">mu =</span> mu, <span class="at">sigma_sq =</span> sigma_sq,</span>
<span id="cb132-2"><a href="estimation-procedures-1.html#cb132-2" tabindex="-1"></a>                          <span class="at">sample_size =</span> sample_size)</span>
<span id="cb132-3"><a href="estimation-procedures-1.html#cb132-3" tabindex="-1"></a></span>
<span id="cb132-4"><a href="estimation-procedures-1.html#cb132-4" tabindex="-1"></a>aov_results <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(x <span class="sc">~</span> <span class="fu">factor</span>(group),</span>
<span id="cb132-5"><a href="estimation-procedures-1.html#cb132-5" tabindex="-1"></a>                           <span class="at">data =</span> sim_data, </span>
<span id="cb132-6"><a href="estimation-procedures-1.html#cb132-6" tabindex="-1"></a>                           <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb132-7"><a href="estimation-procedures-1.html#cb132-7" tabindex="-1"></a>aov_results</span></code></pre></div>
<pre><code>## 
##  One-way analysis of means (not assuming
##  equal variances)
## 
## data:  x and factor(group)
## F = 52.554, num df = 3.0000, denom df =
## 4.9584, p-value = 0.0003506</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="estimation-procedures-1.html#cb134-1" tabindex="-1"></a>Welch_results <span class="ot">&lt;-</span> <span class="fu">Welch_F</span>(sim_data)</span>
<span id="cb134-2"><a href="estimation-procedures-1.html#cb134-2" tabindex="-1"></a><span class="fu">all.equal</span>(aov_results<span class="sc">$</span>p.value, Welch_results)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>We use <code>all.equal()</code> because it will check equality up to a tolerance in R, which can avoid some weird floating point errors due to rounding.</p>
</div>
<div id="checking-via-simulation" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Checking via simulation<a href="estimation-procedures-1.html#checking-via-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If your estimation procedure truly is new, how would you check it?
Well, one obvious answer is simulation!</p>
<p>In principle, for large samples and data generated under the assumptions required by your new procedure, you should have a fairly good sense that your estimation procedures should work.
It is often the case that as you design your simulation, and then start analyzing the results, you will find your estimators are really not working as planned.</p>
<p>Such surprises will usually be due to (at least) three factors: you did not implement your method correctly, your method is not yet a good idea in the first place, or you do not yet understand something important about how your method works.
When faced with poor performance you thus will debug your code, revise your method, and do some serious thinking.
Ideally this will eventually lead you to a deeper understanding of a method that is a better idea in general, and correctly implemented in all likelihood.</p>
<p>For example, in one research project Luke and other co-authors were working on a way to improve Instrumental Variable (IV) estimation using post-stratification.
The idea is to group units based on a covariate that predicts compliance status, and then estimate within each group; hopefully this would improve overall estimation.</p>
<p>In the first simulation, the estimates were full of NAs and odd results because we failed to properly account for what happens when the number of compliers was estimated to be zero.
That was table stakes: after repairing that, we still found odd behavior and serious and unexpected bias, which turned out to be due to failing to implement the averaging of the groups step correctly.
We fixed the estimator again and re-ran, and found that even when we had a variable that was almost perfectly predictive of compliance, gains were still surprisingly minimal.
Eventually we understood that the groups with very few compliers were actually so unstable that they ruined the overall estimate.
These results inspired us to introduce other estimators that dropped or down-weighted such strata, which gave our paper a deeper purpose and contribution.</p>
<p>Simulation is an iterative process.
It is to help you, the researcher, learn about your estimators so you can find a way forward with your work.
What you learn then feeds back to the prior research, and you have a cycle that you eventually step off of, if you want to finish your paper.
But do not expect it to be a single, well-defined, trajectory.</p>
</div>
<div id="including-multiple-estimation-procedures" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Including Multiple estimation procedures<a href="estimation-procedures-1.html#including-multiple-estimation-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Chapter <span class="citation">(<a href="#ref-chap-DGP"><strong>chap-DGP?</strong></a>)</span>, Section <a href="chap-DGP.html#case-cluster">6.3</a> we introduced a case study of evaluating different procedures for estimating treatment impacts in a cluster randomized trial.
As a point of design, we generally recommend writing different functions for each estimation method one is planning on evaluating. This makes it easier to plug into play different methods as desired, and also helps generate a code base that is flexible and useful for other purposes.
It also, continuing our usual mantra, makes debugging easier: you can focus attention on one thing at a time, and worry less about how errors in one area might propagate to others.</p>
<p>For the cluster RCT context, we use two libraries, the <code>lme4</code> package (for multilevel modeling), the <code>arm</code> package (which gives us nice access to standard errors, with <code>se.fixef()</code>), and <code>lmerTest</code> (which gives us <span class="math inline">\(p\)</span>-values for multilevel modeling).
We also need the <code>estimatr</code> package to get robust SEs with <code>lm_robust</code>.
This use of different packages for different estimators is quite typical: in many simulations, many of the estimation approaches being considered are usually taken from the literature, and if you are lucky this means you can simply use a package that implements those methods.</p>
<p>We load our libraries at the top of our code:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="estimation-procedures-1.html#cb136-1" tabindex="-1"></a><span class="fu">library</span>( lme4 )</span>
<span id="cb136-2"><a href="estimation-procedures-1.html#cb136-2" tabindex="-1"></a><span class="fu">library</span>( arm )</span>
<span id="cb136-3"><a href="estimation-procedures-1.html#cb136-3" tabindex="-1"></a><span class="fu">library</span>( lmerTest )</span>
<span id="cb136-4"><a href="estimation-procedures-1.html#cb136-4" tabindex="-1"></a><span class="fu">library</span>( estimatr )</span></code></pre></div>
<p>Our three analysis functions are then Multilevel Regression (MLM):</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="estimation-procedures-1.html#cb137-1" tabindex="-1"></a>analysis_MLM <span class="ot">&lt;-</span> <span class="cf">function</span>( dat ) {</span>
<span id="cb137-2"><a href="estimation-procedures-1.html#cb137-2" tabindex="-1"></a>  M1 <span class="ot">=</span> <span class="fu">lmer</span>( Yobs <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Z <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>sid),</span>
<span id="cb137-3"><a href="estimation-procedures-1.html#cb137-3" tabindex="-1"></a>             <span class="at">data=</span>dat )</span>
<span id="cb137-4"><a href="estimation-procedures-1.html#cb137-4" tabindex="-1"></a>  est <span class="ot">=</span> <span class="fu">fixef</span>( M1 )[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb137-5"><a href="estimation-procedures-1.html#cb137-5" tabindex="-1"></a>  se <span class="ot">=</span> <span class="fu">se.fixef</span>( M1 )[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb137-6"><a href="estimation-procedures-1.html#cb137-6" tabindex="-1"></a>  pv <span class="ot">=</span> <span class="fu">summary</span>(M1)<span class="sc">$</span>coefficients[<span class="st">&quot;Z&quot;</span>,<span class="dv">5</span>]</span>
<span id="cb137-7"><a href="estimation-procedures-1.html#cb137-7" tabindex="-1"></a>  <span class="fu">tibble</span>( <span class="at">ATE_hat =</span> est, <span class="at">SE_hat =</span> se, <span class="at">p_value =</span> pv )</span>
<span id="cb137-8"><a href="estimation-procedures-1.html#cb137-8" tabindex="-1"></a>}</span></code></pre></div>
<p>Linear Regression with Cluster-Robust Standard Errors (LM):</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="estimation-procedures-1.html#cb138-1" tabindex="-1"></a>analysis_OLS <span class="ot">&lt;-</span> <span class="cf">function</span>( dat ) {</span>
<span id="cb138-2"><a href="estimation-procedures-1.html#cb138-2" tabindex="-1"></a>  M2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>( Yobs <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Z, </span>
<span id="cb138-3"><a href="estimation-procedures-1.html#cb138-3" tabindex="-1"></a>            <span class="at">data=</span>dat, <span class="at">clusters=</span>sid )</span>
<span id="cb138-4"><a href="estimation-procedures-1.html#cb138-4" tabindex="-1"></a>  est <span class="ot">&lt;-</span> M2<span class="sc">$</span>coefficients[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb138-5"><a href="estimation-procedures-1.html#cb138-5" tabindex="-1"></a>  se  <span class="ot">&lt;-</span> M2<span class="sc">$</span>std.error[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb138-6"><a href="estimation-procedures-1.html#cb138-6" tabindex="-1"></a>  pv <span class="ot">&lt;-</span> M2<span class="sc">$</span>p.value[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb138-7"><a href="estimation-procedures-1.html#cb138-7" tabindex="-1"></a>  <span class="fu">tibble</span>( <span class="at">ATE_hat =</span> est, <span class="at">SE_hat =</span> se, <span class="at">p_value =</span> pv )</span>
<span id="cb138-8"><a href="estimation-procedures-1.html#cb138-8" tabindex="-1"></a>}</span></code></pre></div>
<p>and Aggregate data (Agg):</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="estimation-procedures-1.html#cb139-1" tabindex="-1"></a>analysis_agg <span class="ot">&lt;-</span> <span class="cf">function</span>( dat ) {</span>
<span id="cb139-2"><a href="estimation-procedures-1.html#cb139-2" tabindex="-1"></a>  datagg <span class="ot">&lt;-</span> </span>
<span id="cb139-3"><a href="estimation-procedures-1.html#cb139-3" tabindex="-1"></a>    dat <span class="sc">%&gt;%</span> </span>
<span id="cb139-4"><a href="estimation-procedures-1.html#cb139-4" tabindex="-1"></a>    <span class="fu">group_by</span>( sid, Z ) <span class="sc">%&gt;%</span></span>
<span id="cb139-5"><a href="estimation-procedures-1.html#cb139-5" tabindex="-1"></a>    <span class="fu">summarise</span>( </span>
<span id="cb139-6"><a href="estimation-procedures-1.html#cb139-6" tabindex="-1"></a>      <span class="at">Ybar =</span> <span class="fu">mean</span>( Yobs ),</span>
<span id="cb139-7"><a href="estimation-procedures-1.html#cb139-7" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">n</span>() </span>
<span id="cb139-8"><a href="estimation-procedures-1.html#cb139-8" tabindex="-1"></a>    )</span>
<span id="cb139-9"><a href="estimation-procedures-1.html#cb139-9" tabindex="-1"></a>  </span>
<span id="cb139-10"><a href="estimation-procedures-1.html#cb139-10" tabindex="-1"></a>  <span class="fu">stopifnot</span>( <span class="fu">nrow</span>( datagg ) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(dat<span class="sc">$</span>sid) ) )</span>
<span id="cb139-11"><a href="estimation-procedures-1.html#cb139-11" tabindex="-1"></a>  </span>
<span id="cb139-12"><a href="estimation-procedures-1.html#cb139-12" tabindex="-1"></a>  M3 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>( Ybar <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Z, </span>
<span id="cb139-13"><a href="estimation-procedures-1.html#cb139-13" tabindex="-1"></a>                   <span class="at">data=</span>datagg, <span class="at">se_type =</span> <span class="st">&quot;HC2&quot;</span> )</span>
<span id="cb139-14"><a href="estimation-procedures-1.html#cb139-14" tabindex="-1"></a>  est <span class="ot">&lt;-</span> M3<span class="sc">$</span>coefficients[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb139-15"><a href="estimation-procedures-1.html#cb139-15" tabindex="-1"></a>  se <span class="ot">&lt;-</span> M3<span class="sc">$</span>std.error[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb139-16"><a href="estimation-procedures-1.html#cb139-16" tabindex="-1"></a>  pv <span class="ot">&lt;-</span> M3<span class="sc">$</span>p.value[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb139-17"><a href="estimation-procedures-1.html#cb139-17" tabindex="-1"></a>  <span class="fu">tibble</span>( <span class="at">ATE_hat =</span> est, <span class="at">SE_hat =</span> se, <span class="at">p_value =</span> pv )</span>
<span id="cb139-18"><a href="estimation-procedures-1.html#cb139-18" tabindex="-1"></a>}</span></code></pre></div>
<p>Note the <code>stopifnot</code> command: putting <em>assert statements</em> in your code like this is a good way to guarantee you are not introducing weird and hard-to-track errors in your code.
For example, R likes to recycle vectors to make them the right length; if you gave it a wrong length in error, this can be a brutal error to discover.
The <code>stopifnot</code> statements halt your code as soon as something goes wrong, rather than letting that initial wrongness flow on to further work, showing up in odd results that you don’t understand later on.
See Section <a href="error-trapping-and-other-headaches.html#about-stopifnot">18.2</a> for more.</p>
<p>All of our methods give output in the similar format:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="estimation-procedures-1.html#cb140-1" tabindex="-1"></a><span class="fu">analysis_MLM</span>( dat )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   ATE_hat SE_hat p_value
##     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1   0.227  0.222   0.316</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="estimation-procedures-1.html#cb142-1" tabindex="-1"></a><span class="fu">analysis_OLS</span>( dat )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   ATE_hat SE_hat p_value
##     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1   0.171  0.228   0.462</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="estimation-procedures-1.html#cb144-1" tabindex="-1"></a><span class="fu">analysis_agg</span>( dat )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   ATE_hat SE_hat p_value
##     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1   0.232  0.222   0.305</code></pre>
<p>This will allow us to make our simulation, for each iteration, call each method in turn on the same dataset, stack the results into a small table, and return that result.
This will in turn get stacked to make one giant table of results, which makes evaluating performance quite easy.
We will see this in the next chapter.</p>
</div>
<div id="exercises-2" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Exercises<a href="estimation-procedures-1.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="more-welch-and-adding-the-bff-test" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> More Welch and adding the BFF test<a href="estimation-procedures-1.html#more-welch-and-adding-the-bff-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s continue to explore and tweak the simulation code we have developed to replicate the results of Brown and Forsythe (1974).</p>
<ol style="list-style-type: decimal">
<li>Write a function that implements the Brown-Forsythe F*-test (the BFF* test!) as described on p. 130 of Brown and Forsythe (1974).
Call it on a sample dataset to check it.</li>
</ol>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="estimation-procedures-1.html#cb146-1" tabindex="-1"></a>BF_F <span class="ot">&lt;-</span> <span class="cf">function</span>(x_bar, s_sq, n, g) {</span>
<span id="cb146-2"><a href="estimation-procedures-1.html#cb146-2" tabindex="-1"></a>  </span>
<span id="cb146-3"><a href="estimation-procedures-1.html#cb146-3" tabindex="-1"></a>  <span class="co"># fill in the guts here</span></span>
<span id="cb146-4"><a href="estimation-procedures-1.html#cb146-4" tabindex="-1"></a>  </span>
<span id="cb146-5"><a href="estimation-procedures-1.html#cb146-5" tabindex="-1"></a>  <span class="fu">return</span>(pval)</span>
<span id="cb146-6"><a href="estimation-procedures-1.html#cb146-6" tabindex="-1"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Try calling your <code>BF_F</code> function on a variety of datasets of different sizes and shapes, to make sure it works. What kinds of datasets should you test out?</li>
</ol>
</div>
<div id="more-estimators-for-cluster-randomized-trials" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> More estimators for Cluster Randomized Trials<a href="estimation-procedures-1.html#more-estimators-for-cluster-randomized-trials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="3" style="list-style-type: decimal">
<li>Sometimes you might want to consider two versions of an estimator. For example, in our cluster RCT code we used robust standard errors for the linear model estimator. Say we also want to include naive standard error estimates that we get out of the <code>lm</code> call.</li>
</ol>
<p>Extend the <code>OLS</code> call to be</p>
<pre><code>analysis_OLS &lt;- function( dat, robustSE = TRUE ) {</code></pre>
<p>and have the code inside calculate SEs based on the flag. Then modify the <code>analyze_data()</code> to include both approaches (you will have to call <code>analysis_OLS</code> twice).</p>
<ol start="4" style="list-style-type: decimal">
<li>Efficiency-wise, estimating the OLS twice might not be ideal, but clarity-wise it might be considered helpful. Articulate two reasons for the design choice of implementing the two OLS calls separately, and articulate two reasons for instead having the <code>analysis_OLS</code> method generate both standard errors internally in a single call.</li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap-DGP.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="running-the-simulation-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jepusto/Designing-Simulations-in-R/edit/master/030-Estimation-procedures.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Designing-Simulations-in-R.pdf", "Designing-Simulations-in-R.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
