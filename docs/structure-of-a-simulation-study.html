<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Structure of a simulation study | Designing Monte Carlo Simulations in R</title>
  <meta name="description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="generator" content="bookdown 0.40.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Structure of a simulation study | Designing Monte Carlo Simulations in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="github-repo" content="jepusto/Designing-Simulations-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Structure of a simulation study | Designing Monte Carlo Simulations in R" />
  
  <meta name="twitter:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  

<meta name="author" content="Luke W. Miratrix and James E. Pustejovsky (Equal authors)" />


<meta name="date" content="2024-07-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="t-test-simulation.html"/>
<link rel="next" href="case-ANOVA.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Designing Simulations in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I An Introductory Look</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#some-of-simulations-many-uses"><i class="fa fa-check"></i><b>1.1</b> Some of simulation’s many uses</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#comparing-statistical-approaches"><i class="fa fa-check"></i><b>1.1.1</b> Comparing statistical approaches</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#assessing-performance-of-complex-pipelines"><i class="fa fa-check"></i><b>1.1.2</b> Assessing performance of complex pipelines</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#assessing-performance-under-misspecification"><i class="fa fa-check"></i><b>1.1.3</b> Assessing performance under misspecification</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#assessing-the-finite-sample-performance-of-a-statistical-approach"><i class="fa fa-check"></i><b>1.1.4</b> Assessing the finite sample performance of a statistical approach</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#conducting-power-analyses"><i class="fa fa-check"></i><b>1.1.5</b> Conducting Power Analyses</a></li>
<li class="chapter" data-level="1.1.6" data-path="introduction.html"><a href="introduction.html#simulating-processess"><i class="fa fa-check"></i><b>1.1.6</b> Simulating processess</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-perils-of-simulation-as-evidence"><i class="fa fa-check"></i><b>1.2</b> The perils of simulation as evidence</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#simulating-to-learn"><i class="fa fa-check"></i><b>1.3</b> Simulating to learn</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#organization-of-the-text"><i class="fa fa-check"></i><b>1.4</b> Organization of the text</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html"><i class="fa fa-check"></i><b>2</b> Programming Preliminaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#why-r"><i class="fa fa-check"></i><b>2.1</b> Why R?</a></li>
<li class="chapter" data-level="2.2" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#welcome-to-the-tidyverse"><i class="fa fa-check"></i><b>2.2</b> Welcome to the tidyverse</a></li>
<li class="chapter" data-level="2.3" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#functions"><i class="fa fa-check"></i><b>2.3</b> Functions</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#rolling-your-own"><i class="fa fa-check"></i><b>2.3.1</b> Rolling your own</a></li>
<li class="chapter" data-level="2.3.2" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#a-dangerous-function"><i class="fa fa-check"></i><b>2.3.2</b> A dangerous function</a></li>
<li class="chapter" data-level="2.3.3" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#using-named-arguments"><i class="fa fa-check"></i><b>2.3.3</b> Using Named Arguments</a></li>
<li class="chapter" data-level="2.3.4" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#argument-defaults"><i class="fa fa-check"></i><b>2.3.4</b> Argument Defaults</a></li>
<li class="chapter" data-level="2.3.5" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#function-skeletons"><i class="fa fa-check"></i><b>2.3.5</b> Function skeletons</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#pipe-dreams"><i class="fa fa-check"></i><b>2.4</b> <code>%&gt;%</code> (Pipe) dreams</a></li>
<li class="chapter" data-level="2.5" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#recipes-versus-patterns"><i class="fa fa-check"></i><b>2.5</b> Recipes versus Patterns</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="t-test-simulation.html"><a href="t-test-simulation.html"><i class="fa fa-check"></i><b>3</b> An initial simulation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="t-test-simulation.html"><a href="t-test-simulation.html#simulating-a-single-scenario"><i class="fa fa-check"></i><b>3.1</b> Simulating a single scenario</a></li>
<li class="chapter" data-level="3.2" data-path="t-test-simulation.html"><a href="t-test-simulation.html#a-non-normal-population-distribution"><i class="fa fa-check"></i><b>3.2</b> A non-normal population distribution</a></li>
<li class="chapter" data-level="3.3" data-path="t-test-simulation.html"><a href="t-test-simulation.html#simulating-across-different-scenarios"><i class="fa fa-check"></i><b>3.3</b> Simulating across different scenarios</a></li>
<li class="chapter" data-level="3.4" data-path="t-test-simulation.html"><a href="t-test-simulation.html#extending-the-simulation-design"><i class="fa fa-check"></i><b>3.4</b> Extending the simulation design</a></li>
<li class="chapter" data-level="3.5" data-path="t-test-simulation.html"><a href="t-test-simulation.html#exercises"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Structure and Mechanics of a Simulation Study</b></span></li>
<li class="chapter" data-level="4" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html"><i class="fa fa-check"></i><b>4</b> Structure of a simulation study</a>
<ul>
<li class="chapter" data-level="4.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#general-structure-of-a-simulation"><i class="fa fa-check"></i><b>4.1</b> General structure of a simulation</a></li>
<li class="chapter" data-level="4.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#tidy-modular-simulations"><i class="fa fa-check"></i><b>4.2</b> Tidy, modular simulations</a></li>
<li class="chapter" data-level="4.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#skeleton-of-a-simulation-study"><i class="fa fa-check"></i><b>4.3</b> Skeleton of a simulation study</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#data-generating-process"><i class="fa fa-check"></i><b>4.3.1</b> Data-Generating Process</a></li>
<li class="chapter" data-level="4.3.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#data-analysis-procedure"><i class="fa fa-check"></i><b>4.3.2</b> Data Analysis Procedure</a></li>
<li class="chapter" data-level="4.3.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#repetition"><i class="fa fa-check"></i><b>4.3.3</b> Repetition</a></li>
<li class="chapter" data-level="4.3.4" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#performance-summaries"><i class="fa fa-check"></i><b>4.3.4</b> Performance summaries</a></li>
<li class="chapter" data-level="4.3.5" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#multifactor-simulations"><i class="fa fa-check"></i><b>4.3.5</b> Multifactor simulations</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#exercises-1"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="case-ANOVA.html"><a href="case-ANOVA.html"><i class="fa fa-check"></i><b>5</b> Case Study: Heteroskedastic ANOVA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#the-data-generating-model"><i class="fa fa-check"></i><b>5.1</b> The data-generating model</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#now-make-a-function"><i class="fa fa-check"></i><b>5.1.1</b> Now make a function</a></li>
<li class="chapter" data-level="5.1.2" data-path="case-ANOVA.html"><a href="case-ANOVA.html#cautious-coding"><i class="fa fa-check"></i><b>5.1.2</b> Cautious coding</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="case-ANOVA.html"><a href="case-ANOVA.html#the-hypothesis-testing-procedures"><i class="fa fa-check"></i><b>5.2</b> The hypothesis testing procedures</a></li>
<li class="chapter" data-level="5.3" data-path="case-ANOVA.html"><a href="case-ANOVA.html#running-the-simulation"><i class="fa fa-check"></i><b>5.3</b> Running the simulation</a></li>
<li class="chapter" data-level="5.4" data-path="case-ANOVA.html"><a href="case-ANOVA.html#summarizing-test-performance"><i class="fa fa-check"></i><b>5.4</b> Summarizing Test Performance</a></li>
<li class="chapter" data-level="5.5" data-path="case-ANOVA.html"><a href="case-ANOVA.html#exAnovaExercises"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-generating-processes.html"><a href="data-generating-processes.html"><i class="fa fa-check"></i><b>6</b> Data-Generating Processes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-generating-processes.html"><a href="data-generating-processes.html#a-statistical-model-is-a-recipe-for-data-generation"><i class="fa fa-check"></i><b>6.1</b> A statistical model is a recipe for data generation</a></li>
<li class="chapter" data-level="6.2" data-path="data-generating-processes.html"><a href="data-generating-processes.html#checking-the-data-generating-function"><i class="fa fa-check"></i><b>6.2</b> Checking the data-generating function</a></li>
<li class="chapter" data-level="6.3" data-path="data-generating-processes.html"><a href="data-generating-processes.html#case-cluster"><i class="fa fa-check"></i><b>6.3</b> Example: Simulating clustered data</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data-generating-processes.html"><a href="data-generating-processes.html#a-design-decision-what-do-we-want-to-manipulate"><i class="fa fa-check"></i><b>6.3.1</b> A design decision: What do we want to manipulate?</a></li>
<li class="chapter" data-level="6.3.2" data-path="data-generating-processes.html"><a href="data-generating-processes.html#a-model-for-a-cluster-rct"><i class="fa fa-check"></i><b>6.3.2</b> A model for a cluster RCT</a></li>
<li class="chapter" data-level="6.3.3" data-path="data-generating-processes.html"><a href="data-generating-processes.html#converting-our-model-to-code"><i class="fa fa-check"></i><b>6.3.3</b> Converting our model to code</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data-generating-processes.html"><a href="data-generating-processes.html#exercises-2"><i class="fa fa-check"></i><b>6.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data-generating-processes.html"><a href="data-generating-processes.html#ex_dgp"><i class="fa fa-check"></i><b>6.4.1</b> The Welch test on a shifted-and-scaled <span class="math inline">\(t\)</span> distribution</a></li>
<li class="chapter" data-level="6.4.2" data-path="data-generating-processes.html"><a href="data-generating-processes.html#checking-and-extending-the-cluster-rct-dgp"><i class="fa fa-check"></i><b>6.4.2</b> Checking and extending the Cluster RCT DGP</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="data-generating-processes.html"><a href="data-generating-processes.html#extension-standardization-in-a-data-generating-process"><i class="fa fa-check"></i><b>6.5</b> Extension: Standardization in a data generating process</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-analysis-procedures.html"><a href="data-analysis-procedures.html"><i class="fa fa-check"></i><b>7</b> Data analysis procedures</a>
<ul>
<li class="chapter" data-level="7.1" data-path="data-analysis-procedures.html"><a href="data-analysis-procedures.html#validating-estimation-procedures"><i class="fa fa-check"></i><b>7.1</b> Validating Estimation Procedures</a></li>
<li class="chapter" data-level="7.2" data-path="data-analysis-procedures.html"><a href="data-analysis-procedures.html#checking-via-simulation"><i class="fa fa-check"></i><b>7.2</b> Checking via simulation</a></li>
<li class="chapter" data-level="7.3" data-path="data-analysis-procedures.html"><a href="data-analysis-procedures.html#including-multiple-estimation-procedures"><i class="fa fa-check"></i><b>7.3</b> Including Multiple estimation procedures</a></li>
<li class="chapter" data-level="7.4" data-path="data-analysis-procedures.html"><a href="data-analysis-procedures.html#exercises-3"><i class="fa fa-check"></i><b>7.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="data-analysis-procedures.html"><a href="data-analysis-procedures.html#more-welch-and-adding-the-bff-test"><i class="fa fa-check"></i><b>7.4.1</b> More Welch and adding the BFF test</a></li>
<li class="chapter" data-level="7.4.2" data-path="data-analysis-procedures.html"><a href="data-analysis-procedures.html#more-estimators-for-cluster-randomized-trials"><i class="fa fa-check"></i><b>7.4.2</b> More estimators for Cluster Randomized Trials</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html"><i class="fa fa-check"></i><b>8</b> Running the Simulation Process</a>
<ul>
<li class="chapter" data-level="8.1" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#writing-simulations-quick-with-the-simhelpers-package"><i class="fa fa-check"></i><b>8.1</b> Writing simulations quick with the simhelpers package</a></li>
<li class="chapter" data-level="8.2" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#adding-checks-and-balances"><i class="fa fa-check"></i><b>8.2</b> Adding Checks and Balances</a></li>
<li class="chapter" data-level="8.3" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#exercises-4"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="performance-criteria.html"><a href="performance-criteria.html"><i class="fa fa-check"></i><b>9</b> Performance criteria</a>
<ul>
<li class="chapter" data-level="9.1" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-vs.-estimation"><i class="fa fa-check"></i><b>9.1</b> Inference vs. Estimation</a></li>
<li class="chapter" data-level="9.2" data-path="performance-criteria.html"><a href="performance-criteria.html#ways-of-assessing-and-comparing-estimation-procedures"><i class="fa fa-check"></i><b>9.2</b> Ways of Assessing and Comparing Estimation Procedures</a></li>
<li class="chapter" data-level="9.3" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-point-estimator"><i class="fa fa-check"></i><b>9.3</b> Assessing a Point Estimator</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="performance-criteria.html"><a href="performance-criteria.html#comparing-the-performances-of-the-cluster-rct-estimation-procedures"><i class="fa fa-check"></i><b>9.3.1</b> Comparing the Performances of the Cluster RCT Estimation Procedures</a></li>
<li class="chapter" data-level="9.3.2" data-path="performance-criteria.html"><a href="performance-criteria.html#handling-estimands-not-represented-by-a-parameter"><i class="fa fa-check"></i><b>9.3.2</b> Handling Estimands Not Represented By a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-standard-error-estimator"><i class="fa fa-check"></i><b>9.4</b> Assessing a Standard Error Estimator</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="performance-criteria.html"><a href="performance-criteria.html#why-not-assess-the-estimated-se-directly"><i class="fa fa-check"></i><b>9.4.1</b> Why Not Assess the Estimated SE directly?</a></li>
<li class="chapter" data-level="9.4.2" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-ses-for-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>9.4.2</b> Assessing SEs for Our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-an-inferential-procedure-hypothesis-testing"><i class="fa fa-check"></i><b>9.5</b> Assessing an Inferential Procedure (Hypothesis Testing)</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="performance-criteria.html"><a href="performance-criteria.html#validity"><i class="fa fa-check"></i><b>9.5.1</b> Validity</a></li>
<li class="chapter" data-level="9.5.2" data-path="performance-criteria.html"><a href="performance-criteria.html#power"><i class="fa fa-check"></i><b>9.5.2</b> Power</a></li>
<li class="chapter" data-level="9.5.3" data-path="performance-criteria.html"><a href="performance-criteria.html#the-rejection-rate"><i class="fa fa-check"></i><b>9.5.3</b> The Rejection Rate</a></li>
<li class="chapter" data-level="9.5.4" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-in-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>9.5.4</b> Inference in our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-confidence-intervals"><i class="fa fa-check"></i><b>9.6</b> Assessing Confidence Intervals</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="performance-criteria.html"><a href="performance-criteria.html#confidence-intervals-in-our-cluster-rct-example"><i class="fa fa-check"></i><b>9.6.1</b> Confidence Intervals in our Cluster RCT Example</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="performance-criteria.html"><a href="performance-criteria.html#additional-thoughts-on-measuring-performance"><i class="fa fa-check"></i><b>9.7</b> Additional Thoughts on Measuring Performance</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="performance-criteria.html"><a href="performance-criteria.html#sec-relative-performance"><i class="fa fa-check"></i><b>9.7.1</b> Selecting Relative vs. Absolute Criteria</a></li>
<li class="chapter" data-level="9.7.2" data-path="performance-criteria.html"><a href="performance-criteria.html#robust-measures-of-performance"><i class="fa fa-check"></i><b>9.7.2</b> Robust Measures of Performance</a></li>
<li class="chapter" data-level="9.7.3" data-path="performance-criteria.html"><a href="performance-criteria.html#summary-of-peformance-measures"><i class="fa fa-check"></i><b>9.7.3</b> Summary of Peformance Measures</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="performance-criteria.html"><a href="performance-criteria.html#uncertainty-in-performance-estimates-the-mcse"><i class="fa fa-check"></i><b>9.8</b> Uncertainty in Performance Estimates (the MCSE)</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-for-relative-variance-estimators"><i class="fa fa-check"></i><b>9.8.1</b> MCSE for Relative Variance Estimators</a></li>
<li class="chapter" data-level="9.8.2" data-path="performance-criteria.html"><a href="performance-criteria.html#calculating-mcses-with-the-simhelpers-package"><i class="fa fa-check"></i><b>9.8.2</b> Calculating MCSEs With the <code>simhelpers</code> Package</a></li>
<li class="chapter" data-level="9.8.3" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-calculation-in-our-cluster-rct-example"><i class="fa fa-check"></i><b>9.8.3</b> MCSE Calculation in our Cluster RCT Example</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="performance-criteria.html"><a href="performance-criteria.html#exercises-5"><i class="fa fa-check"></i><b>9.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="case_Cronbach.html"><a href="case_Cronbach.html"><i class="fa fa-check"></i><b>10</b> Project: Cronbach Alpha</a>
<ul>
<li class="chapter" data-level="10.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#background"><i class="fa fa-check"></i><b>10.1</b> Background</a></li>
<li class="chapter" data-level="10.2" data-path="case_Cronbach.html"><a href="case_Cronbach.html#getting-started"><i class="fa fa-check"></i><b>10.2</b> Getting started</a></li>
<li class="chapter" data-level="10.3" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-data-generating-function"><i class="fa fa-check"></i><b>10.3</b> The data-generating function</a></li>
<li class="chapter" data-level="10.4" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-estimation-function"><i class="fa fa-check"></i><b>10.4</b> The estimation function</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercices-naive-confidence-intervals"><i class="fa fa-check"></i><b>10.4.1</b> Exercices (Naive confidence intervals)</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="case_Cronbach.html"><a href="case_Cronbach.html#estimator-performance"><i class="fa fa-check"></i><b>10.5</b> Estimator performance</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-calculating-performance"><i class="fa fa-check"></i><b>10.5.1</b> Exercises (Calculating Performance)</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="case_Cronbach.html"><a href="case_Cronbach.html#replication-and-the-simulation"><i class="fa fa-check"></i><b>10.6</b> Replication (and the simulation)</a></li>
<li class="chapter" data-level="10.7" data-path="case_Cronbach.html"><a href="case_Cronbach.html#extension-confidence-interval-coverage"><i class="fa fa-check"></i><b>10.7</b> Extension: Confidence interval coverage</a></li>
<li class="chapter" data-level="10.8" data-path="case_Cronbach.html"><a href="case_Cronbach.html#a-taste-of-multiple-scenarios"><i class="fa fa-check"></i><b>10.8</b> A taste of multiple scenarios</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-6"><i class="fa fa-check"></i><b>10.8.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html"><i class="fa fa-check"></i><b>11</b> Case study: Attrition in a simple randomized experiment</a>
<ul>
<li class="chapter" data-level="11.1" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#the-data-generating-process"><i class="fa fa-check"></i><b>11.1</b> The data generating process</a></li>
<li class="chapter" data-level="11.2" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#estimators"><i class="fa fa-check"></i><b>11.2</b> Estimators</a></li>
<li class="chapter" data-level="11.3" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#performance-criteria-1"><i class="fa fa-check"></i><b>11.3</b> Performance criteria</a></li>
</ul></li>
<li class="part"><span><b>III Multifactor Simulations</b></span></li>
<li class="chapter" data-level="12" data-path="exp-design.html"><a href="exp-design.html"><i class="fa fa-check"></i><b>12</b> Designing the multifactor simulation experiment</a>
<ul>
<li class="chapter" data-level="12.1" data-path="exp-design.html"><a href="exp-design.html#choosing-parameter-combinations"><i class="fa fa-check"></i><b>12.1</b> Choosing parameter combinations</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="exp-design.html"><a href="exp-design.html#choosing-parameters-for-the-clustered-rct"><i class="fa fa-check"></i><b>12.1.1</b> Choosing parameters for the Clustered RCT</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="exp-design.html"><a href="exp-design.html#using-pmap-to-run-multifactor-simulations"><i class="fa fa-check"></i><b>12.2</b> Using pmap to run multifactor simulations</a></li>
<li class="chapter" data-level="12.3" data-path="exp-design.html"><a href="exp-design.html#ways-of-repeating-oneself"><i class="fa fa-check"></i><b>12.3</b> Ways of repeating oneself</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="exp-design.html"><a href="exp-design.html#getting-raw-results-ready-for-analysis"><i class="fa fa-check"></i><b>12.3.1</b> Getting raw results ready for analysis</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="exp-design.html"><a href="exp-design.html#running-the-cluster-rct-multifactor-experiment"><i class="fa fa-check"></i><b>12.4</b> Running the Cluster RCT multifactor experiment</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="exp-design.html"><a href="exp-design.html#making-analyze_data-quiet"><i class="fa fa-check"></i><b>12.4.1</b> Making analyze_data() quiet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html"><i class="fa fa-check"></i><b>13</b> Analyzing the multifactor experiment</a>
<ul>
<li class="chapter" data-level="13.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#bundling"><i class="fa fa-check"></i><b>13.1</b> Bundling</a></li>
<li class="chapter" data-level="13.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#aggregation"><i class="fa fa-check"></i><b>13.2</b> Aggregation</a></li>
<li class="chapter" data-level="13.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#regression-summarization"><i class="fa fa-check"></i><b>13.3</b> Regression Summarization</a></li>
<li class="chapter" data-level="13.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focus-on-subset-kick-rest-to-supplement"><i class="fa fa-check"></i><b>13.4</b> Focus on subset, kick rest to supplement</a></li>
<li class="chapter" data-level="13.5" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#analyzing-results-when-some-trials-have-failed"><i class="fa fa-check"></i><b>13.5</b> Analyzing results when some trials have failed</a></li>
<li class="chapter" data-level="13.6" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#a-demonstration-of-visualization"><i class="fa fa-check"></i><b>13.6</b> A demonstration of visualization</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#the-initial-analysis"><i class="fa fa-check"></i><b>13.6.1</b> The initial analysis</a></li>
<li class="chapter" data-level="13.6.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focusing-on-validity"><i class="fa fa-check"></i><b>13.6.2</b> Focusing on validity</a></li>
<li class="chapter" data-level="13.6.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#looking-at-main-effects"><i class="fa fa-check"></i><b>13.6.3</b> Looking at main effects</a></li>
<li class="chapter" data-level="13.6.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#recap"><i class="fa fa-check"></i><b>13.6.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#exercises-7"><i class="fa fa-check"></i><b>13.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html"><i class="fa fa-check"></i><b>14</b> Case study: Comparing different estimators</a>
<ul>
<li class="chapter" data-level="14.1" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-generating-process-1"><i class="fa fa-check"></i><b>14.1</b> The data generating process</a></li>
<li class="chapter" data-level="14.2" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-analysis-methods"><i class="fa fa-check"></i><b>14.2</b> The data analysis methods</a></li>
<li class="chapter" data-level="14.3" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-simulation-itself"><i class="fa fa-check"></i><b>14.3</b> The simulation itself</a></li>
<li class="chapter" data-level="14.4" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#calculating-performance-measures-for-all-our-estimators"><i class="fa fa-check"></i><b>14.4</b> Calculating performance measures for all our estimators</a></li>
<li class="chapter" data-level="14.5" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#improving-the-visualization-of-the-results"><i class="fa fa-check"></i><b>14.5</b> Improving the visualization of the results</a></li>
<li class="chapter" data-level="14.6" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#extension-the-bias-variance-tradeoff"><i class="fa fa-check"></i><b>14.6</b> Extension: The Bias-variance tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html"><i class="fa fa-check"></i><b>15</b> Presentation of simulation results</a>
<ul>
<li class="chapter" data-level="15.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#tabulation"><i class="fa fa-check"></i><b>15.1</b> Tabulation</a></li>
<li class="chapter" data-level="15.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#visualization"><i class="fa fa-check"></i><b>15.2</b> Visualization</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-1-biserial-correlation-estimation"><i class="fa fa-check"></i><b>15.2.1</b> Example 1: Biserial correlation estimation</a></li>
<li class="chapter" data-level="15.2.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-2-variance-estimation-and-meta-regression"><i class="fa fa-check"></i><b>15.2.2</b> Example 2: Variance estimation and Meta-regression</a></li>
<li class="chapter" data-level="15.2.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-heat-maps-of-coverage"><i class="fa fa-check"></i><b>15.2.3</b> Example: Heat maps of coverage</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#modeling"><i class="fa fa-check"></i><b>15.3</b> Modeling</a></li>
</ul></li>
<li class="part"><span><b>IV Common Challenges with Large-Scale Simulations</b></span></li>
<li class="chapter" data-level="16" data-path="sec-reproducability.html"><a href="sec-reproducability.html"><i class="fa fa-check"></i><b>16</b> Ensuring reproducibility</a>
<ul>
<li class="chapter" data-level="16.1" data-path="sec-reproducability.html"><a href="sec-reproducability.html#seeds-and-pseudo-random-number-generators"><i class="fa fa-check"></i><b>16.1</b> Seeds and pseudo-random number generators</a></li>
<li class="chapter" data-level="16.2" data-path="sec-reproducability.html"><a href="sec-reproducability.html#including-seed-in-our-simulation-driver"><i class="fa fa-check"></i><b>16.2</b> Including seed in our simulation driver</a></li>
<li class="chapter" data-level="16.3" data-path="sec-reproducability.html"><a href="sec-reproducability.html#reasons-for-setting-the-seed"><i class="fa fa-check"></i><b>16.3</b> Reasons for setting the seed</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="optimize-code.html"><a href="optimize-code.html"><i class="fa fa-check"></i><b>17</b> Optimizing code (and why you often shouldn’t)</a>
<ul>
<li class="chapter" data-level="17.1" data-path="optimize-code.html"><a href="optimize-code.html#hand-building-functions"><i class="fa fa-check"></i><b>17.1</b> Hand-building functions</a></li>
<li class="chapter" data-level="17.2" data-path="optimize-code.html"><a href="optimize-code.html#sec_comp_efficiency"><i class="fa fa-check"></i><b>17.2</b> Computational efficiency versus simplicity</a></li>
<li class="chapter" data-level="17.3" data-path="optimize-code.html"><a href="optimize-code.html#reusing-code-to-speed-up-computation"><i class="fa fa-check"></i><b>17.3</b> Reusing code to speed up computation</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html"><i class="fa fa-check"></i><b>18</b> Error trapping and other headaches</a>
<ul>
<li class="chapter" data-level="18.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#safe_code"><i class="fa fa-check"></i><b>18.1</b> Safe code</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#making-a-safe-function-call"><i class="fa fa-check"></i><b>18.1.1</b> Making a safe function call</a></li>
<li class="chapter" data-level="18.1.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#what-to-do-with-warnings-in-simulations"><i class="fa fa-check"></i><b>18.1.2</b> What to do with warnings in simulations</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#about-stopifnot"><i class="fa fa-check"></i><b>18.2</b> Protecting your functions with “stop”</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="saving-files.html"><a href="saving-files.html"><i class="fa fa-check"></i><b>19</b> Saving files and results</a>
<ul>
<li class="chapter" data-level="19.1" data-path="saving-files.html"><a href="saving-files.html#saving-simulations-in-general"><i class="fa fa-check"></i><b>19.1</b> Saving simulations in general</a></li>
<li class="chapter" data-level="19.2" data-path="saving-files.html"><a href="saving-files.html#saving-simulations-as-you-go"><i class="fa fa-check"></i><b>19.2</b> Saving simulations as you go</a></li>
<li class="chapter" data-level="19.3" data-path="saving-files.html"><a href="saving-files.html#dynamically-making-directories"><i class="fa fa-check"></i><b>19.3</b> Dynamically making directories</a></li>
<li class="chapter" data-level="19.4" data-path="saving-files.html"><a href="saving-files.html#loading-and-combining-files-of-simulation-results"><i class="fa fa-check"></i><b>19.4</b> Loading and combining files of simulation results</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="parallel-processing.html"><a href="parallel-processing.html"><i class="fa fa-check"></i><b>20</b> Parallel Processing</a>
<ul>
<li class="chapter" data-level="20.1" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-on-your-computer"><i class="fa fa-check"></i><b>20.1</b> Parallel on your computer</a></li>
<li class="chapter" data-level="20.2" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-off-your-computer"><i class="fa fa-check"></i><b>20.2</b> Parallel off your computer</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="parallel-processing.html"><a href="parallel-processing.html#what-is-a-command-line-interface"><i class="fa fa-check"></i><b>20.2.1</b> What is a command-line interface?</a></li>
<li class="chapter" data-level="20.2.2" data-path="parallel-processing.html"><a href="parallel-processing.html#running-a-job-on-a-cluster"><i class="fa fa-check"></i><b>20.2.2</b> Running a job on a cluster</a></li>
<li class="chapter" data-level="20.2.3" data-path="parallel-processing.html"><a href="parallel-processing.html#checking-on-a-job"><i class="fa fa-check"></i><b>20.2.3</b> Checking on a job</a></li>
<li class="chapter" data-level="20.2.4" data-path="parallel-processing.html"><a href="parallel-processing.html#running-lots-of-jobs-on-a-cluster"><i class="fa fa-check"></i><b>20.2.4</b> Running lots of jobs on a cluster</a></li>
<li class="chapter" data-level="20.2.5" data-path="parallel-processing.html"><a href="parallel-processing.html#resources-for-harvards-odyssey"><i class="fa fa-check"></i><b>20.2.5</b> Resources for Harvard’s Odyssey</a></li>
<li class="chapter" data-level="20.2.6" data-path="parallel-processing.html"><a href="parallel-processing.html#acknowledgements-1"><i class="fa fa-check"></i><b>20.2.6</b> Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html"><i class="fa fa-check"></i><b>21</b> Simulations as evidence</a>
<ul>
<li class="chapter" data-level="21.1" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#use-extensive-multi-factor-simulations"><i class="fa fa-check"></i><b>21.1</b> Use extensive multi-factor simulations</a></li>
<li class="chapter" data-level="21.2" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#beat-them-at-their-own-game"><i class="fa fa-check"></i><b>21.2</b> Beat them at their own game</a></li>
<li class="chapter" data-level="21.3" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#calibrated-simulations"><i class="fa fa-check"></i><b>21.3</b> Calibrated simulations</a></li>
</ul></li>
<li class="part"><span><b>V Specialized Use-Cases</b></span></li>
<li class="chapter" data-level="22" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html"><i class="fa fa-check"></i><b>22</b> Using simulation as a power calculator</a>
<ul>
<li class="chapter" data-level="22.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#getting-design-parameters-from-pilot-data"><i class="fa fa-check"></i><b>22.1</b> Getting design parameters from pilot data</a></li>
<li class="chapter" data-level="22.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#the-data-generating-process-2"><i class="fa fa-check"></i><b>22.2</b> The data generating process</a></li>
<li class="chapter" data-level="22.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#running-the-simulation-1"><i class="fa fa-check"></i><b>22.3</b> Running the simulation</a></li>
<li class="chapter" data-level="22.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#evaluating-power"><i class="fa fa-check"></i><b>22.4</b> Evaluating power</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#checking-validity-of-our-models"><i class="fa fa-check"></i><b>22.4.1</b> Checking validity of our models</a></li>
<li class="chapter" data-level="22.4.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-precision-se"><i class="fa fa-check"></i><b>22.4.2</b> Assessing Precision (SE)</a></li>
<li class="chapter" data-level="22.4.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-power"><i class="fa fa-check"></i><b>22.4.3</b> Assessing power</a></li>
<li class="chapter" data-level="22.4.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-minimum-detectable-effects"><i class="fa fa-check"></i><b>22.4.4</b> Assessing Minimum Detectable Effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html"><i class="fa fa-check"></i><b>23</b> Simulation under the Potential Outcomes Framework</a>
<ul>
<li class="chapter" data-level="23.1" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#finite-vs.-superpopulation-inference"><i class="fa fa-check"></i><b>23.1</b> Finite vs. Superpopulation inference</a></li>
<li class="chapter" data-level="23.2" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#data-generation-processes-for-potential-outcomes"><i class="fa fa-check"></i><b>23.2</b> Data generation processes for potential outcomes</a></li>
<li class="chapter" data-level="23.3" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#finite-sample-performance-measures"><i class="fa fa-check"></i><b>23.3</b> Finite sample performance measures</a></li>
<li class="chapter" data-level="23.4" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#nested-finite-simulation-procedure"><i class="fa fa-check"></i><b>23.4</b> Nested finite simulation procedure</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>24</b> The Parametric bootstrap</a>
<ul>
<li class="chapter" data-level="24.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#air-conditioners-a-stolen-case-study"><i class="fa fa-check"></i><b>24.1</b> Air conditioners: a stolen case study</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="on-functions.html"><a href="on-functions.html"><i class="fa fa-check"></i><b>A</b> Coding tidbits</a>
<ul>
<li class="chapter" data-level="A.1" data-path="on-functions.html"><a href="on-functions.html#repeating-oneself"><i class="fa fa-check"></i><b>A.1</b> Other ways of repeating yourself</a></li>
<li class="chapter" data-level="A.2" data-path="on-functions.html"><a href="on-functions.html#default-arguments"><i class="fa fa-check"></i><b>A.2</b> Default arguments for functions</a></li>
<li class="chapter" data-level="A.3" data-path="on-functions.html"><a href="on-functions.html#testing-and-debugging-code-in-your-scripts"><i class="fa fa-check"></i><b>A.3</b> Testing and debugging code in your scripts</a></li>
<li class="chapter" data-level="A.4" data-path="on-functions.html"><a href="on-functions.html#keep-multiple-files-of-code"><i class="fa fa-check"></i><b>A.4</b> Keep multiple files of code</a></li>
<li class="chapter" data-level="A.5" data-path="on-functions.html"><a href="on-functions.html#the-source-command-and-keeping-things-organized"><i class="fa fa-check"></i><b>A.5</b> The source command and keeping things organized</a></li>
<li class="chapter" data-level="A.6" data-path="on-functions.html"><a href="on-functions.html#debugging-with-browser"><i class="fa fa-check"></i><b>A.6</b> Debugging with browser</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="further-readings-and-resources.html"><a href="further-readings-and-resources.html"><i class="fa fa-check"></i><b>B</b> Further readings and resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Designing Monte Carlo Simulations in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="structure-of-a-simulation-study" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Structure of a simulation study<a href="structure-of-a-simulation-study.html#structure-of-a-simulation-study" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Monte Carlo simulation is a very flexible tool that researchers use to study a vast array of different models and topics.
However, within the realm of methodological studies, simulations share a common structure, nearly always involving the same set of steps or component pieces.
In learning to design your own simulations, it is very useful to recognize the core, abstract components that most simulation studies share.
Identifying these components will help you to organize your work and structure the coding tasks involved in writing a simulation.</p>
<p>In this chapter, we outline the component structure of a methodological simulation study, highlighting the four steps involved in a simulation of a single scenario and the three additional steps involved in multifactor simulations.
We then describe a strategy for implementing simulations that mirrors the same component structure, where each step in the simulation is represented by a separate function or object.
We call this strategy <strong><em>tidy, modular simulation</em></strong>.
Finally, we show how the tidy, modular simulation strategy informs the structure and organization of code for a simulation study, walking through basic code skeletons (cf. <a href="programming-preliminaries.html#function-skeletons">2.3.5</a>) for each of the steps in a single-scenario simulation.</p>
<div id="general-structure-of-a-simulation" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> General structure of a simulation<a href="structure-of-a-simulation-study.html#general-structure-of-a-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The four main steps involved in a simulation study, introduced in Chapter <a href="introduction.html#introduction">1</a>, are summarized in the top portion of Table <a href="structure-of-a-simulation-study.html#tab:simulation">4.1</a>.</p>
<table>
<caption><span id="tab:simulation">Table 4.1: </span> Steps in the Simulation Process</caption>
<colgroup>
<col width="10%" />
<col width="46%" />
<col width="43%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Step</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><strong>Generate</strong></td>
<td>Generate a sample of artificial data based on a specific statistical model or data-generating process.</td>
</tr>
<tr class="even">
<td>2</td>
<td><strong>Analyze</strong></td>
<td>Apply one or more data-analysis procedures, estimators, or workflows to the artificial data.</td>
</tr>
<tr class="odd">
<td>3</td>
<td><strong>Repeat</strong></td>
<td>Repeat steps (1) &amp; (2) <span class="math inline">\(R\)</span> times, recording <span class="math inline">\(R\)</span> sets of results.</td>
</tr>
<tr class="even">
<td>4</td>
<td><strong>Summarize</strong></td>
<td>Assess the performance of the procedure across the <span class="math inline">\(R\)</span> replications.</td>
</tr>
<tr class="odd">
<td>5</td>
<td><strong>Design</strong></td>
<td>Specify a set of conditions to examine</td>
</tr>
<tr class="even">
<td>6</td>
<td><strong>Execute</strong></td>
<td>Run the simulation for each condition in the design.</td>
</tr>
<tr class="odd">
<td>7</td>
<td><strong>Synthesize</strong></td>
<td>Compare performance across conditions.</td>
</tr>
</tbody>
</table>
<p>In the simple <span class="math inline">\(t\)</span>-test example presented in Chapter <a href="t-test-simulation.html#t-test-simulation">3</a>, we put each of these steps into action with R code:</p>
<ul>
<li>We used the geometric distribution as a data-generating process;</li>
<li>We used the confidence interval from a one-sample <span class="math inline">\(t\)</span>-test as the data-analysis procedure;</li>
<li>We repeatedly simulated the confidence intervals with R’s <code>replicate()</code> function; and</li>
<li>We summarized the results by estimating the fraction of the intervals that covered the population mean.</li>
</ul>
<p>We also saw that it was helpful to wrap all of these steps up into a single function, so that we could run the simulation across multiple sample sizes.</p>
<p>These four initial steps are common and shared across nearly all simulations.
In our first example, each of the steps was fairly simple, sometimes involving only a single line of code.
More generally, each of the steps might be quite a bit more complex. The data-generating process might involve a more complex model with multiple variables or multilevel structure.
The data analysis procedure might involve solving a multidimensional optimization problem to get parameter estimates, or might involve a data analysis workflow with multiple steps or contingencies.
Further, we might use more than one metric for summarizing the results across replications and describing the performance of the data analysis procedure.
Because each of the four steps involves its own set of choices, it will useful to recognize them as distinct from one another.</p>
<p>In methodological research projects, we usually want to examine simulation results across an array of different conditions that differ not only in terms of sample size, but also in other parameters or features of the data-generating process.
Running a simulation study across multiple conditions entails several further steps, which are summarized in the bottom portion of Table <a href="structure-of-a-simulation-study.html#tab:simulation">4.1</a>. We will first need to specify the factors and specific conditions to be examined in our experimental design. We will then need to execute the simulation for each of the conditions and store all the results for further analysis. Finally, we will need to find ways to synthesize or make sense of the main patterns in the results across all of the conditions in the design.</p>
<p>Just as with the first four steps, it is useful to recognize these further steps as distinct from one another, each involving its own set of choices and techniques.
The design step requires choosing which parameters and features of the data-generating process to vary, as well as which specific values to use for each factor that is varied.
Executing a simulation might require a lot of computing power, especially if the simulation design has many conditions or the data analysis procedure takes a long time to compute.
How to effectively implement the execution step will therefore depend on the computing requirements and available resources.
Finally, many different techniques can be used to synthesizing findings from a multifactor simulation.
Which ones are most useful will depend on one’s research questions and the choices made in each of the preceeding steps.</p>
<!--Across all seven steps, recognizing the distinct pieces will let us more effectively tackle the many decisions involved in designing and running a simulation.-->
</div>
<div id="tidy-modular-simulations" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Tidy, modular simulations<a href="structure-of-a-simulation-study.html#tidy-modular-simulations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is apparent from Table <a href="structure-of-a-simulation-study.html#tab:simulation">4.1</a> that writing a simulation in R involves a bunch of considerations.
Considering the number of choices to be made, it is critical to stay organized and to approach the process systematically.
Recognizing the components of a simulation is the starting point.
Next is to see how to translate the components into R code.</p>
<p>In our own methodological work, we have found it very useful to always follow the same approach to writing code for a simulation.
We call this approach <em>tidy, modular simulation</em>. It involves two simple principles:</p>
<ol style="list-style-type: decimal">
<li>Implement each component of a simulation as its own, separate function or object.</li>
<li>Store all results in rectangular data sets.</li>
</ol>
<p>Writing separate functions for each component step of a simulation has several benefits.
The first is the practical benefit of turning the coding process from a monolithic (and potentially daunting) activity into a set of smaller, discrete tasks.
This lets us focus on one task at a time and makes it easier to see progress.
Second, following this principle makes for code that is easier to read, test, and debug.
Rather than having to scan through an entire code file to understand how the data analysis procedure is implemented, we can quickly identify the function that implements it, then focus on understanding the working of that function.
Likewise, if another researcher wanted to test out the data analysis procedure on a dataset of their own, they could do so by running the corresponding function rather than having to dissect an entire script.
Third, writing separate code for each component makes it possible to tweak the code or swap out pieces of the simulation, such as by adding additional estimation methods or trying out a data-generating process with different distributional assumptions.
We already saw this in Chapter <a href="t-test-simulation.html#t-test-simulation">3</a>, where we modified our initial data-generating process to use a geometric distribution rather than a normal distribution.
In short, following the first principle makes for simpler, more robust code that is easier to navigate and extend.</p>
<p>The second principle of tidy, modular simulation is to store all results in rectangular datasets, such as the base R <code>data.frame</code> object or the tidyverse <code>tibble</code> object.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>
This principle applies to any and all output, including the simulated data from Step 1, the results of data analysis procedures from Step 2, full sets of replicated simulation results from Step 3, and summarized results from Step 4.
A primary benefit of following this principle is that it facilitates working with the output of each stage in the simulation process.
Analysts who are comfortable using R to analyze real data will find that they can use the same skills and tools to examine simulation output if it is in tabular form.
Many of the data processing and data analysis tools available in R work with—or even require—rectangular datasets.
Thus, using rectangular datasets makes it easier to inspect, summarize, and visualize the output.</p>
</div>
<div id="skeleton-of-a-simulation-study" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Skeleton of a simulation study<a href="structure-of-a-simulation-study.html#skeleton-of-a-simulation-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The principles of tidy simulation imply that code for a simulation study should usually follow the same broad outline and organization of Table <a href="structure-of-a-simulation-study.html#tab:simulation">4.1</a>, with custom functions for each step in process.
We will describe the outlines of simulation code using function skeletons to illustrate the inputs and outputs of each component.
These skeletons skip over all the specific details, so that we can see the structure more clearly.
We will first examine the structure of the code for simulating one specific scenario, then consider how to extend the code to systematically explore a variety of scenarios, as in a multifactor simulation.</p>
<p>We write out the structure of the first four steps in skeleton code as follows:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="structure-of-a-simulation-study.html#cb84-1" tabindex="-1"></a><span class="co"># Generate (data-generating process)</span></span>
<span id="cb84-2"><a href="structure-of-a-simulation-study.html#cb84-2" tabindex="-1"></a></span>
<span id="cb84-3"><a href="structure-of-a-simulation-study.html#cb84-3" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>( model_params ) {</span>
<span id="cb84-4"><a href="structure-of-a-simulation-study.html#cb84-4" tabindex="-1"></a>  <span class="co"># stuff</span></span>
<span id="cb84-5"><a href="structure-of-a-simulation-study.html#cb84-5" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb84-6"><a href="structure-of-a-simulation-study.html#cb84-6" tabindex="-1"></a>}</span>
<span id="cb84-7"><a href="structure-of-a-simulation-study.html#cb84-7" tabindex="-1"></a></span>
<span id="cb84-8"><a href="structure-of-a-simulation-study.html#cb84-8" tabindex="-1"></a><span class="co"># Analyze (data-analysis procedure)</span></span>
<span id="cb84-9"><a href="structure-of-a-simulation-study.html#cb84-9" tabindex="-1"></a></span>
<span id="cb84-10"><a href="structure-of-a-simulation-study.html#cb84-10" tabindex="-1"></a>analyze <span class="ot">&lt;-</span> <span class="cf">function</span>( data ) {</span>
<span id="cb84-11"><a href="structure-of-a-simulation-study.html#cb84-11" tabindex="-1"></a>  <span class="co"># stuff</span></span>
<span id="cb84-12"><a href="structure-of-a-simulation-study.html#cb84-12" tabindex="-1"></a>  <span class="fu">return</span>(one_result)</span>
<span id="cb84-13"><a href="structure-of-a-simulation-study.html#cb84-13" tabindex="-1"></a>}</span>
<span id="cb84-14"><a href="structure-of-a-simulation-study.html#cb84-14" tabindex="-1"></a></span>
<span id="cb84-15"><a href="structure-of-a-simulation-study.html#cb84-15" tabindex="-1"></a><span class="co"># Repeat</span></span>
<span id="cb84-16"><a href="structure-of-a-simulation-study.html#cb84-16" tabindex="-1"></a></span>
<span id="cb84-17"><a href="structure-of-a-simulation-study.html#cb84-17" tabindex="-1"></a>one_run <span class="ot">&lt;-</span> <span class="cf">function</span>( model_params ) {</span>
<span id="cb84-18"><a href="structure-of-a-simulation-study.html#cb84-18" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">generate_data</span>( model_params )</span>
<span id="cb84-19"><a href="structure-of-a-simulation-study.html#cb84-19" tabindex="-1"></a>  one_result <span class="ot">&lt;-</span> <span class="fu">analyze</span>(dat)</span>
<span id="cb84-20"><a href="structure-of-a-simulation-study.html#cb84-20" tabindex="-1"></a>  <span class="fu">return</span>(one_result)</span>
<span id="cb84-21"><a href="structure-of-a-simulation-study.html#cb84-21" tabindex="-1"></a>}</span>
<span id="cb84-22"><a href="structure-of-a-simulation-study.html#cb84-22" tabindex="-1"></a></span>
<span id="cb84-23"><a href="structure-of-a-simulation-study.html#cb84-23" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span>R, <span class="sc">~</span> <span class="fu">one_run</span>( params ))</span>
<span id="cb84-24"><a href="structure-of-a-simulation-study.html#cb84-24" tabindex="-1"></a></span>
<span id="cb84-25"><a href="structure-of-a-simulation-study.html#cb84-25" tabindex="-1"></a><span class="co"># Summarize (calculate performance measures)</span></span>
<span id="cb84-26"><a href="structure-of-a-simulation-study.html#cb84-26" tabindex="-1"></a></span>
<span id="cb84-27"><a href="structure-of-a-simulation-study.html#cb84-27" tabindex="-1"></a>assess_performance <span class="ot">&lt;-</span> <span class="cf">function</span>( results, model_params ) {</span>
<span id="cb84-28"><a href="structure-of-a-simulation-study.html#cb84-28" tabindex="-1"></a>  <span class="co"># stuff</span></span>
<span id="cb84-29"><a href="structure-of-a-simulation-study.html#cb84-29" tabindex="-1"></a>  <span class="fu">return</span>(performance_measures)</span>
<span id="cb84-30"><a href="structure-of-a-simulation-study.html#cb84-30" tabindex="-1"></a>}</span>
<span id="cb84-31"><a href="structure-of-a-simulation-study.html#cb84-31" tabindex="-1"></a></span>
<span id="cb84-32"><a href="structure-of-a-simulation-study.html#cb84-32" tabindex="-1"></a><span class="fu">assess_performance</span>(results, model_params)</span></code></pre></div>
<p>The code above shows the full skeleton of a simulation.
It involves four functions, where the outputs of one function get used as inputs in subsequent functions.
We will now look at the inputs and outputs of each function to see how they align with the four steps in the simulation process.
Subsequent chapters examine each piece in much greater detail—putting meat on the bones of each function skeleton, to torture our metaphor—and discussing techniques and examples of how to design the components.</p>
<p>Besides illustrating the skeletal framework of a simulation, readers might find it useful to use it as a template from which to start writing their own code.
The <code>simhelpers</code> package includes the function <code>create_skeleton()</code>, which will open a new R script that contains a template for a simulation study, with sections corresponding to each component:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="structure-of-a-simulation-study.html#cb85-1" tabindex="-1"></a>simhelpers<span class="sc">::</span><span class="fu">create_skeleton</span>()</span></code></pre></div>
<p>The template that appears is a slightly more elaborate version of the code above, with the main difference being that it also includes some additional lines of code to wire the pieces together for a multifactor simulation.
Starting from this template, you will already be well on the road to writing a tidy, modular simulation.</p>
<div id="data-generating-process" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Data-Generating Process<a href="structure-of-a-simulation-study.html#data-generating-process" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first step in a simulation is specifying a data-generating process. This is a hypothetical model for how data might arise, involving measurements or observations of one or more variables. The bare-bones skeleton of a data-generating function looks like the following:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="structure-of-a-simulation-study.html#cb86-1" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>( model_params ) {</span>
<span id="cb86-2"><a href="structure-of-a-simulation-study.html#cb86-2" tabindex="-1"></a>  <span class="co"># stuff</span></span>
<span id="cb86-3"><a href="structure-of-a-simulation-study.html#cb86-3" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb86-4"><a href="structure-of-a-simulation-study.html#cb86-4" tabindex="-1"></a>}</span></code></pre></div>
<p>The function takes as input a set of model parameter values, denoted here as <code>model_params</code>.
Based on those model parameters, the function generates a hypothetical dataset as output.
Generating our own data based on a model allows us to know what the answer is (e.g., the true population mean or the true average effect of an intervention), so that we have benchmark against which to compare the results of a data analysis procedure that generates noisy estimates of the true value.</p>
<p>In practice, <code>model_params</code> will usually not be just one input but rather multiple arguments.
These arguments might include inputs such as the population mean for a variable, the standard deviation of a distribution of treatment effects, or a parameter controlling the degree of skewness in the population distribution.
Many data-generating processes involving multiple variables, such as the response variable and predictor variables in a regression model.
In such instances, the inputs of <code>generate_data()</code> might also include parameters that determine the degree of dependence or correlation between variables.
Further, the <code>generate_data()</code> inputs will also usually include arguments relating to the sample size and structure of the hypothetical dataset.
For instance, in a simulation of a multilevel dataset where individuals are nested within clusters, the inputs might include an arguments to specify the total number of clusters and the average number of individuals per cluster.
We discuss the inputs and form of the data-generating function further in Chapter <a href="data-generating-processes.html#data-generating-processes">6</a>.</p>
</div>
<div id="data-analysis-procedure" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Data Analysis Procedure<a href="structure-of-a-simulation-study.html#data-analysis-procedure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The second step in a simulation is specifying a data analysis procedure or set of procedures.
The bare-bones skeleton of a data-generating function looks like the following:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="structure-of-a-simulation-study.html#cb87-1" tabindex="-1"></a>analyze <span class="ot">&lt;-</span> <span class="cf">function</span>( data ) {</span>
<span id="cb87-2"><a href="structure-of-a-simulation-study.html#cb87-2" tabindex="-1"></a>  <span class="co"># stuff</span></span>
<span id="cb87-3"><a href="structure-of-a-simulation-study.html#cb87-3" tabindex="-1"></a>  <span class="fu">return</span>(one_result)</span>
<span id="cb87-4"><a href="structure-of-a-simulation-study.html#cb87-4" tabindex="-1"></a>}</span></code></pre></div>
<p>The function should take a single dataset as input and produce a set of estimates or results (e.g., point estimates, standard errors, confidence intervals, p-values, predictions, etc.).
Because we will be using the function to analyze hypothetical datasets simulated from the data-generating process, the <code>analyze()</code> function needs to work with <code>data</code> inputs that are produced by the <code>generate_data()</code> function.
Thus, the code in the body of <code>analyze()</code> can assume that <code>data</code> will include relevant variables with specific names.</p>
<p>Inside the body of the function, <code>analyze()</code> includes code to carry out a data analysis procedure.
This might involve generating a confidence interval, as in the example from Chapter <a href="t-test-simulation.html#t-test-simulation">3</a>.
In another context, it might involve estimating an average growth rate along with a standard error, given a dataset with longitudinal repeated measurements from multiple individuals.
In still another context, it might involve generating individual-level predictions from a machine learning algorithm.
In simulations that involve comparing multiple analysis methods, we might write an <code>analyze()</code> function for each of the methods of interest, or (generally less preferred) we might write one function that does the calculations for all of the methods together.</p>
<p>A well-written estimation method should, in principle, work not only on a simulated, hypothetical dataset but also on a real empirical dataset that has the same format (i.e., appropriate variable names and structure).
Because of this, the inputs of the <code>analyze()</code> function should not typically include any information about the parameters of the data-generating process.
To be realistic, the code for our simulated data-analysis procedure should not make use of anything that the analyst could not know when analyzing a real dataset.
Thus, <code>analyze()</code> has an argument for the sample dataset but not for <code>model_params</code>.
We discuss the form and content of the data analysis function further in Chapter <a href="data-analysis-procedures.html#data-analysis-procedures">7</a>.</p>
</div>
<div id="repetition" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Repetition<a href="structure-of-a-simulation-study.html#repetition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The third step in a simulation is to repeatedly evaluate the data-generating process and data analysis procedure.
In practice, this amounts to repeatedly calling <code>generate_data()</code> and then calling <code>analyze()</code> on the result.
Here is the skeleton from our simulation template:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="structure-of-a-simulation-study.html#cb88-1" tabindex="-1"></a>one_run <span class="ot">&lt;-</span> <span class="cf">function</span>( model_params ) {</span>
<span id="cb88-2"><a href="structure-of-a-simulation-study.html#cb88-2" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">generate_data</span>( model_params )</span>
<span id="cb88-3"><a href="structure-of-a-simulation-study.html#cb88-3" tabindex="-1"></a>  one_result <span class="ot">&lt;-</span> <span class="fu">analyze</span>(dat)</span>
<span id="cb88-4"><a href="structure-of-a-simulation-study.html#cb88-4" tabindex="-1"></a>  <span class="fu">return</span>(one_result)</span>
<span id="cb88-5"><a href="structure-of-a-simulation-study.html#cb88-5" tabindex="-1"></a>}</span>
<span id="cb88-6"><a href="structure-of-a-simulation-study.html#cb88-6" tabindex="-1"></a></span>
<span id="cb88-7"><a href="structure-of-a-simulation-study.html#cb88-7" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>R, <span class="sc">~</span> <span class="fu">one_run</span>( params ))</span></code></pre></div>
<p>We first create a helper function called <code>one_run()</code>, which takes <code>model_params</code> as input.
Inside the body of the function, we call the <code>generate_data()</code> function to simulate a hypothetical dataset.
We pass this dataset to <code>analyze()</code> and return a small dataset containing the results of the data-analysis procedure.
The <code>one_run()</code> method is like a coordinator or dispatcher of the system: it generates the data, calls all the evaluation methods we want to call, combines all the results, and hands them back for recording.
Making a helper method such as <code>one_run()</code> can be helpful because it facilitates debugging.</p>
<p>Once we have the <code>one_run()</code> helper function, we need a way to call it repeatedly. As with many things in R, there are a variety of different ways to do something over and over.
In the above skeleton, we use the <code>map_dfr()</code> function from the <code>purrr</code> package.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>
In the first argument, we specify a list of indices, one for each time we want to repeat the simulation process.
In the second argument, we specify an anonymous function that evaluates <code>one_run()</code> for specified values of the model parameters stored in <code>params</code>.
The <code>map_dfr()</code> function then calls the function on each entry in the list of indices, repeating the simulation process <code>R</code> times in all.
The function then stacks up all of the replications into a big dataset, with one or more rows per replication.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<p>We go into further detail about how to approach running the simulation process in Chapter <a href="running-the-simulation-process.html#running-the-simulation-process">8</a>.
Among other things, we will illustrate how to use the <code>simhelpers</code> package to automate the process of coding this step, thereby avoiding the need to write a <code>one_run()</code> helper function.</p>
</div>
<div id="performance-summaries" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Performance summaries<a href="structure-of-a-simulation-study.html#performance-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The fourth step in a simulation is to summarize the distribution of simulation results across replications.
Here is the skeleton from our simulation template:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="structure-of-a-simulation-study.html#cb90-1" tabindex="-1"></a>assess_performance <span class="ot">&lt;-</span> <span class="cf">function</span>( results, model_params ) {</span>
<span id="cb90-2"><a href="structure-of-a-simulation-study.html#cb90-2" tabindex="-1"></a>  <span class="co"># stuff</span></span>
<span id="cb90-3"><a href="structure-of-a-simulation-study.html#cb90-3" tabindex="-1"></a>  <span class="fu">return</span>(performance_measures)</span>
<span id="cb90-4"><a href="structure-of-a-simulation-study.html#cb90-4" tabindex="-1"></a>}</span>
<span id="cb90-5"><a href="structure-of-a-simulation-study.html#cb90-5" tabindex="-1"></a></span>
<span id="cb90-6"><a href="structure-of-a-simulation-study.html#cb90-6" tabindex="-1"></a><span class="fu">assess_performance</span>(results, params)</span></code></pre></div>
<p>The <code>assess_performance()</code> function takes <code>results</code> as input.
<code>results</code> should be a dataset containing all of the replications of the data-generating and analysis process.
<code>assess_performance()</code>’s other input is <code>model_params</code>, which includes the true parameter values of the data-generating process.
The function then uses these inputs to calculate performance measures and returns a summary of the performance measures in a dataset.</p>
<p>Performance measures are the metrics or criteria used to assess the performance of a statistical method across repeated samples from the data-generating process.
For example, we might want to know how close an estimator gets to the target parameter, on average.
We might want to know if a confidence interval captures the true parameter the right proportion of the time, as in the simulation from Chapter <a href="t-test-simulation.html#t-test-simulation">3</a>.
Performance is defined in terms of the sampling distribution of estimators or analysis results, across an infinite number of replications of the data-generating process.
In practice, we use many replications of the process, but still only a finite number. Consequently, we actually <em>estimate</em> the performance measures and need to attend to the Monte Carlo error in the estimates.
We discuss the specifics of different performance measures and assessment of Monte Carlo error in Chapter <a href="performance-criteria.html#performance-criteria">9</a>.</p>
</div>
<div id="multifactor-simulations" class="section level3 hasAnchor" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Multifactor simulations<a href="structure-of-a-simulation-study.html#multifactor-simulations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Thus far, we have sketched out the structure of a modular, tidy simulation for a single context.
In our <span class="math inline">\(t\)</span>-test case study, for example, we might ask how well the <span class="math inline">\(t\)</span>-test works when we have <span class="math inline">\(n=100\)</span> units and the observations follow geometric distribution.
However, we rarely want to examine a method only in a single context.
Typically, we want to explore how well a procedure works across a range of different contexts.
If we choose conditions in a structured and thoughtful manner, we will be able to examine broad trends and potentially make more general claims about the behaviors of the data-analysis procedures under investigation.
Thus, it is helpful to think of simulations as akin to a designed experiment: in seeking to understand the properties of one or more procedures, we test them under a variety of different scenarios to see how they perform, then seek to identify more general patterns that hold beyond the specific scenarios examined.
This is the heart of simulation for methodological evaluation.</p>
<p>To implement a multifactor simulation, we will follows the same principles of modular, tidy simulation.
In particular, we will take the code developed for simulating a single context and bundle it into a function that can be evaluated for any and all scenarios of interest.
Simulation studies often follow a full factorial design, in which each level of a factor (something we vary, such as sample size, true treatment effect, or residual variance) is crossed with every other level.
The experimental design then consists of sets of parameter values (including design parameters, such as sample sizes), and these too can be represented in an object, distinct from the other components of the simulation.
We will discuss multiple-scenario simulations in Part III (starting with Chapter <a href="exp-design.html#exp-design">12</a>), after we more fully develop the core concepts and techniques involved in simulating a single context.</p>
</div>
</div>
<div id="exercises-1" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Exercises<a href="structure-of-a-simulation-study.html#exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Look back at the <span class="math inline">\(t\)</span>-test simulation presented in Chapter <a href="t-test-simulation.html#t-test-simulation">3</a>. The code presented there did not entirely follow the formal structure outlined in this chapter. Revise the code by creating separate functions for each of four components in the simulation skeleton. Using the functions, re-run the simulation and recreate one or more graphs from the exercises in the previous chapter.</li>
</ol>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Wickham2014tidydata" class="csl-entry">
Wickham, Hadley. 2014. <span>“Tidy Data.”</span> <em>Journal of Statistical Software</em> 59 (10): 1–23. <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p><span class="citation">Wickham (<a href="#ref-Wickham2014tidydata">2014</a>)</span> provides a broader introduction to the concept of tidy data in the context of data-analysis tasks.<a href="structure-of-a-simulation-study.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>In the example from Chapter <a href="t-test-simulation.html#t-test-simulation">3</a>, we used the <code>replicate()</code> function from base R to repeat the process of generating and analyzing data.
This function is a fine alternative to the <code>map_dfr()</code> approach demonstrated in the skeleton.
The only drawback is that it requires some further work to combine the results across replications.
Here is a different version of the skeleton, which uses <code>replicate()</code> instead of <code>map_dfr()</code>:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>results_list <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> R, <span class="at">expr =</span> {</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">generate_data</span>( params )</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a>  one_result <span class="ot">&lt;-</span> <span class="fu">analyze</span>(dat)</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>  <span class="fu">return</span>(one_result)</span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>}, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">list_rbind</span>(results_list)</span></code></pre></div>
<p>This version of the skeleton does not create a <code>one_run()</code> helper function, but instead puts the code from the body of <code>one_run()</code> directly into the <code>expr</code> argument of <code>replicate()</code>.<a href="structure-of-a-simulation-study.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>The <code>_dfr</code> suffix in <code>map_dfr()</code> stands for <code>data.frame</code> by row, meaning that each evaluation should produce a <code>data.frame</code> as output, and the outputs will be stacked by row.<a href="structure-of-a-simulation-study.html#fnref7" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="t-test-simulation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="case-ANOVA.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jepusto/Designing-Simulations-in-R/edit/master/010-Simulation-structure.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Designing-Simulations-in-R.pdf", "Designing-Simulations-in-R.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
