<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 22 The Parametric bootstrap | Designing Monte Carlo Simulations in R</title>
  <meta name="description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 22 The Parametric bootstrap | Designing Monte Carlo Simulations in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="github-repo" content="jepusto/Designing-Simulations-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 22 The Parametric bootstrap | Designing Monte Carlo Simulations in R" />
  
  <meta name="twitter:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  

<meta name="author" content="Luke W. Miratrix and James E. Pustejovsky (Equal authors)" />


<meta name="date" content="2023-11-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulations-as-evidence.html"/>
<link rel="next" href="further-readings-and-resources.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Designing Simulations in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#some-of-simulations-many-uses"><i class="fa fa-check"></i><b>1.1</b> Some of simulation’s many uses</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#comparing-statistical-approaches"><i class="fa fa-check"></i><b>1.1.1</b> Comparing statistical approaches</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#assessing-performance-of-complex-pipelines"><i class="fa fa-check"></i><b>1.1.2</b> Assessing performance of complex pipelines</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#assessing-performance-under-misspecification"><i class="fa fa-check"></i><b>1.1.3</b> Assessing performance under misspecification</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#assessing-the-finite-sample-performance-of-a-statistical-approach"><i class="fa fa-check"></i><b>1.1.4</b> Assessing the finite sample performance of a statistical approach</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#conducting-power-analyses"><i class="fa fa-check"></i><b>1.1.5</b> Conducting Power Analyses</a></li>
<li class="chapter" data-level="1.1.6" data-path="introduction.html"><a href="introduction.html#simulating-processess"><i class="fa fa-check"></i><b>1.1.6</b> Simulating processess</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-perils-of-simulation-as-evidence"><i class="fa fa-check"></i><b>1.2</b> The perils of simulation as evidence</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#why-r-and-rstudio"><i class="fa fa-check"></i><b>1.3</b> Why R and RStudio?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#templates-vs.-patterns"><i class="fa fa-check"></i><b>1.3.1</b> Templates vs. Patterns</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#the-tidyverse-and-a-recommended-text"><i class="fa fa-check"></i><b>1.3.2</b> The tidyverse and a recommended text</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#functions"><i class="fa fa-check"></i><b>1.3.3</b> Functions</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#a-dangerous-function"><i class="fa fa-check"></i><b>1.3.4</b> A dangerous function</a></li>
<li class="chapter" data-level="1.3.5" data-path="introduction.html"><a href="introduction.html#function-skeletons"><i class="fa fa-check"></i><b>1.3.5</b> Function skeletons</a></li>
<li class="chapter" data-level="1.3.6" data-path="introduction.html"><a href="introduction.html#pipe-dreams"><i class="fa fa-check"></i><b>1.3.6</b> <code>%&gt;%</code> (Pipe) dreams</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html"><i class="fa fa-check"></i><b>2</b> An initial simulation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulation-for-a-single-scenario"><i class="fa fa-check"></i><b>2.1</b> Simulation for a single scenario</a></li>
<li class="chapter" data-level="2.2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulating-across-different-scenarios"><i class="fa fa-check"></i><b>2.2</b> Simulating across different scenarios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html"><i class="fa fa-check"></i><b>3</b> Structure of a simulation study</a>
<ul>
<li class="chapter" data-level="3.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#general-structure-of-a-simulation"><i class="fa fa-check"></i><b>3.1</b> General structure of a simulation</a></li>
<li class="chapter" data-level="3.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#tidy-simulations"><i class="fa fa-check"></i><b>3.2</b> Tidy simulations</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#the-data-generating-process-dgp"><i class="fa fa-check"></i><b>3.2.1</b> The Data Generating Process (DGP)</a></li>
<li class="chapter" data-level="3.2.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#estimation-methods"><i class="fa fa-check"></i><b>3.2.2</b> Estimation methods</a></li>
<li class="chapter" data-level="3.2.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#repetition"><i class="fa fa-check"></i><b>3.2.3</b> Repetition</a></li>
<li class="chapter" data-level="3.2.4" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#performance-summaries"><i class="fa fa-check"></i><b>3.2.4</b> Performance summaries</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#multiple-scenarios"><i class="fa fa-check"></i><b>3.3</b> Multiple Scenarios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="case_ANOVA.html"><a href="case_ANOVA.html"><i class="fa fa-check"></i><b>4</b> Case Study: Heteroskedastic ANOVA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="case_ANOVA.html"><a href="case_ANOVA.html#the-data-generating-model"><i class="fa fa-check"></i><b>4.1</b> The data-generating model</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="case_ANOVA.html"><a href="case_ANOVA.html#coding-remark"><i class="fa fa-check"></i><b>4.1.1</b> Coding remark</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="case_ANOVA.html"><a href="case_ANOVA.html#the-estimation-procedures"><i class="fa fa-check"></i><b>4.2</b> The estimation procedures</a></li>
<li class="chapter" data-level="4.3" data-path="case_ANOVA.html"><a href="case_ANOVA.html#running-the-simulation"><i class="fa fa-check"></i><b>4.3</b> Running the simulation</a></li>
<li class="chapter" data-level="4.4" data-path="case_ANOVA.html"><a href="case_ANOVA.html#analyzing-the-simulation"><i class="fa fa-check"></i><b>4.4</b> Analyzing the Simulation</a></li>
<li class="chapter" data-level="4.5" data-path="case_ANOVA.html"><a href="case_ANOVA.html#exAnovaExercises"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap_DGP.html"><a href="chap_DGP.html"><i class="fa fa-check"></i><b>5</b> Data-generating models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap_DGP.html"><a href="chap_DGP.html#a-statistical-model-is-a-recipe-for-data-generation"><i class="fa fa-check"></i><b>5.1</b> A statistical model is a recipe for data generation</a></li>
<li class="chapter" data-level="5.2" data-path="chap_DGP.html"><a href="chap_DGP.html#checking-the-data-generating-function"><i class="fa fa-check"></i><b>5.2</b> Checking the data-generating function</a></li>
<li class="chapter" data-level="5.3" data-path="chap_DGP.html"><a href="chap_DGP.html#case_cluster"><i class="fa fa-check"></i><b>5.3</b> Example: Simulating clustered data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chap_DGP.html"><a href="chap_DGP.html#a-design-decision-what-do-we-want-to-manipulate"><i class="fa fa-check"></i><b>5.3.1</b> A design decision: What do we want to manipulate?</a></li>
<li class="chapter" data-level="5.3.2" data-path="chap_DGP.html"><a href="chap_DGP.html#a-model-for-a-cluster-rct"><i class="fa fa-check"></i><b>5.3.2</b> A model for a cluster RCT</a></li>
<li class="chapter" data-level="5.3.3" data-path="chap_DGP.html"><a href="chap_DGP.html#converting-our-model-to-code"><i class="fa fa-check"></i><b>5.3.3</b> Converting our model to code</a></li>
<li class="chapter" data-level="5.3.4" data-path="chap_DGP.html"><a href="chap_DGP.html#standardization-in-a-data-generating-process"><i class="fa fa-check"></i><b>5.3.4</b> Standardization in a data generating process</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap_DGP.html"><a href="chap_DGP.html#exercises"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chap_DGP.html"><a href="chap_DGP.html#ex_dgp"><i class="fa fa-check"></i><b>5.4.1</b> The Shifted-and-scaled t distribution</a></li>
<li class="chapter" data-level="5.4.2" data-path="chap_DGP.html"><a href="chap_DGP.html#the-cluster-rct-dgp"><i class="fa fa-check"></i><b>5.4.2</b> The Cluster RCT DGP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimation-procedures.html"><a href="estimation-procedures.html"><i class="fa fa-check"></i><b>6</b> Estimation procedures</a>
<ul>
<li class="chapter" data-level="6.1" data-path="estimation-procedures.html"><a href="estimation-procedures.html#checking-the-estimation-function"><i class="fa fa-check"></i><b>6.1</b> Checking the estimation function</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-procedures.html"><a href="estimation-procedures.html#checking-via-simulation"><i class="fa fa-check"></i><b>6.2</b> Checking via simulation</a></li>
<li class="chapter" data-level="6.3" data-path="estimation-procedures.html"><a href="estimation-procedures.html#multiple-estimation-procedures"><i class="fa fa-check"></i><b>6.3</b> Multiple estimation procedures</a></li>
<li class="chapter" data-level="6.4" data-path="estimation-procedures.html"><a href="estimation-procedures.html#exercises-1"><i class="fa fa-check"></i><b>6.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="estimation-procedures.html"><a href="estimation-procedures.html#more-welch-and-adding-the-bff-test"><i class="fa fa-check"></i><b>6.4.1</b> More Welch and adding the BFF test</a></li>
<li class="chapter" data-level="6.4.2" data-path="estimation-procedures.html"><a href="estimation-procedures.html#more-estimators-for-the-crt"><i class="fa fa-check"></i><b>6.4.2</b> More estimators for the CRT</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="performance-criteria.html"><a href="performance-criteria.html"><i class="fa fa-check"></i><b>7</b> Performance criteria</a>
<ul>
<li class="chapter" data-level="7.1" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-vs.-estimation"><i class="fa fa-check"></i><b>7.1</b> Inference vs. Estimation</a></li>
<li class="chapter" data-level="7.2" data-path="performance-criteria.html"><a href="performance-criteria.html#comparing-estimators"><i class="fa fa-check"></i><b>7.2</b> Comparing estimators</a></li>
<li class="chapter" data-level="7.3" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-point-estimator"><i class="fa fa-check"></i><b>7.3</b> Assessing a point estimator</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="performance-criteria.html"><a href="performance-criteria.html#example-on-our-cluster-rct"><i class="fa fa-check"></i><b>7.3.1</b> Example on our Cluster RCT</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-standard-error-estimator"><i class="fa fa-check"></i><b>7.4</b> Assessing a standard error estimator</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="performance-criteria.html"><a href="performance-criteria.html#why-not-assess-the-estimate-se-directly"><i class="fa fa-check"></i><b>7.4.1</b> Why not assess the estimate SE directly?</a></li>
<li class="chapter" data-level="7.4.2" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-ses-for-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>7.4.2</b> Assessing SEs for our Cluster RCT simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-an-inferential-procedure"><i class="fa fa-check"></i><b>7.5</b> Assessing an inferential procedure</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="performance-criteria.html"><a href="performance-criteria.html#validity"><i class="fa fa-check"></i><b>7.5.1</b> Validity</a></li>
<li class="chapter" data-level="7.5.2" data-path="performance-criteria.html"><a href="performance-criteria.html#power"><i class="fa fa-check"></i><b>7.5.2</b> Power</a></li>
<li class="chapter" data-level="7.5.3" data-path="performance-criteria.html"><a href="performance-criteria.html#the-rejection-rate"><i class="fa fa-check"></i><b>7.5.3</b> The Rejection Rate</a></li>
<li class="chapter" data-level="7.5.4" data-path="performance-criteria.html"><a href="performance-criteria.html#our-cluster-rct-simulation"><i class="fa fa-check"></i><b>7.5.4</b> Our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-confidence-intervals"><i class="fa fa-check"></i><b>7.6</b> Assessing confidence intervals</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="performance-criteria.html"><a href="performance-criteria.html#clusters-with-confidence"><i class="fa fa-check"></i><b>7.6.1</b> Clusters with Confidence</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="performance-criteria.html"><a href="performance-criteria.html#further-measures-of-performance"><i class="fa fa-check"></i><b>7.7</b> Further measures of performance</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="performance-criteria.html"><a href="performance-criteria.html#sec_relative_performance"><i class="fa fa-check"></i><b>7.7.1</b> Relative vs. Absolute Criteria</a></li>
<li class="chapter" data-level="7.7.2" data-path="performance-criteria.html"><a href="performance-criteria.html#robust-measures-of-performance"><i class="fa fa-check"></i><b>7.7.2</b> Robust measures of performance</a></li>
<li class="chapter" data-level="7.7.3" data-path="performance-criteria.html"><a href="performance-criteria.html#summary-of-peformance-measures"><i class="fa fa-check"></i><b>7.7.3</b> Summary of peformance measures</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="performance-criteria.html"><a href="performance-criteria.html#uncertainty-in-performance-estimates-the-mcse"><i class="fa fa-check"></i><b>7.8</b> Uncertainty in performance estimates (the MCSE)</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-for-variance-estimators"><i class="fa fa-check"></i><b>7.8.1</b> MCSE for variance estimators</a></li>
<li class="chapter" data-level="7.8.2" data-path="performance-criteria.html"><a href="performance-criteria.html#calculating-mcses-with-the-simhelpers-package"><i class="fa fa-check"></i><b>7.8.2</b> Calculating MCSEs with the simhelpers package</a></li>
<li class="chapter" data-level="7.8.3" data-path="performance-criteria.html"><a href="performance-criteria.html#cluster-rct-continued-do-we-have-enough-simulation-trials"><i class="fa fa-check"></i><b>7.8.3</b> Cluster RCT, continued: Do we have enough simulation trials?</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="performance-criteria.html"><a href="performance-criteria.html#exercises-2"><i class="fa fa-check"></i><b>7.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="case_Cronbach.html"><a href="case_Cronbach.html"><i class="fa fa-check"></i><b>8</b> Project: Cronbach Alpha</a>
<ul>
<li class="chapter" data-level="8.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#background"><i class="fa fa-check"></i><b>8.1</b> Background</a></li>
<li class="chapter" data-level="8.2" data-path="case_Cronbach.html"><a href="case_Cronbach.html#getting-started"><i class="fa fa-check"></i><b>8.2</b> Getting started</a></li>
<li class="chapter" data-level="8.3" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-data-generating-function"><i class="fa fa-check"></i><b>8.3</b> The data-generating function</a></li>
<li class="chapter" data-level="8.4" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-estimation-function"><i class="fa fa-check"></i><b>8.4</b> The estimation function</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercices-naive-confidence-intervals"><i class="fa fa-check"></i><b>8.4.1</b> Exercices (Naive confidence intervals)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="case_Cronbach.html"><a href="case_Cronbach.html#estimator-performance"><i class="fa fa-check"></i><b>8.5</b> Estimator performance</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-calculating-performance"><i class="fa fa-check"></i><b>8.5.1</b> Exercises (Calculating Performance)</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="case_Cronbach.html"><a href="case_Cronbach.html#replication-and-the-simulation"><i class="fa fa-check"></i><b>8.6</b> Replication (and the simulation)</a></li>
<li class="chapter" data-level="8.7" data-path="case_Cronbach.html"><a href="case_Cronbach.html#extension-confidence-interval-coverage"><i class="fa fa-check"></i><b>8.7</b> Extension: Confidence interval coverage</a></li>
<li class="chapter" data-level="8.8" data-path="case_Cronbach.html"><a href="case_Cronbach.html#a-taste-of-multiple-scenarios"><i class="fa fa-check"></i><b>8.8</b> A taste of multiple scenarios</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-3"><i class="fa fa-check"></i><b>8.8.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exp_design.html"><a href="exp_design.html"><i class="fa fa-check"></i><b>9</b> Designing the multifactor simulation experiment</a>
<ul>
<li class="chapter" data-level="9.1" data-path="exp_design.html"><a href="exp_design.html#choosing-parameter-combinations"><i class="fa fa-check"></i><b>9.1</b> Choosing parameter combinations</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="exp_design.html"><a href="exp_design.html#choosing-parameters-for-the-clustered-rct"><i class="fa fa-check"></i><b>9.1.1</b> Choosing parameters for the Clustered RCT</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="exp_design.html"><a href="exp_design.html#using-pmap-to-run-multifactor-simulations"><i class="fa fa-check"></i><b>9.2</b> Using pmap to run multifactor simulations</a></li>
<li class="chapter" data-level="9.3" data-path="exp_design.html"><a href="exp_design.html#ways-of-repeating-oneself"><i class="fa fa-check"></i><b>9.3</b> Ways of repeating oneself</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="exp_design.html"><a href="exp_design.html#getting-raw-results-ready-for-analysis"><i class="fa fa-check"></i><b>9.3.1</b> Getting raw results ready for analysis</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="exp_design.html"><a href="exp_design.html#running-the-cluster-rct-multifactor-experiment"><i class="fa fa-check"></i><b>9.4</b> Running the Cluster RCT multifactor experiment</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="exp_design.html"><a href="exp_design.html#making-analyze_data-quiet"><i class="fa fa-check"></i><b>9.4.1</b> Making analyze_data() quiet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html"><i class="fa fa-check"></i><b>10</b> Analyzing the multifactor experiment</a>
<ul>
<li class="chapter" data-level="10.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#bundling"><i class="fa fa-check"></i><b>10.1</b> Bundling</a></li>
<li class="chapter" data-level="10.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#aggregation"><i class="fa fa-check"></i><b>10.2</b> Aggregation</a></li>
<li class="chapter" data-level="10.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#regression-summarization"><i class="fa fa-check"></i><b>10.3</b> Regression Summarization</a></li>
<li class="chapter" data-level="10.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focus-on-subset-kick-rest-to-supplement"><i class="fa fa-check"></i><b>10.4</b> Focus on subset, kick rest to supplement</a></li>
<li class="chapter" data-level="10.5" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#analyzing-results-when-some-trials-have-failed"><i class="fa fa-check"></i><b>10.5</b> Analyzing results when some trials have failed</a></li>
<li class="chapter" data-level="10.6" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#a-demonstration-of-visualization"><i class="fa fa-check"></i><b>10.6</b> A demonstration of visualization</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#the-initial-analysis"><i class="fa fa-check"></i><b>10.6.1</b> The initial analysis</a></li>
<li class="chapter" data-level="10.6.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focusing-on-validity"><i class="fa fa-check"></i><b>10.6.2</b> Focusing on validity</a></li>
<li class="chapter" data-level="10.6.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#looking-at-main-effects"><i class="fa fa-check"></i><b>10.6.3</b> Looking at main effects</a></li>
<li class="chapter" data-level="10.6.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#recap"><i class="fa fa-check"></i><b>10.6.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#exercises-4"><i class="fa fa-check"></i><b>10.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html"><i class="fa fa-check"></i><b>11</b> Case study: Comparing different estimators</a>
<ul>
<li class="chapter" data-level="11.1" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-generating-process"><i class="fa fa-check"></i><b>11.1</b> The data generating process</a></li>
<li class="chapter" data-level="11.2" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-analysis-methods"><i class="fa fa-check"></i><b>11.2</b> The data analysis methods</a></li>
<li class="chapter" data-level="11.3" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-simulation-itself"><i class="fa fa-check"></i><b>11.3</b> The simulation itself</a></li>
<li class="chapter" data-level="11.4" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#calculating-performance-measures-for-all-our-estimators"><i class="fa fa-check"></i><b>11.4</b> Calculating performance measures for all our estimators</a></li>
<li class="chapter" data-level="11.5" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#improving-the-visualization-of-the-results"><i class="fa fa-check"></i><b>11.5</b> Improving the visualization of the results</a></li>
<li class="chapter" data-level="11.6" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#extension-the-bias-variance-tradeoff"><i class="fa fa-check"></i><b>11.6</b> Extension: The Bias-variance tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html"><i class="fa fa-check"></i><b>12</b> Presentation of simulation results</a>
<ul>
<li class="chapter" data-level="12.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#tabulation"><i class="fa fa-check"></i><b>12.1</b> Tabulation</a></li>
<li class="chapter" data-level="12.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#visualization"><i class="fa fa-check"></i><b>12.2</b> Visualization</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-1-biserial-correlation-estimation"><i class="fa fa-check"></i><b>12.2.1</b> Example 1: Biserial correlation estimation</a></li>
<li class="chapter" data-level="12.2.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-2-variance-estimation-and-meta-regression"><i class="fa fa-check"></i><b>12.2.2</b> Example 2: Variance estimation and Meta-regression</a></li>
<li class="chapter" data-level="12.2.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-heat-maps-of-coverage"><i class="fa fa-check"></i><b>12.2.3</b> Example: Heat maps of coverage</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#modeling"><i class="fa fa-check"></i><b>12.3</b> Modeling</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="sec_reproducability.html"><a href="sec_reproducability.html"><i class="fa fa-check"></i><b>13</b> Ensuring reproducibility</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sec_reproducability.html"><a href="sec_reproducability.html#seeds-and-pseudo-random-number-generators"><i class="fa fa-check"></i><b>13.1</b> Seeds and pseudo-random number generators</a></li>
<li class="chapter" data-level="13.2" data-path="sec_reproducability.html"><a href="sec_reproducability.html#including-seed-in-our-simulation-driver"><i class="fa fa-check"></i><b>13.2</b> Including seed in our simulation driver</a></li>
<li class="chapter" data-level="13.3" data-path="sec_reproducability.html"><a href="sec_reproducability.html#reasons-for-setting-the-seed"><i class="fa fa-check"></i><b>13.3</b> Reasons for setting the seed</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="optimize_code.html"><a href="optimize_code.html"><i class="fa fa-check"></i><b>14</b> Optimizing code (and why you often shouldn’t)</a>
<ul>
<li class="chapter" data-level="14.1" data-path="optimize_code.html"><a href="optimize_code.html#hand-building-functions"><i class="fa fa-check"></i><b>14.1</b> Hand-building functions</a></li>
<li class="chapter" data-level="14.2" data-path="optimize_code.html"><a href="optimize_code.html#sec_comp_efficiency"><i class="fa fa-check"></i><b>14.2</b> Computational efficiency versus simplicity</a></li>
<li class="chapter" data-level="14.3" data-path="optimize_code.html"><a href="optimize_code.html#reusing-code-to-speed-up-computation"><i class="fa fa-check"></i><b>14.3</b> Reusing code to speed up computation</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html"><i class="fa fa-check"></i><b>15</b> Error trapping and other headaches</a>
<ul>
<li class="chapter" data-level="15.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#safe_code"><i class="fa fa-check"></i><b>15.1</b> Safe code</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#making-a-safe-function-call"><i class="fa fa-check"></i><b>15.1.1</b> Making a safe function call</a></li>
<li class="chapter" data-level="15.1.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#what-to-do-with-warnings-in-simulations"><i class="fa fa-check"></i><b>15.1.2</b> What to do with warnings in simulations</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#about_stopifnot"><i class="fa fa-check"></i><b>15.2</b> Protecting your functions with “stop”</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="saving_files.html"><a href="saving_files.html"><i class="fa fa-check"></i><b>16</b> Saving files and results</a>
<ul>
<li class="chapter" data-level="16.1" data-path="saving_files.html"><a href="saving_files.html#saving-simulations-in-general"><i class="fa fa-check"></i><b>16.1</b> Saving simulations in general</a></li>
<li class="chapter" data-level="16.2" data-path="saving_files.html"><a href="saving_files.html#saving-simulations-as-you-go"><i class="fa fa-check"></i><b>16.2</b> Saving simulations as you go</a></li>
<li class="chapter" data-level="16.3" data-path="saving_files.html"><a href="saving_files.html#dynamically-making-directories"><i class="fa fa-check"></i><b>16.3</b> Dynamically making directories</a></li>
<li class="chapter" data-level="16.4" data-path="saving_files.html"><a href="saving_files.html#loading-and-combining-files-of-simulation-results"><i class="fa fa-check"></i><b>16.4</b> Loading and combining files of simulation results</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="on_functions.html"><a href="on_functions.html"><i class="fa fa-check"></i><b>17</b> Coding tidbits</a>
<ul>
<li class="chapter" data-level="17.1" data-path="on_functions.html"><a href="on_functions.html#repeating_oneself"><i class="fa fa-check"></i><b>17.1</b> Ways of repeating yourself</a></li>
<li class="chapter" data-level="17.2" data-path="on_functions.html"><a href="on_functions.html#default_arguments"><i class="fa fa-check"></i><b>17.2</b> Default arguments for functions</a></li>
<li class="chapter" data-level="17.3" data-path="on_functions.html"><a href="on_functions.html#testing-and-debugging-code-in-your-scripts"><i class="fa fa-check"></i><b>17.3</b> Testing and debugging code in your scripts</a></li>
<li class="chapter" data-level="17.4" data-path="on_functions.html"><a href="on_functions.html#keep-multiple-files-of-code"><i class="fa fa-check"></i><b>17.4</b> Keep multiple files of code</a></li>
<li class="chapter" data-level="17.5" data-path="on_functions.html"><a href="on_functions.html#the-source-command-and-keeping-things-organized"><i class="fa fa-check"></i><b>17.5</b> The source command and keeping things organized</a></li>
<li class="chapter" data-level="17.6" data-path="on_functions.html"><a href="on_functions.html#debugging-with-browser"><i class="fa fa-check"></i><b>17.6</b> Debugging with browser</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="parallel-processing.html"><a href="parallel-processing.html"><i class="fa fa-check"></i><b>18</b> Parallel Processing</a>
<ul>
<li class="chapter" data-level="18.1" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-on-your-computer"><i class="fa fa-check"></i><b>18.1</b> Parallel on your computer</a></li>
<li class="chapter" data-level="18.2" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-off-your-computer"><i class="fa fa-check"></i><b>18.2</b> Parallel off your computer</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="parallel-processing.html"><a href="parallel-processing.html#what-is-a-command-line-interface"><i class="fa fa-check"></i><b>18.2.1</b> What is a command-line interface?</a></li>
<li class="chapter" data-level="18.2.2" data-path="parallel-processing.html"><a href="parallel-processing.html#running-a-job-on-a-cluster"><i class="fa fa-check"></i><b>18.2.2</b> Running a job on a cluster</a></li>
<li class="chapter" data-level="18.2.3" data-path="parallel-processing.html"><a href="parallel-processing.html#checking-on-a-job"><i class="fa fa-check"></i><b>18.2.3</b> Checking on a job</a></li>
<li class="chapter" data-level="18.2.4" data-path="parallel-processing.html"><a href="parallel-processing.html#running-lots-of-jobs-on-a-cluster"><i class="fa fa-check"></i><b>18.2.4</b> Running lots of jobs on a cluster</a></li>
<li class="chapter" data-level="18.2.5" data-path="parallel-processing.html"><a href="parallel-processing.html#resources-for-harvards-odyssey"><i class="fa fa-check"></i><b>18.2.5</b> Resources for Harvard’s Odyssey</a></li>
<li class="chapter" data-level="18.2.6" data-path="parallel-processing.html"><a href="parallel-processing.html#acknowledgements-1"><i class="fa fa-check"></i><b>18.2.6</b> Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html"><i class="fa fa-check"></i><b>19</b> Using simulation as a power calculator</a>
<ul>
<li class="chapter" data-level="19.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#getting-design-parameters-from-pilot-data"><i class="fa fa-check"></i><b>19.1</b> Getting design parameters from pilot data</a></li>
<li class="chapter" data-level="19.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#the-data-generating-process-1"><i class="fa fa-check"></i><b>19.2</b> The data generating process</a></li>
<li class="chapter" data-level="19.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#running-the-simulation-1"><i class="fa fa-check"></i><b>19.3</b> Running the simulation</a></li>
<li class="chapter" data-level="19.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#evaluating-power"><i class="fa fa-check"></i><b>19.4</b> Evaluating power</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#checking-validity-of-our-models"><i class="fa fa-check"></i><b>19.4.1</b> Checking validity of our models</a></li>
<li class="chapter" data-level="19.4.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-precision-se"><i class="fa fa-check"></i><b>19.4.2</b> Assessing Precision (SE)</a></li>
<li class="chapter" data-level="19.4.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-power"><i class="fa fa-check"></i><b>19.4.3</b> Assessing power</a></li>
<li class="chapter" data-level="19.4.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-minimum-detectable-effects"><i class="fa fa-check"></i><b>19.4.4</b> Assessing Minimum Detectable Effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html"><i class="fa fa-check"></i><b>20</b> Simulation under the Potential Outcomes Framework</a>
<ul>
<li class="chapter" data-level="20.1" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#finite-vs.-superpopulation-inference"><i class="fa fa-check"></i><b>20.1</b> Finite vs. Superpopulation inference</a></li>
<li class="chapter" data-level="20.2" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#data-generation-processes-for-potential-outcomes"><i class="fa fa-check"></i><b>20.2</b> Data generation processes for potential outcomes</a></li>
<li class="chapter" data-level="20.3" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#finite-sample-performance-measures"><i class="fa fa-check"></i><b>20.3</b> Finite sample performance measures</a></li>
<li class="chapter" data-level="20.4" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#nested-finite-simulation-procedure"><i class="fa fa-check"></i><b>20.4</b> Nested finite simulation procedure</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html"><i class="fa fa-check"></i><b>21</b> Simulations as evidence</a>
<ul>
<li class="chapter" data-level="21.1" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#use-extensive-multi-factor-simulations"><i class="fa fa-check"></i><b>21.1</b> Use extensive multi-factor simulations</a></li>
<li class="chapter" data-level="21.2" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#beat-them-at-their-own-game"><i class="fa fa-check"></i><b>21.2</b> Beat them at their own game</a></li>
<li class="chapter" data-level="21.3" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#calibrated-simulations"><i class="fa fa-check"></i><b>21.3</b> Calibrated simulations</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>22</b> The Parametric bootstrap</a>
<ul>
<li class="chapter" data-level="22.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#air-conditioners-a-stolen-case-study"><i class="fa fa-check"></i><b>22.1</b> Air conditioners: a stolen case study</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="further-readings-and-resources.html"><a href="further-readings-and-resources.html"><i class="fa fa-check"></i><b>23</b> Further readings and resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Designing Monte Carlo Simulations in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-parametric-bootstrap" class="section level1 hasAnchor" number="22">
<h1><span class="header-section-number">Chapter 22</span> The Parametric bootstrap<a href="the-parametric-bootstrap.html#the-parametric-bootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>An inference procedure very much connected to simulation studies is the parametric bootstrap.
The parametric bootstrap is a bootstrap technique designed to obtain standard error estimates for an estimated parametric model.
It can do better than the case-wise bootstrap in some circumstances, usually when there is need to avoid the discrete, chunky nature of a casewise bootstrap (which will only give values that exist in the original dataset).</p>
<p>For a parametric bootstrap, the core idea is to fit a given model to actual data, and then take the parameters we estimate from that model as the DGP parameters in a simulation study.
The parametric bootstrap is a simulation study for a specific scenario, and our goal is to assess how variable (and, possibly, biased) our estimator is for this specific scenario.
If the behavior of our estimator in our simulated scenario is similar to what it would be under repeated trials in the real world, then our bootstrap answers will be informative as to how well our original estimator performs in practice.
This is the bootstrap principle, or analogy with an additional assumption that the real-world is effectively well specified as the parameteric model we are fitting.</p>
<p>In particular we do the following:</p>
<ol style="list-style-type: decimal">
<li>generate data from a model with coefficients as estimated on the original data.</li>
<li>repeatedly estimate our target quantity on a series of synthetic data sets, all generated from this model.</li>
<li>examine this collection of estimates to assess the character of the estimates themselves, i.e. how much they vary, whether we are systematically estimating too high or too low, and so forth.</li>
<li>The variance and bias of our estimates in our simulation is probably like the actual variance and bias of our original estimate (this is precisely the bootstrap analogy).</li>
</ol>
<p>A key feature of the parametric bootstrap is it is not, generally, a multifactor simulation experiment.
We fit our model to the data, and use our best estimate of the world, as given by the fit model, to generate our data.
This means we generally want to simulate in contexts that are (mostly) <em>pivotal</em>, meaning the distribution of our test statistic or point estimate is relatively stable across different scenarios.
In other words, we want the uncertainty of our estimator to not heavily depend on the exact parameter values we use in our simulation, so that if we are simulating with incorrect parameters our bootstrap analogy will still hold.</p>
<p>Often, to achieve a reasonable claim of being pivotal, we will focus on standardized statistics, such as the <span class="math inline">\(t\)</span>-statistic of</p>
<p><span class="math display">\[ t = \frac{est}{\widehat{SE}} \]</span>
It is more common for the distribution of a standardized test statistic to have a canonical distribution across scenarios than an absolute estimate.</p>
<div id="air-conditioners-a-stolen-case-study" class="section level2 hasAnchor" number="22.1">
<h2><span class="header-section-number">22.1</span> Air conditioners: a stolen case study<a href="the-parametric-bootstrap.html#air-conditioners-a-stolen-case-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Following the case study presented in [CITE bootstrap book], consider some failure times of air conditioning units:</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="the-parametric-bootstrap.html#cb527-1" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">c</span>( <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span> )</span></code></pre></div>
<p>We are interested in the log of the average failure time:</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="the-parametric-bootstrap.html#cb528-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(dat)</span>
<span id="cb528-2"><a href="the-parametric-bootstrap.html#cb528-2" tabindex="-1"></a>y.bar <span class="ot">=</span> <span class="fu">mean</span>(dat)</span>
<span id="cb528-3"><a href="the-parametric-bootstrap.html#cb528-3" tabindex="-1"></a>theta.hat <span class="ot">=</span> <span class="fu">log</span>( y.bar )</span>
<span id="cb528-4"><a href="the-parametric-bootstrap.html#cb528-4" tabindex="-1"></a></span>
<span id="cb528-5"><a href="the-parametric-bootstrap.html#cb528-5" tabindex="-1"></a><span class="fu">c</span>( <span class="at">n =</span> n, <span class="at">y.bar =</span> y.bar, <span class="at">theta.hat =</span> theta.hat )</span></code></pre></div>
<pre><code>##          n      y.bar  theta.hat 
##  12.000000 108.083333   4.682903</code></pre>
<p>We are interested in this because we are modeling the failure time of the air conditioners with an exponential distribution.
This means we will generate new failure times with an exponential distribution:</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="the-parametric-bootstrap.html#cb530-1" tabindex="-1"></a>reps <span class="ot">=</span> <span class="fu">replicate</span>( <span class="dv">10000</span>, {</span>
<span id="cb530-2"><a href="the-parametric-bootstrap.html#cb530-2" tabindex="-1"></a>    smp <span class="ot">=</span> <span class="fu">rexp</span>(n, <span class="dv">1</span><span class="sc">/</span>y.bar)</span>
<span id="cb530-3"><a href="the-parametric-bootstrap.html#cb530-3" tabindex="-1"></a>    <span class="fu">log</span>( <span class="fu">mean</span>( smp ) )</span>
<span id="cb530-4"><a href="the-parametric-bootstrap.html#cb530-4" tabindex="-1"></a>})</span>
<span id="cb530-5"><a href="the-parametric-bootstrap.html#cb530-5" tabindex="-1"></a></span>
<span id="cb530-6"><a href="the-parametric-bootstrap.html#cb530-6" tabindex="-1"></a>res_par <span class="ot">=</span> <span class="fu">tibble</span>( </span>
<span id="cb530-7"><a href="the-parametric-bootstrap.html#cb530-7" tabindex="-1"></a>  <span class="at">bias.hat =</span> <span class="fu">mean</span>( reps ) <span class="sc">-</span> theta.hat,</span>
<span id="cb530-8"><a href="the-parametric-bootstrap.html#cb530-8" tabindex="-1"></a>  <span class="at">var.hat =</span> <span class="fu">var</span>( reps ),</span>
<span id="cb530-9"><a href="the-parametric-bootstrap.html#cb530-9" tabindex="-1"></a>  <span class="at">CIlog_low =</span> theta.hat <span class="sc">+</span> bias.hat <span class="sc">-</span> <span class="fu">sqrt</span>(var.hat) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>),</span>
<span id="cb530-10"><a href="the-parametric-bootstrap.html#cb530-10" tabindex="-1"></a>  <span class="at">CIlog_high =</span> theta.hat <span class="sc">+</span> bias.hat <span class="sc">-</span> <span class="fu">sqrt</span>(var.hat) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>),</span>
<span id="cb530-11"><a href="the-parametric-bootstrap.html#cb530-11" tabindex="-1"></a>  <span class="at">CI_low =</span> <span class="fu">exp</span>( CIlog_low ),</span>
<span id="cb530-12"><a href="the-parametric-bootstrap.html#cb530-12" tabindex="-1"></a>  <span class="at">CI_high =</span> <span class="fu">exp</span>( CIlog_high ) )</span>
<span id="cb530-13"><a href="the-parametric-bootstrap.html#cb530-13" tabindex="-1"></a>res_par</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   bias.hat var.hat CIlog_low CIlog_high CI_low
##      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
## 1  -0.0420  0.0856      4.07       5.21   58.4
## # ℹ 1 more variable: CI_high &lt;dbl&gt;</code></pre>
<p>Note how we are, as usual, in our standard simulation framework of repeatidly (1) generating data and (2) analyzing the simulated data.
Nothing is changed.</p>
<p>The nonparametric, or case-wise, bootstrap (this is what people normally mean when they say bootstrap) would look like this:</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="the-parametric-bootstrap.html#cb532-1" tabindex="-1"></a>reps <span class="ot">=</span> <span class="fu">replicate</span>( <span class="dv">10000</span>, {</span>
<span id="cb532-2"><a href="the-parametric-bootstrap.html#cb532-2" tabindex="-1"></a>    smp <span class="ot">=</span> <span class="fu">sample</span>( dat, <span class="at">replace=</span><span class="cn">TRUE</span> )</span>
<span id="cb532-3"><a href="the-parametric-bootstrap.html#cb532-3" tabindex="-1"></a>    <span class="fu">log</span>( <span class="fu">mean</span>( smp ) )</span>
<span id="cb532-4"><a href="the-parametric-bootstrap.html#cb532-4" tabindex="-1"></a>})</span>
<span id="cb532-5"><a href="the-parametric-bootstrap.html#cb532-5" tabindex="-1"></a></span>
<span id="cb532-6"><a href="the-parametric-bootstrap.html#cb532-6" tabindex="-1"></a>res_np <span class="ot">=</span> <span class="fu">tibble</span>( </span>
<span id="cb532-7"><a href="the-parametric-bootstrap.html#cb532-7" tabindex="-1"></a>  <span class="at">bias.hat =</span> <span class="fu">mean</span>( reps ) <span class="sc">-</span> theta.hat,</span>
<span id="cb532-8"><a href="the-parametric-bootstrap.html#cb532-8" tabindex="-1"></a>  <span class="at">var.hat =</span> <span class="fu">var</span>( reps ),</span>
<span id="cb532-9"><a href="the-parametric-bootstrap.html#cb532-9" tabindex="-1"></a>  <span class="at">CIlog_low =</span> theta.hat <span class="sc">+</span> bias.hat <span class="sc">-</span> <span class="fu">sqrt</span>(var.hat) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>),</span>
<span id="cb532-10"><a href="the-parametric-bootstrap.html#cb532-10" tabindex="-1"></a>  <span class="at">CIlog_high =</span> theta.hat <span class="sc">+</span> bias.hat <span class="sc">-</span> <span class="fu">sqrt</span>(var.hat) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>),</span>
<span id="cb532-11"><a href="the-parametric-bootstrap.html#cb532-11" tabindex="-1"></a>  <span class="at">CI_low =</span> <span class="fu">exp</span>( CIlog_low ),</span>
<span id="cb532-12"><a href="the-parametric-bootstrap.html#cb532-12" tabindex="-1"></a>  <span class="at">CI_high =</span> <span class="fu">exp</span>( CIlog_high ) )</span>
<span id="cb532-13"><a href="the-parametric-bootstrap.html#cb532-13" tabindex="-1"></a></span>
<span id="cb532-14"><a href="the-parametric-bootstrap.html#cb532-14" tabindex="-1"></a></span>
<span id="cb532-15"><a href="the-parametric-bootstrap.html#cb532-15" tabindex="-1"></a><span class="fu">bind_rows</span>( <span class="at">parametric =</span> res_par, </span>
<span id="cb532-16"><a href="the-parametric-bootstrap.html#cb532-16" tabindex="-1"></a>           <span class="at">casewise =</span> res_np, <span class="at">.id =</span> <span class="st">&quot;method&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb532-17"><a href="the-parametric-bootstrap.html#cb532-17" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">length =</span> CI_high <span class="sc">-</span> CI_low )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 8
##   method     bias.hat var.hat CIlog_low CIlog_high
##   &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1 parametric  -0.0420  0.0856      4.07       5.21
## 2 casewise    -0.0651  0.132       3.90       5.33
## # ℹ 3 more variables: CI_low &lt;dbl&gt;,
## #   CI_high &lt;dbl&gt;, length &lt;dbl&gt;</code></pre>
<p>This is <em>also</em> a simulation: our data generating process is a bit more vague, however, as we are just resampling the data.
This means our estimands are not as clearly specified.
For example, in our parameteric approach, our target parameter is known to be true.
In the case-wise, the connection between our DGP and the parameter <code>theta.hat</code> is less explicit.</p>
<p>Overall, in this case, our parametric bootstrap can model the tail behavior of an exponential better than case-wise.
Especially considering the small number of observations, it is going to be a more faithful representation of what we are doing–provided our model is well specified for the real world distribution.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulations-as-evidence.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="further-readings-and-resources.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jepusto/Designing-Simulations-in-R/edit/master/150-parametric-bootstrap.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Designing-Simulations-in-R.pdf", "Designing-Simulations-in-R.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
