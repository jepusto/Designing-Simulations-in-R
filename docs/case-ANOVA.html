<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Case Study: Heteroskedastic ANOVA | Designing Monte Carlo Simulations in R</title>
  <meta name="description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Case Study: Heteroskedastic ANOVA | Designing Monte Carlo Simulations in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="github-repo" content="jepusto/Designing-Simulations-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Case Study: Heteroskedastic ANOVA | Designing Monte Carlo Simulations in R" />
  
  <meta name="twitter:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  

<meta name="author" content="Luke W. Miratrix and James E. Pustejovsky (Equal authors)" />


<meta name="date" content="2024-06-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="structure-of-a-simulation-study.html"/>
<link rel="next" href="chap-DGP.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Designing Simulations in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#some-of-simulations-many-uses"><i class="fa fa-check"></i><b>1.1</b> Some of simulation’s many uses</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#comparing-statistical-approaches"><i class="fa fa-check"></i><b>1.1.1</b> Comparing statistical approaches</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#assessing-performance-of-complex-pipelines"><i class="fa fa-check"></i><b>1.1.2</b> Assessing performance of complex pipelines</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#assessing-performance-under-misspecification"><i class="fa fa-check"></i><b>1.1.3</b> Assessing performance under misspecification</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#assessing-the-finite-sample-performance-of-a-statistical-approach"><i class="fa fa-check"></i><b>1.1.4</b> Assessing the finite sample performance of a statistical approach</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#conducting-power-analyses"><i class="fa fa-check"></i><b>1.1.5</b> Conducting Power Analyses</a></li>
<li class="chapter" data-level="1.1.6" data-path="introduction.html"><a href="introduction.html#simulating-processess"><i class="fa fa-check"></i><b>1.1.6</b> Simulating processess</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-perils-of-simulation-as-evidence"><i class="fa fa-check"></i><b>1.2</b> The perils of simulation as evidence</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#why-r-and-rstudio"><i class="fa fa-check"></i><b>1.3</b> Why R and RStudio?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#templates-vs.-patterns"><i class="fa fa-check"></i><b>1.3.1</b> Templates vs. Patterns</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#the-tidyverse-and-a-recommended-text"><i class="fa fa-check"></i><b>1.3.2</b> The tidyverse and a recommended text</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#functions"><i class="fa fa-check"></i><b>1.3.3</b> Functions</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#a-dangerous-function"><i class="fa fa-check"></i><b>1.3.4</b> A dangerous function</a></li>
<li class="chapter" data-level="1.3.5" data-path="introduction.html"><a href="introduction.html#function-skeletons"><i class="fa fa-check"></i><b>1.3.5</b> Function skeletons</a></li>
<li class="chapter" data-level="1.3.6" data-path="introduction.html"><a href="introduction.html#pipe-dreams"><i class="fa fa-check"></i><b>1.3.6</b> <code>%&gt;%</code> (Pipe) dreams</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html"><i class="fa fa-check"></i><b>2</b> An initial simulation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulation-for-a-single-scenario"><i class="fa fa-check"></i><b>2.1</b> Simulation for a single scenario</a></li>
<li class="chapter" data-level="2.2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulating-across-different-scenarios"><i class="fa fa-check"></i><b>2.2</b> Simulating across different scenarios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html"><i class="fa fa-check"></i><b>3</b> Structure of a simulation study</a>
<ul>
<li class="chapter" data-level="3.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#general-structure-of-a-simulation"><i class="fa fa-check"></i><b>3.1</b> General structure of a simulation</a></li>
<li class="chapter" data-level="3.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#tidy-simulations"><i class="fa fa-check"></i><b>3.2</b> Tidy simulations</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#the-data-generating-process-dgp"><i class="fa fa-check"></i><b>3.2.1</b> The Data Generating Process (DGP)</a></li>
<li class="chapter" data-level="3.2.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#estimation-procedures"><i class="fa fa-check"></i><b>3.2.2</b> Estimation procedures</a></li>
<li class="chapter" data-level="3.2.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#repetition"><i class="fa fa-check"></i><b>3.2.3</b> Repetition</a></li>
<li class="chapter" data-level="3.2.4" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#performance-summaries"><i class="fa fa-check"></i><b>3.2.4</b> Performance summaries</a></li>
<li class="chapter" data-level="3.2.5" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#why-the-tidy-approach"><i class="fa fa-check"></i><b>3.2.5</b> Why the tidy approach?</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#multiple-scenarios"><i class="fa fa-check"></i><b>3.3</b> Multiple Scenarios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="case-ANOVA.html"><a href="case-ANOVA.html"><i class="fa fa-check"></i><b>4</b> Case Study: Heteroskedastic ANOVA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#the-data-generating-model"><i class="fa fa-check"></i><b>4.1</b> The data-generating model</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#coding-remark"><i class="fa fa-check"></i><b>4.1.1</b> Coding remark</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="case-ANOVA.html"><a href="case-ANOVA.html#the-estimation-procedures"><i class="fa fa-check"></i><b>4.2</b> The estimation procedures</a></li>
<li class="chapter" data-level="4.3" data-path="case-ANOVA.html"><a href="case-ANOVA.html#running-the-simulation"><i class="fa fa-check"></i><b>4.3</b> Running the simulation</a></li>
<li class="chapter" data-level="4.4" data-path="case-ANOVA.html"><a href="case-ANOVA.html#analyzing-the-simulation"><i class="fa fa-check"></i><b>4.4</b> Analyzing the Simulation</a></li>
<li class="chapter" data-level="4.5" data-path="case-ANOVA.html"><a href="case-ANOVA.html#exAnovaExercises"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-DGP.html"><a href="chap-DGP.html"><i class="fa fa-check"></i><b>5</b> Data-Generating Processes (DGPs)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap-DGP.html"><a href="chap-DGP.html#a-statistical-model-is-a-recipe-for-data-generation"><i class="fa fa-check"></i><b>5.1</b> A statistical model is a recipe for data generation</a></li>
<li class="chapter" data-level="5.2" data-path="chap-DGP.html"><a href="chap-DGP.html#checking-the-data-generating-function"><i class="fa fa-check"></i><b>5.2</b> Checking the data-generating function</a></li>
<li class="chapter" data-level="5.3" data-path="chap-DGP.html"><a href="chap-DGP.html#case-cluster"><i class="fa fa-check"></i><b>5.3</b> Example: Simulating clustered data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chap-DGP.html"><a href="chap-DGP.html#a-design-decision-what-do-we-want-to-manipulate"><i class="fa fa-check"></i><b>5.3.1</b> A design decision: What do we want to manipulate?</a></li>
<li class="chapter" data-level="5.3.2" data-path="chap-DGP.html"><a href="chap-DGP.html#a-model-for-a-cluster-rct"><i class="fa fa-check"></i><b>5.3.2</b> A model for a cluster RCT</a></li>
<li class="chapter" data-level="5.3.3" data-path="chap-DGP.html"><a href="chap-DGP.html#converting-our-model-to-code"><i class="fa fa-check"></i><b>5.3.3</b> Converting our model to code</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap-DGP.html"><a href="chap-DGP.html#exercises"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chap-DGP.html"><a href="chap-DGP.html#ex_dgp"><i class="fa fa-check"></i><b>5.4.1</b> The Welch test on a shifted-and-scaled <span class="math inline">\(t\)</span> distribution</a></li>
<li class="chapter" data-level="5.4.2" data-path="chap-DGP.html"><a href="chap-DGP.html#checking-and-extending-the-cluster-rct-dgp"><i class="fa fa-check"></i><b>5.4.2</b> Checking and extending the Cluster RCT DGP</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="chap-DGP.html"><a href="chap-DGP.html#extension-standardization-in-a-data-generating-process"><i class="fa fa-check"></i><b>5.5</b> Extension: Standardization in a data generating process</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html"><i class="fa fa-check"></i><b>6</b> Estimation procedures</a>
<ul>
<li class="chapter" data-level="6.1" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#validating-estimation-procedures"><i class="fa fa-check"></i><b>6.1</b> Validating Estimation Procedures</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#checking-via-simulation"><i class="fa fa-check"></i><b>6.2</b> Checking via simulation</a></li>
<li class="chapter" data-level="6.3" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#including-multiple-estimation-procedures"><i class="fa fa-check"></i><b>6.3</b> Including Multiple estimation procedures</a></li>
<li class="chapter" data-level="6.4" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#exercises-1"><i class="fa fa-check"></i><b>6.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#more-welch-and-adding-the-bff-test"><i class="fa fa-check"></i><b>6.4.1</b> More Welch and adding the BFF test</a></li>
<li class="chapter" data-level="6.4.2" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#more-estimators-for-cluster-randomized-trials"><i class="fa fa-check"></i><b>6.4.2</b> More estimators for Cluster Randomized Trials</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html"><i class="fa fa-check"></i><b>7</b> Running the Simulation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html#writing-simulations-quick-with-the-simhelpers-package"><i class="fa fa-check"></i><b>7.1</b> Writing simulations quick with the simhelpers package</a></li>
<li class="chapter" data-level="7.2" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html#adding-checks-and-balances"><i class="fa fa-check"></i><b>7.2</b> Adding Checks and Balances</a></li>
<li class="chapter" data-level="7.3" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html#exercises-2"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="performance-criteria.html"><a href="performance-criteria.html"><i class="fa fa-check"></i><b>8</b> Performance criteria</a>
<ul>
<li class="chapter" data-level="8.1" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-vs.-estimation"><i class="fa fa-check"></i><b>8.1</b> Inference vs. Estimation</a></li>
<li class="chapter" data-level="8.2" data-path="performance-criteria.html"><a href="performance-criteria.html#ways-of-assessing-and-comparing-estimation-procedures"><i class="fa fa-check"></i><b>8.2</b> Ways of Assessing and Comparing Estimation Procedures</a></li>
<li class="chapter" data-level="8.3" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-point-estimator"><i class="fa fa-check"></i><b>8.3</b> Assessing a Point Estimator</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="performance-criteria.html"><a href="performance-criteria.html#comparing-the-performances-of-the-cluster-rct-estimation-procedures"><i class="fa fa-check"></i><b>8.3.1</b> Comparing the Performances of the Cluster RCT Estimation Procedures</a></li>
<li class="chapter" data-level="8.3.2" data-path="performance-criteria.html"><a href="performance-criteria.html#handling-estimands-not-represented-by-a-parameter"><i class="fa fa-check"></i><b>8.3.2</b> Handling Estimands Not Represented By a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-standard-error-estimator"><i class="fa fa-check"></i><b>8.4</b> Assessing a Standard Error Estimator</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="performance-criteria.html"><a href="performance-criteria.html#why-not-assess-the-estimated-se-directly"><i class="fa fa-check"></i><b>8.4.1</b> Why Not Assess the Estimated SE directly?</a></li>
<li class="chapter" data-level="8.4.2" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-ses-for-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>8.4.2</b> Assessing SEs for Our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-an-inferential-procedure-hypothesis-testing"><i class="fa fa-check"></i><b>8.5</b> Assessing an Inferential Procedure (Hypothesis Testing)</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="performance-criteria.html"><a href="performance-criteria.html#validity"><i class="fa fa-check"></i><b>8.5.1</b> Validity</a></li>
<li class="chapter" data-level="8.5.2" data-path="performance-criteria.html"><a href="performance-criteria.html#power"><i class="fa fa-check"></i><b>8.5.2</b> Power</a></li>
<li class="chapter" data-level="8.5.3" data-path="performance-criteria.html"><a href="performance-criteria.html#the-rejection-rate"><i class="fa fa-check"></i><b>8.5.3</b> The Rejection Rate</a></li>
<li class="chapter" data-level="8.5.4" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-in-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>8.5.4</b> Inference in our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-confidence-intervals"><i class="fa fa-check"></i><b>8.6</b> Assessing Confidence Intervals</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="performance-criteria.html"><a href="performance-criteria.html#confidence-intervals-in-our-cluster-rct-example"><i class="fa fa-check"></i><b>8.6.1</b> Confidence Intervals in our Cluster RCT Example</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="performance-criteria.html"><a href="performance-criteria.html#additional-thoughts-on-measuring-performance"><i class="fa fa-check"></i><b>8.7</b> Additional Thoughts on Measuring Performance</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="performance-criteria.html"><a href="performance-criteria.html#sec-relative-performance"><i class="fa fa-check"></i><b>8.7.1</b> Selecting Relative vs. Absolute Criteria</a></li>
<li class="chapter" data-level="8.7.2" data-path="performance-criteria.html"><a href="performance-criteria.html#robust-measures-of-performance"><i class="fa fa-check"></i><b>8.7.2</b> Robust Measures of Performance</a></li>
<li class="chapter" data-level="8.7.3" data-path="performance-criteria.html"><a href="performance-criteria.html#summary-of-peformance-measures"><i class="fa fa-check"></i><b>8.7.3</b> Summary of Peformance Measures</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="performance-criteria.html"><a href="performance-criteria.html#uncertainty-in-performance-estimates-the-mcse"><i class="fa fa-check"></i><b>8.8</b> Uncertainty in Performance Estimates (the MCSE)</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-for-relative-variance-estimators"><i class="fa fa-check"></i><b>8.8.1</b> MCSE for Relative Variance Estimators</a></li>
<li class="chapter" data-level="8.8.2" data-path="performance-criteria.html"><a href="performance-criteria.html#calculating-mcses-with-the-simhelpers-package"><i class="fa fa-check"></i><b>8.8.2</b> Calculating MCSEs With the <code>simhelpers</code> Package</a></li>
<li class="chapter" data-level="8.8.3" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-calculation-in-our-cluster-rct-example"><i class="fa fa-check"></i><b>8.8.3</b> MCSE Calculation in our Cluster RCT Example</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="performance-criteria.html"><a href="performance-criteria.html#exercises-3"><i class="fa fa-check"></i><b>8.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="case_Cronbach.html"><a href="case_Cronbach.html"><i class="fa fa-check"></i><b>9</b> Project: Cronbach Alpha</a>
<ul>
<li class="chapter" data-level="9.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#background"><i class="fa fa-check"></i><b>9.1</b> Background</a></li>
<li class="chapter" data-level="9.2" data-path="case_Cronbach.html"><a href="case_Cronbach.html#getting-started"><i class="fa fa-check"></i><b>9.2</b> Getting started</a></li>
<li class="chapter" data-level="9.3" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-data-generating-function"><i class="fa fa-check"></i><b>9.3</b> The data-generating function</a></li>
<li class="chapter" data-level="9.4" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-estimation-function"><i class="fa fa-check"></i><b>9.4</b> The estimation function</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercices-naive-confidence-intervals"><i class="fa fa-check"></i><b>9.4.1</b> Exercices (Naive confidence intervals)</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="case_Cronbach.html"><a href="case_Cronbach.html#estimator-performance"><i class="fa fa-check"></i><b>9.5</b> Estimator performance</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-calculating-performance"><i class="fa fa-check"></i><b>9.5.1</b> Exercises (Calculating Performance)</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="case_Cronbach.html"><a href="case_Cronbach.html#replication-and-the-simulation"><i class="fa fa-check"></i><b>9.6</b> Replication (and the simulation)</a></li>
<li class="chapter" data-level="9.7" data-path="case_Cronbach.html"><a href="case_Cronbach.html#extension-confidence-interval-coverage"><i class="fa fa-check"></i><b>9.7</b> Extension: Confidence interval coverage</a></li>
<li class="chapter" data-level="9.8" data-path="case_Cronbach.html"><a href="case_Cronbach.html#a-taste-of-multiple-scenarios"><i class="fa fa-check"></i><b>9.8</b> A taste of multiple scenarios</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-4"><i class="fa fa-check"></i><b>9.8.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html"><i class="fa fa-check"></i><b>10</b> Case study: Attrition in a simple randomized experiment</a>
<ul>
<li class="chapter" data-level="10.1" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#the-data-generating-process"><i class="fa fa-check"></i><b>10.1</b> The data generating process</a></li>
<li class="chapter" data-level="10.2" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#estimators"><i class="fa fa-check"></i><b>10.2</b> Estimators</a></li>
<li class="chapter" data-level="10.3" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#performance-criteria-1"><i class="fa fa-check"></i><b>10.3</b> Performance criteria</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="exp-design.html"><a href="exp-design.html"><i class="fa fa-check"></i><b>11</b> Designing the multifactor simulation experiment</a>
<ul>
<li class="chapter" data-level="11.1" data-path="exp-design.html"><a href="exp-design.html#choosing-parameter-combinations"><i class="fa fa-check"></i><b>11.1</b> Choosing parameter combinations</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="exp-design.html"><a href="exp-design.html#choosing-parameters-for-the-clustered-rct"><i class="fa fa-check"></i><b>11.1.1</b> Choosing parameters for the Clustered RCT</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="exp-design.html"><a href="exp-design.html#using-pmap-to-run-multifactor-simulations"><i class="fa fa-check"></i><b>11.2</b> Using pmap to run multifactor simulations</a></li>
<li class="chapter" data-level="11.3" data-path="exp-design.html"><a href="exp-design.html#ways-of-repeating-oneself"><i class="fa fa-check"></i><b>11.3</b> Ways of repeating oneself</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="exp-design.html"><a href="exp-design.html#getting-raw-results-ready-for-analysis"><i class="fa fa-check"></i><b>11.3.1</b> Getting raw results ready for analysis</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="exp-design.html"><a href="exp-design.html#running-the-cluster-rct-multifactor-experiment"><i class="fa fa-check"></i><b>11.4</b> Running the Cluster RCT multifactor experiment</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="exp-design.html"><a href="exp-design.html#making-analyze_data-quiet"><i class="fa fa-check"></i><b>11.4.1</b> Making analyze_data() quiet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html"><i class="fa fa-check"></i><b>12</b> Analyzing the multifactor experiment</a>
<ul>
<li class="chapter" data-level="12.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#bundling"><i class="fa fa-check"></i><b>12.1</b> Bundling</a></li>
<li class="chapter" data-level="12.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#aggregation"><i class="fa fa-check"></i><b>12.2</b> Aggregation</a></li>
<li class="chapter" data-level="12.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#regression-summarization"><i class="fa fa-check"></i><b>12.3</b> Regression Summarization</a></li>
<li class="chapter" data-level="12.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focus-on-subset-kick-rest-to-supplement"><i class="fa fa-check"></i><b>12.4</b> Focus on subset, kick rest to supplement</a></li>
<li class="chapter" data-level="12.5" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#analyzing-results-when-some-trials-have-failed"><i class="fa fa-check"></i><b>12.5</b> Analyzing results when some trials have failed</a></li>
<li class="chapter" data-level="12.6" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#a-demonstration-of-visualization"><i class="fa fa-check"></i><b>12.6</b> A demonstration of visualization</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#the-initial-analysis"><i class="fa fa-check"></i><b>12.6.1</b> The initial analysis</a></li>
<li class="chapter" data-level="12.6.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focusing-on-validity"><i class="fa fa-check"></i><b>12.6.2</b> Focusing on validity</a></li>
<li class="chapter" data-level="12.6.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#looking-at-main-effects"><i class="fa fa-check"></i><b>12.6.3</b> Looking at main effects</a></li>
<li class="chapter" data-level="12.6.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#recap"><i class="fa fa-check"></i><b>12.6.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#exercises-5"><i class="fa fa-check"></i><b>12.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html"><i class="fa fa-check"></i><b>13</b> Case study: Comparing different estimators</a>
<ul>
<li class="chapter" data-level="13.1" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-generating-process-1"><i class="fa fa-check"></i><b>13.1</b> The data generating process</a></li>
<li class="chapter" data-level="13.2" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-analysis-methods"><i class="fa fa-check"></i><b>13.2</b> The data analysis methods</a></li>
<li class="chapter" data-level="13.3" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-simulation-itself"><i class="fa fa-check"></i><b>13.3</b> The simulation itself</a></li>
<li class="chapter" data-level="13.4" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#calculating-performance-measures-for-all-our-estimators"><i class="fa fa-check"></i><b>13.4</b> Calculating performance measures for all our estimators</a></li>
<li class="chapter" data-level="13.5" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#improving-the-visualization-of-the-results"><i class="fa fa-check"></i><b>13.5</b> Improving the visualization of the results</a></li>
<li class="chapter" data-level="13.6" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#extension-the-bias-variance-tradeoff"><i class="fa fa-check"></i><b>13.6</b> Extension: The Bias-variance tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html"><i class="fa fa-check"></i><b>14</b> Presentation of simulation results</a>
<ul>
<li class="chapter" data-level="14.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#tabulation"><i class="fa fa-check"></i><b>14.1</b> Tabulation</a></li>
<li class="chapter" data-level="14.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#visualization"><i class="fa fa-check"></i><b>14.2</b> Visualization</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-1-biserial-correlation-estimation"><i class="fa fa-check"></i><b>14.2.1</b> Example 1: Biserial correlation estimation</a></li>
<li class="chapter" data-level="14.2.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-2-variance-estimation-and-meta-regression"><i class="fa fa-check"></i><b>14.2.2</b> Example 2: Variance estimation and Meta-regression</a></li>
<li class="chapter" data-level="14.2.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-heat-maps-of-coverage"><i class="fa fa-check"></i><b>14.2.3</b> Example: Heat maps of coverage</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#modeling"><i class="fa fa-check"></i><b>14.3</b> Modeling</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sec-reproducability.html"><a href="sec-reproducability.html"><i class="fa fa-check"></i><b>15</b> Ensuring reproducibility</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-reproducability.html"><a href="sec-reproducability.html#seeds-and-pseudo-random-number-generators"><i class="fa fa-check"></i><b>15.1</b> Seeds and pseudo-random number generators</a></li>
<li class="chapter" data-level="15.2" data-path="sec-reproducability.html"><a href="sec-reproducability.html#including-seed-in-our-simulation-driver"><i class="fa fa-check"></i><b>15.2</b> Including seed in our simulation driver</a></li>
<li class="chapter" data-level="15.3" data-path="sec-reproducability.html"><a href="sec-reproducability.html#reasons-for-setting-the-seed"><i class="fa fa-check"></i><b>15.3</b> Reasons for setting the seed</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="optimize-code.html"><a href="optimize-code.html"><i class="fa fa-check"></i><b>16</b> Optimizing code (and why you often shouldn’t)</a>
<ul>
<li class="chapter" data-level="16.1" data-path="optimize-code.html"><a href="optimize-code.html#hand-building-functions"><i class="fa fa-check"></i><b>16.1</b> Hand-building functions</a></li>
<li class="chapter" data-level="16.2" data-path="optimize-code.html"><a href="optimize-code.html#sec_comp_efficiency"><i class="fa fa-check"></i><b>16.2</b> Computational efficiency versus simplicity</a></li>
<li class="chapter" data-level="16.3" data-path="optimize-code.html"><a href="optimize-code.html#reusing-code-to-speed-up-computation"><i class="fa fa-check"></i><b>16.3</b> Reusing code to speed up computation</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html"><i class="fa fa-check"></i><b>17</b> Error trapping and other headaches</a>
<ul>
<li class="chapter" data-level="17.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#safe_code"><i class="fa fa-check"></i><b>17.1</b> Safe code</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#making-a-safe-function-call"><i class="fa fa-check"></i><b>17.1.1</b> Making a safe function call</a></li>
<li class="chapter" data-level="17.1.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#what-to-do-with-warnings-in-simulations"><i class="fa fa-check"></i><b>17.1.2</b> What to do with warnings in simulations</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#about-stopifnot"><i class="fa fa-check"></i><b>17.2</b> Protecting your functions with “stop”</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="saving-files.html"><a href="saving-files.html"><i class="fa fa-check"></i><b>18</b> Saving files and results</a>
<ul>
<li class="chapter" data-level="18.1" data-path="saving-files.html"><a href="saving-files.html#saving-simulations-in-general"><i class="fa fa-check"></i><b>18.1</b> Saving simulations in general</a></li>
<li class="chapter" data-level="18.2" data-path="saving-files.html"><a href="saving-files.html#saving-simulations-as-you-go"><i class="fa fa-check"></i><b>18.2</b> Saving simulations as you go</a></li>
<li class="chapter" data-level="18.3" data-path="saving-files.html"><a href="saving-files.html#dynamically-making-directories"><i class="fa fa-check"></i><b>18.3</b> Dynamically making directories</a></li>
<li class="chapter" data-level="18.4" data-path="saving-files.html"><a href="saving-files.html#loading-and-combining-files-of-simulation-results"><i class="fa fa-check"></i><b>18.4</b> Loading and combining files of simulation results</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="parallel-processing.html"><a href="parallel-processing.html"><i class="fa fa-check"></i><b>19</b> Parallel Processing</a>
<ul>
<li class="chapter" data-level="19.1" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-on-your-computer"><i class="fa fa-check"></i><b>19.1</b> Parallel on your computer</a></li>
<li class="chapter" data-level="19.2" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-off-your-computer"><i class="fa fa-check"></i><b>19.2</b> Parallel off your computer</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="parallel-processing.html"><a href="parallel-processing.html#what-is-a-command-line-interface"><i class="fa fa-check"></i><b>19.2.1</b> What is a command-line interface?</a></li>
<li class="chapter" data-level="19.2.2" data-path="parallel-processing.html"><a href="parallel-processing.html#running-a-job-on-a-cluster"><i class="fa fa-check"></i><b>19.2.2</b> Running a job on a cluster</a></li>
<li class="chapter" data-level="19.2.3" data-path="parallel-processing.html"><a href="parallel-processing.html#checking-on-a-job"><i class="fa fa-check"></i><b>19.2.3</b> Checking on a job</a></li>
<li class="chapter" data-level="19.2.4" data-path="parallel-processing.html"><a href="parallel-processing.html#running-lots-of-jobs-on-a-cluster"><i class="fa fa-check"></i><b>19.2.4</b> Running lots of jobs on a cluster</a></li>
<li class="chapter" data-level="19.2.5" data-path="parallel-processing.html"><a href="parallel-processing.html#resources-for-harvards-odyssey"><i class="fa fa-check"></i><b>19.2.5</b> Resources for Harvard’s Odyssey</a></li>
<li class="chapter" data-level="19.2.6" data-path="parallel-processing.html"><a href="parallel-processing.html#acknowledgements-1"><i class="fa fa-check"></i><b>19.2.6</b> Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html"><i class="fa fa-check"></i><b>20</b> Using simulation as a power calculator</a>
<ul>
<li class="chapter" data-level="20.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#getting-design-parameters-from-pilot-data"><i class="fa fa-check"></i><b>20.1</b> Getting design parameters from pilot data</a></li>
<li class="chapter" data-level="20.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#the-data-generating-process-2"><i class="fa fa-check"></i><b>20.2</b> The data generating process</a></li>
<li class="chapter" data-level="20.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#running-the-simulation-2"><i class="fa fa-check"></i><b>20.3</b> Running the simulation</a></li>
<li class="chapter" data-level="20.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#evaluating-power"><i class="fa fa-check"></i><b>20.4</b> Evaluating power</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#checking-validity-of-our-models"><i class="fa fa-check"></i><b>20.4.1</b> Checking validity of our models</a></li>
<li class="chapter" data-level="20.4.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-precision-se"><i class="fa fa-check"></i><b>20.4.2</b> Assessing Precision (SE)</a></li>
<li class="chapter" data-level="20.4.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-power"><i class="fa fa-check"></i><b>20.4.3</b> Assessing power</a></li>
<li class="chapter" data-level="20.4.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-minimum-detectable-effects"><i class="fa fa-check"></i><b>20.4.4</b> Assessing Minimum Detectable Effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html"><i class="fa fa-check"></i><b>21</b> Simulation under the Potential Outcomes Framework</a>
<ul>
<li class="chapter" data-level="21.1" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#finite-vs.-superpopulation-inference"><i class="fa fa-check"></i><b>21.1</b> Finite vs. Superpopulation inference</a></li>
<li class="chapter" data-level="21.2" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#data-generation-processes-for-potential-outcomes"><i class="fa fa-check"></i><b>21.2</b> Data generation processes for potential outcomes</a></li>
<li class="chapter" data-level="21.3" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#finite-sample-performance-measures"><i class="fa fa-check"></i><b>21.3</b> Finite sample performance measures</a></li>
<li class="chapter" data-level="21.4" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#nested-finite-simulation-procedure"><i class="fa fa-check"></i><b>21.4</b> Nested finite simulation procedure</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html"><i class="fa fa-check"></i><b>22</b> Simulations as evidence</a>
<ul>
<li class="chapter" data-level="22.1" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#use-extensive-multi-factor-simulations"><i class="fa fa-check"></i><b>22.1</b> Use extensive multi-factor simulations</a></li>
<li class="chapter" data-level="22.2" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#beat-them-at-their-own-game"><i class="fa fa-check"></i><b>22.2</b> Beat them at their own game</a></li>
<li class="chapter" data-level="22.3" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#calibrated-simulations"><i class="fa fa-check"></i><b>22.3</b> Calibrated simulations</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>23</b> The Parametric bootstrap</a>
<ul>
<li class="chapter" data-level="23.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#air-conditioners-a-stolen-case-study"><i class="fa fa-check"></i><b>23.1</b> Air conditioners: a stolen case study</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="on_functions.html"><a href="on_functions.html"><i class="fa fa-check"></i><b>24</b> Appendix: Coding tidbits</a>
<ul>
<li class="chapter" data-level="24.1" data-path="on_functions.html"><a href="on_functions.html#repeating-oneself"><i class="fa fa-check"></i><b>24.1</b> Other ways of repeating yourself</a></li>
<li class="chapter" data-level="24.2" data-path="on_functions.html"><a href="on_functions.html#default-arguments"><i class="fa fa-check"></i><b>24.2</b> Default arguments for functions</a></li>
<li class="chapter" data-level="24.3" data-path="on_functions.html"><a href="on_functions.html#testing-and-debugging-code-in-your-scripts"><i class="fa fa-check"></i><b>24.3</b> Testing and debugging code in your scripts</a></li>
<li class="chapter" data-level="24.4" data-path="on_functions.html"><a href="on_functions.html#keep-multiple-files-of-code"><i class="fa fa-check"></i><b>24.4</b> Keep multiple files of code</a></li>
<li class="chapter" data-level="24.5" data-path="on_functions.html"><a href="on_functions.html#the-source-command-and-keeping-things-organized"><i class="fa fa-check"></i><b>24.5</b> The source command and keeping things organized</a></li>
<li class="chapter" data-level="24.6" data-path="on_functions.html"><a href="on_functions.html#debugging-with-browser"><i class="fa fa-check"></i><b>24.6</b> Debugging with browser</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="further-readings-and-resources.html"><a href="further-readings-and-resources.html"><i class="fa fa-check"></i><b>25</b> Further readings and resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Designing Monte Carlo Simulations in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="case-ANOVA" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Case Study: Heteroskedastic ANOVA<a href="case-ANOVA.html#case-ANOVA" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>To illustrate the process of programming a simulation, we reconstruct the simulations from Brown and Forsythe (1974).
We also use this case study as a reoccuring example in some of the following chapters.</p>
<p>Brown and Forsythe wanted to study methods for null hypothesis testing in the following model: Consider a population consisting of <span class="math inline">\(g\)</span> separate groups, with population means <span class="math inline">\(\mu_1,...,\mu_g\)</span> and population variances <span class="math inline">\(\sigma_1^2,...,\sigma_g^2\)</span> for some characteristic <span class="math inline">\(X\)</span>.
We obtain samples of size <span class="math inline">\(n_1,...,n_g\)</span> from each of the groups, and take measurements of the characteristic for each sampled unit.
Let <span class="math inline">\(x_{ij}\)</span> denote the measurement from unit <span class="math inline">\(i\)</span> in group <span class="math inline">\(j\)</span>, for <span class="math inline">\(i = 1,...,n_j\)</span> for each <span class="math inline">\(j = 1,..., g\)</span>.
Our goal is to use the sample data to test the hypothesis that the population means are all equal, i.e.,
<span class="math display">\[
H_0: \mu_1 = \mu_2 = \cdots = \mu_g.
\]</span>
Now, if the population <em>variances</em> were all equal (i.e., <span class="math inline">\(\sigma_1^2 = \sigma_2^2 = \cdots = \sigma_g^2\)</span>), we could use a conventional one-way analysis of variance (ANOVA) to test.
However, one-way ANOVA might not work well if the variances are not equal.
The question is then what are best practices for testing, when in this heteroskedastic case.</p>
<p>To tackle this question, Brown and Forsythe evaluated two different hypothesis testing procedures, developed by James (1951) and Welch (1951), that had been proposed for testing this hypothesis without assuming equality of variances, along with the conventional one-way ANOVA F-test as a benchmark.
They also proposed and evaluated a new procedure of their own devising.
(This latter pieces makes this paper one of a canonical format for statistical methodology papers: find some problem that current procedures do not perfectly solve, invent something to do a better job, and then do simulation and/or math to build a case that the new procedure is better.)
Overall, the simulation involves comparing the performance of these different hypothesis testing procedures (the methods) under a range of conditions (different data generating processes).</p>
<p>For hypothesis testing, there are two main performance metrics of interest: type-I error rate and power.
The type-I error rate is, when the null hypothesis is true, how often a test falsely rejects the null.
It is a measure of how <em>valid</em> a method is.
Power is how often a test correctly rejects the null when it is indeed false.
It is a measure of how <em>powerful</em> (or sensitive) a method is.
The authors explored error rates and power for nominal <span class="math inline">\(\alpha\)</span>-levels of 1%, 5%, and 10%.
Table 1 of their paper reports the simulation results for type-I error (labeled as “size”); ideally, a test should have true type-I error very close to the nominal <span class="math inline">\(\alpha\)</span>.</p>
<p>They looked at ten different scenarios:</p>
<table>
<caption><span id="tab:BF-scenarios">Table 4.1: </span>Scenarios explored by Brown and Forsythe from their Table 1</caption>
<thead>
<tr class="header">
<th align="left">Groups</th>
<th align="left">Sample Sizes</th>
<th align="left">Standard Deviations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">4</td>
<td align="left">4,4,4,4</td>
<td align="left">1,1,1,1</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">4,8,10,12</td>
<td align="left">1,2,2,3</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">11,11,11,11</td>
<td align="left">1,1,1,1</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">11,16,16,21</td>
<td align="left">1,2,2,3</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">4,4,4,4,4,4</td>
<td align="left">1,1,1,1,1,1</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">4,6,6,8,10,12</td>
<td align="left">1,2,2,3</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">6,6,6,6,6,6</td>
<td align="left">1,1,1,1,1,1</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">11,11,11,11,11,11</td>
<td align="left">1,1,1,1,1,1</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="left">16,16,16,16,16,16</td>
<td align="left">1,2,2,3</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">21,21,21,21,21,21</td>
<td align="left">1,2,2,3</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="left">20,20,20,20,20,20,20,20,20,20</td>
<td align="left">1,1,1.5,1.5,2,2,2.5,2.5,3,3</td>
</tr>
</tbody>
</table>
<p>We also provide some of the numbers they reported in their Table 1 for these scenarios on Table <a href="case-ANOVA.html#tab:BF-table1">4.2</a>.</p>
<table>
<caption><span id="tab:BF-table1">Table 4.2: </span>Portion of “Table 1,” reproduced from Brown and Forsythe</caption>
<thead>
<tr class="header">
<th align="right">group</th>
<th align="right">F_10%</th>
<th align="right">F_5%</th>
<th align="right">F_1%</th>
<th align="right">F*_10%</th>
<th align="right">F*_5%</th>
<th align="right">F*_1%</th>
<th align="right">W_10%</th>
<th align="right">W_5%</th>
<th align="right">W_1%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">10.2</td>
<td align="right">4.9</td>
<td align="right">0.9</td>
<td align="right">7.8</td>
<td align="right">3.4</td>
<td align="right">0.5</td>
<td align="right">9.6</td>
<td align="right">4.5</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">12.0</td>
<td align="right">6.7</td>
<td align="right">1.7</td>
<td align="right">8.9</td>
<td align="right">4.1</td>
<td align="right">0.7</td>
<td align="right">10.3</td>
<td align="right">4.7</td>
<td align="right">0.8</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">9.9</td>
<td align="right">5.1</td>
<td align="right">1.1</td>
<td align="right">9.5</td>
<td align="right">4.8</td>
<td align="right">1.0</td>
<td align="right">10.8</td>
<td align="right">5.7</td>
<td align="right">1.6</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">5.9</td>
<td align="right">3.0</td>
<td align="right">0.6</td>
<td align="right">10.3</td>
<td align="right">5.7</td>
<td align="right">1.4</td>
<td align="right">9.8</td>
<td align="right">4.9</td>
<td align="right">0.9</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">21.9</td>
<td align="right">14.4</td>
<td align="right">5.6</td>
<td align="right">11.0</td>
<td align="right">6.2</td>
<td align="right">1.8</td>
<td align="right">11.3</td>
<td align="right">6.5</td>
<td align="right">2.0</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">10.1</td>
<td align="right">5.1</td>
<td align="right">1.0</td>
<td align="right">9.8</td>
<td align="right">5.7</td>
<td align="right">1.5</td>
<td align="right">10.0</td>
<td align="right">5.0</td>
<td align="right">0.9</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">11.4</td>
<td align="right">6.3</td>
<td align="right">1.8</td>
<td align="right">10.7</td>
<td align="right">5.7</td>
<td align="right">1.5</td>
<td align="right">10.1</td>
<td align="right">5.0</td>
<td align="right">1.1</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">10.3</td>
<td align="right">4.9</td>
<td align="right">1.1</td>
<td align="right">10.3</td>
<td align="right">5.1</td>
<td align="right">1.0</td>
<td align="right">10.2</td>
<td align="right">5.0</td>
<td align="right">1.0</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">17.3</td>
<td align="right">10.8</td>
<td align="right">3.9</td>
<td align="right">11.1</td>
<td align="right">6.2</td>
<td align="right">1.8</td>
<td align="right">10.5</td>
<td align="right">5.5</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">7.3</td>
<td align="right">4.0</td>
<td align="right">1.0</td>
<td align="right">11.5</td>
<td align="right">6.5</td>
<td align="right">1.8</td>
<td align="right">10.6</td>
<td align="right">5.4</td>
<td align="right">1.1</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">9.6</td>
<td align="right">4.9</td>
<td align="right">1.0</td>
<td align="right">7.3</td>
<td align="right">3.4</td>
<td align="right">0.4</td>
<td align="right">11.4</td>
<td align="right">6.1</td>
<td align="right">1.4</td>
</tr>
</tbody>
</table>
<p>Table <a href="case-ANOVA.html#tab:BF-table1">4.2</a> reports results on power; it is desirable to have higher power to reject null hypotheses that are false, so higher rates are better here.</p>
<p>To replicate this simulation we are going to first write code to evaluate our three procedures in a specific scenario with a specific set of core parameters (e.g., sample sizes, number of groups, and so forth), and then scale up to do a range of scenarios where we vary these parameters.</p>
<div id="the-data-generating-model" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> The data-generating model<a href="case-ANOVA.html#the-data-generating-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the heteroskedastic one-way ANOVA simulation, there are three sets of parameter values: population means, population variances, and sample sizes.
Rather than attempting to write a general data-generating function immediately, it is often easier to write code for a specific case first and then use that code as a launch point for the rest.
For example, say that we have four groups with means of 1, 2, 5, 6; variances of 3, 2, 5, 1; and sample sizes of 3, 6, 2, 4:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="case-ANOVA.html#cb59-1" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb59-2"><a href="case-ANOVA.html#cb59-2" tabindex="-1"></a>sigma_sq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>)</span>
<span id="cb59-3"><a href="case-ANOVA.html#cb59-3" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span></code></pre></div>
<p>Following Brown and Forsythe, we’ll assume that the measurements are normally distributed within each sub-group of the population. The following code generates a vector of group id’s and a vector of simulated measurements:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="case-ANOVA.html#cb60-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">sum</span>(sample_size) <span class="co"># total sample size</span></span>
<span id="cb60-2"><a href="case-ANOVA.html#cb60-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_size) <span class="co"># number of groups</span></span>
<span id="cb60-3"><a href="case-ANOVA.html#cb60-3" tabindex="-1"></a></span>
<span id="cb60-4"><a href="case-ANOVA.html#cb60-4" tabindex="-1"></a><span class="co"># group id</span></span>
<span id="cb60-5"><a href="case-ANOVA.html#cb60-5" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>g, <span class="at">times =</span> sample_size)</span>
<span id="cb60-6"><a href="case-ANOVA.html#cb60-6" tabindex="-1"></a></span>
<span id="cb60-7"><a href="case-ANOVA.html#cb60-7" tabindex="-1"></a><span class="co"># mean for each unit of the sample</span></span>
<span id="cb60-8"><a href="case-ANOVA.html#cb60-8" tabindex="-1"></a>mu_long <span class="ot">&lt;-</span> <span class="fu">rep</span>(mu, <span class="at">times =</span> sample_size) </span>
<span id="cb60-9"><a href="case-ANOVA.html#cb60-9" tabindex="-1"></a></span>
<span id="cb60-10"><a href="case-ANOVA.html#cb60-10" tabindex="-1"></a><span class="co"># sd for each unit of the sample</span></span>
<span id="cb60-11"><a href="case-ANOVA.html#cb60-11" tabindex="-1"></a>sigma_long <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">sqrt</span>(sigma_sq), <span class="at">times =</span> sample_size) </span>
<span id="cb60-12"><a href="case-ANOVA.html#cb60-12" tabindex="-1"></a></span>
<span id="cb60-13"><a href="case-ANOVA.html#cb60-13" tabindex="-1"></a><span class="co"># See what we have?</span></span>
<span id="cb60-14"><a href="case-ANOVA.html#cb60-14" tabindex="-1"></a><span class="fu">tibble</span>( <span class="at">group=</span>group, <span class="at">mu=</span>mu_long, <span class="at">sigma=</span>sigma_long)</span></code></pre></div>
<pre><code>## # A tibble: 15 × 3
##    group    mu sigma
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1     1  1.73
##  2     1     1  1.73
##  3     1     1  1.73
##  4     2     2  1.41
##  5     2     2  1.41
##  6     2     2  1.41
##  7     2     2  1.41
##  8     2     2  1.41
##  9     2     2  1.41
## 10     3     5  2.24
## 11     3     5  2.24
## 12     4     6  1   
## 13     4     6  1   
## 14     4     6  1   
## 15     4     6  1</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="case-ANOVA.html#cb62-1" tabindex="-1"></a><span class="co"># Now make our data</span></span>
<span id="cb62-2"><a href="case-ANOVA.html#cb62-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> mu_long, <span class="at">sd =</span> sigma_long)</span>
<span id="cb62-3"><a href="case-ANOVA.html#cb62-3" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">group =</span> group, <span class="at">x =</span> x)</span></code></pre></div>
<pre><code>## # A tibble: 15 × 2
##    group      x
##    &lt;int&gt;  &lt;dbl&gt;
##  1     1 -0.842
##  2     1  1.14 
##  3     1  2.31 
##  4     2  1.40 
##  5     2  1.92 
##  6     2  2.54 
##  7     2 -1.09 
##  8     2  4.47 
##  9     2 -0.658
## 10     3  6.39 
## 11     3  5.72 
## 12     4  5.25 
## 13     4  5.02 
## 14     4  4.66 
## 15     4  6.83</code></pre>
<p>We have made a small dataset of group membership and outcome.
We note that there are many different and legitimate ways of doing this in R.
E.g., we could generate each group separately, and then stack our groups, instead of using <code>rep</code> to do it all at once.
In general, we advocate the adage that if you can do it at all, then you should feel good about yourself.
Do not worry about writing code the “best” way when you are initially putting a simulation together.</p>
<p>To continue, as we are going to generate data over and over, we wrap this code in a function.
We also make our means, variances and sample sizes be parameters of our function so we can make datasets of different sizes and shapes, like so:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="case-ANOVA.html#cb64-1" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma_sq, sample_size) {</span>
<span id="cb64-2"><a href="case-ANOVA.html#cb64-2" tabindex="-1"></a></span>
<span id="cb64-3"><a href="case-ANOVA.html#cb64-3" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">sum</span>(sample_size)</span>
<span id="cb64-4"><a href="case-ANOVA.html#cb64-4" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_size)</span>
<span id="cb64-5"><a href="case-ANOVA.html#cb64-5" tabindex="-1"></a></span>
<span id="cb64-6"><a href="case-ANOVA.html#cb64-6" tabindex="-1"></a>  group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>g, <span class="at">times =</span> sample_size)</span>
<span id="cb64-7"><a href="case-ANOVA.html#cb64-7" tabindex="-1"></a>  mu_long <span class="ot">&lt;-</span> <span class="fu">rep</span>(mu, <span class="at">times =</span> sample_size)</span>
<span id="cb64-8"><a href="case-ANOVA.html#cb64-8" tabindex="-1"></a>  sigma_long <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">sqrt</span>(sigma_sq), <span class="at">times =</span> sample_size)</span>
<span id="cb64-9"><a href="case-ANOVA.html#cb64-9" tabindex="-1"></a></span>
<span id="cb64-10"><a href="case-ANOVA.html#cb64-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> mu_long, <span class="at">sd =</span> sigma_long)</span>
<span id="cb64-11"><a href="case-ANOVA.html#cb64-11" tabindex="-1"></a>  sim_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">group =</span> group, <span class="at">x =</span> x)</span>
<span id="cb64-12"><a href="case-ANOVA.html#cb64-12" tabindex="-1"></a></span>
<span id="cb64-13"><a href="case-ANOVA.html#cb64-13" tabindex="-1"></a>  <span class="fu">return</span>(sim_data)</span>
<span id="cb64-14"><a href="case-ANOVA.html#cb64-14" tabindex="-1"></a>}</span></code></pre></div>
<p>The above code is simply the code we built previously, all bundled up.
Our workflow is to scrabble around to get it to work once, the way we want, and then bundle up our final work into a function for later reuse.</p>
<p>Given our method, we can easily call our function to get a new set of simulated data.
For example, to generate a dataset with the same parameters as before, we can do:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="case-ANOVA.html#cb65-1" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(<span class="at">mu =</span> mu, <span class="at">sigma_sq =</span> sigma_sq, </span>
<span id="cb65-2"><a href="case-ANOVA.html#cb65-2" tabindex="-1"></a>                          <span class="at">sample_size =</span> sample_size)</span></code></pre></div>
<p>To generate one with 0s for the averages of each group, but the same group variances and sample sizes as before, we can do:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="case-ANOVA.html#cb66-1" tabindex="-1"></a>sim_data_null <span class="ot">&lt;-</span> <span class="fu">generate_data</span>( <span class="at">mu =</span> <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span> ),</span>
<span id="cb66-2"><a href="case-ANOVA.html#cb66-2" tabindex="-1"></a>                                <span class="at">sigma_sq =</span> sigma_sq, </span>
<span id="cb66-3"><a href="case-ANOVA.html#cb66-3" tabindex="-1"></a>                                <span class="at">sample_size =</span> sample_size)</span></code></pre></div>
<div id="coding-remark" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Coding remark<a href="case-ANOVA.html#coding-remark" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the above, we built some sample code, and then bundled it into a function by literally cutting and pasting the initial work we did into a function skeleton.
In the process, we shifted from having variables in our workspace with different names to using those variable names as parameters in our function call.</p>
<p>Developing code in this way is not without hazards.
In particular, after finishing making our function, our workspace has a variable <code>mu</code> in it and our function also has a parameter named <code>mu</code>.
Inside the function, R will use the parameter <code>mu</code> first, but this is potentially confusing.
As are, potentially, lines such as <code>mu = mu</code>, which means “set the function’s parameter called <code>mu</code> to the variable called <code>mu</code>.”
These are different things (with the same name).</p>
<p>One way to check your code, once a function is built, is to comment out the initial code (or delete it), restart R or at least clear out the workspace, and then re-run the code that uses the function.
If things still work, then you should be somewhat confident you successfully bundled your code into the function.</p>
<p>You can also, once you bundle your code, do a search and replace to change variable names in your function to something more generic, to make the separation more clear.</p>
</div>
</div>
<div id="the-estimation-procedures" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> The estimation procedures<a href="case-ANOVA.html#the-estimation-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Brown and Forsythe considered four different hypothesis testing procedures for heteroskedastic ANOVA.
We start with the simplest one, which is just to use a conventional one-way ANOVA (while mistakenly assuming homoskedasticity). R’s <code>oneway.test</code> function will actually calculate this test automatically:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="case-ANOVA.html#cb67-1" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(<span class="at">mu =</span> mu, <span class="at">sigma_sq =</span> sigma_sq,</span>
<span id="cb67-2"><a href="case-ANOVA.html#cb67-2" tabindex="-1"></a>                          <span class="at">sample_size =</span> sample_size)</span>
<span id="cb67-3"><a href="case-ANOVA.html#cb67-3" tabindex="-1"></a><span class="fu">oneway.test</span>(x <span class="sc">~</span> <span class="fu">factor</span>(group), <span class="at">data =</span> sim_data, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  One-way analysis of means
## 
## data:  x and factor(group)
## F = 8.0596, num df = 3, denom df = 11,
## p-value = 0.004044</code></pre>
<p>The main result we need here is the <span class="math inline">\(p\)</span>-value, which will let us assess the test’s Type-I error and power for a given nominal <span class="math inline">\(\alpha\)</span>-level. The following function takes simulated data as input and returns as output the <span class="math inline">\(p\)</span>-value from a one-way ANOVA:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="case-ANOVA.html#cb69-1" tabindex="-1"></a>ANOVA_F_aov <span class="ot">&lt;-</span> <span class="cf">function</span>(sim_data) {</span>
<span id="cb69-2"><a href="case-ANOVA.html#cb69-2" tabindex="-1"></a>  oneway_anova <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(x <span class="sc">~</span> <span class="fu">factor</span>(group), <span class="at">data =</span> sim_data,</span>
<span id="cb69-3"><a href="case-ANOVA.html#cb69-3" tabindex="-1"></a>                              <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-4"><a href="case-ANOVA.html#cb69-4" tabindex="-1"></a>  <span class="fu">return</span>(oneway_anova<span class="sc">$</span>p.value)</span>
<span id="cb69-5"><a href="case-ANOVA.html#cb69-5" tabindex="-1"></a>}</span>
<span id="cb69-6"><a href="case-ANOVA.html#cb69-6" tabindex="-1"></a></span>
<span id="cb69-7"><a href="case-ANOVA.html#cb69-7" tabindex="-1"></a><span class="fu">ANOVA_F_aov</span>(sim_data)</span></code></pre></div>
<pre><code>## [1] 0.004043699</code></pre>
<p>We might instead write the code to implement the ANOVA test ourselves.
This has some plusses (e.g., <code>oneway.test</code> maybe is doing a lot of other stuff which could take time and slow down our simulation) and minuses (e..g, writing our own code takes <em>our</em> time, and it gives us lots of room to make mistakes and thus make life hard on ourself).
For further discussion of the trade-offs, see Chapter <a href="optimize-code.html#optimize-code">16</a>, where we do implement it by hand and see what kind of speed-ups we can obtain by doing that.</p>
<p>We next implement the Welch test, another one of the tests considered by Brown and Forsythe.
Here is a function that calculates the Welch test by hand, again following the notation and formulas from the paper:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="case-ANOVA.html#cb71-1" tabindex="-1"></a>Welch_F <span class="ot">&lt;-</span> <span class="cf">function</span>(sim_data) {</span>
<span id="cb71-2"><a href="case-ANOVA.html#cb71-2" tabindex="-1"></a></span>
<span id="cb71-3"><a href="case-ANOVA.html#cb71-3" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> sim_data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>( group ) <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="case-ANOVA.html#cb71-4" tabindex="-1"></a>    <span class="fu">summarise</span>( <span class="at">x_bar =</span> <span class="fu">mean</span>( x ),</span>
<span id="cb71-5"><a href="case-ANOVA.html#cb71-5" tabindex="-1"></a>               <span class="at">s_sq =</span> <span class="fu">var</span>( x ),</span>
<span id="cb71-6"><a href="case-ANOVA.html#cb71-6" tabindex="-1"></a>               <span class="at">n =</span> <span class="fu">n</span>() )</span>
<span id="cb71-7"><a href="case-ANOVA.html#cb71-7" tabindex="-1"></a>  </span>
<span id="cb71-8"><a href="case-ANOVA.html#cb71-8" tabindex="-1"></a>  g <span class="ot">=</span> <span class="fu">nrow</span>( stats )</span>
<span id="cb71-9"><a href="case-ANOVA.html#cb71-9" tabindex="-1"></a></span>
<span id="cb71-10"><a href="case-ANOVA.html#cb71-10" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">mutate</span>( stats, </span>
<span id="cb71-11"><a href="case-ANOVA.html#cb71-11" tabindex="-1"></a>                   <span class="at">w =</span> n <span class="sc">/</span> s_sq )</span>
<span id="cb71-12"><a href="case-ANOVA.html#cb71-12" tabindex="-1"></a>  </span>
<span id="cb71-13"><a href="case-ANOVA.html#cb71-13" tabindex="-1"></a>  res <span class="ot">&lt;-</span> stats <span class="sc">%&gt;%</span></span>
<span id="cb71-14"><a href="case-ANOVA.html#cb71-14" tabindex="-1"></a>    <span class="fu">summarise</span>( <span class="at">u =</span> <span class="fu">sum</span>(w),</span>
<span id="cb71-15"><a href="case-ANOVA.html#cb71-15" tabindex="-1"></a>               <span class="at">x_tilde =</span> <span class="fu">sum</span>( w <span class="sc">*</span> x_bar ) <span class="sc">/</span> u,</span>
<span id="cb71-16"><a href="case-ANOVA.html#cb71-16" tabindex="-1"></a>               <span class="at">msbtw =</span> <span class="fu">sum</span>( w <span class="sc">*</span> (x_bar <span class="sc">-</span> x_tilde)<span class="sc">^</span><span class="dv">2</span> ) <span class="sc">/</span> (g <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb71-17"><a href="case-ANOVA.html#cb71-17" tabindex="-1"></a>               <span class="at">G =</span> <span class="fu">sum</span>( (<span class="dv">1</span> <span class="sc">-</span> w <span class="sc">/</span> u)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>) ),</span>
<span id="cb71-18"><a href="case-ANOVA.html#cb71-18" tabindex="-1"></a>               <span class="at">denom =</span> <span class="dv">1</span> <span class="sc">+</span>  G <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> (g <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> (g<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb71-19"><a href="case-ANOVA.html#cb71-19" tabindex="-1"></a>               <span class="at">W =</span> msbtw <span class="sc">/</span> denom,</span>
<span id="cb71-20"><a href="case-ANOVA.html#cb71-20" tabindex="-1"></a>               <span class="at">f =</span> (g<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="dv">3</span> <span class="sc">*</span> G) )</span>
<span id="cb71-21"><a href="case-ANOVA.html#cb71-21" tabindex="-1"></a></span>
<span id="cb71-22"><a href="case-ANOVA.html#cb71-22" tabindex="-1"></a>  pval <span class="ot">&lt;-</span> <span class="fu">pf</span>(res<span class="sc">$</span>W, <span class="at">df1 =</span> g <span class="sc">-</span> <span class="dv">1</span>, <span class="at">df2 =</span> res<span class="sc">$</span>f, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb71-23"><a href="case-ANOVA.html#cb71-23" tabindex="-1"></a></span>
<span id="cb71-24"><a href="case-ANOVA.html#cb71-24" tabindex="-1"></a>  <span class="fu">return</span>(pval)</span>
<span id="cb71-25"><a href="case-ANOVA.html#cb71-25" tabindex="-1"></a>}</span>
<span id="cb71-26"><a href="case-ANOVA.html#cb71-26" tabindex="-1"></a></span>
<span id="cb71-27"><a href="case-ANOVA.html#cb71-27" tabindex="-1"></a><span class="fu">Welch_F</span>(sim_data)</span></code></pre></div>
<pre><code>## [1] 0.04428594</code></pre>
<p>Our estimation function does not care if the data are simulated or not–we call the parameter <code>data</code> not <code>sim_data</code> to reflect this.
Eventually, we might imagine using this function on our real data!
Also, we can put a lot of complex stuff in a function–and then forget all about it.
In the above, for example, you can understand everything we say about writing simulations even if you do not understand anything at all about what this function is doing: it is just a black box that takes data and returns a <span class="math inline">\(p\)</span>-value.</p>
</div>
<div id="running-the-simulation" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Running the simulation<a href="case-ANOVA.html#running-the-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now have functions that implement steps 2 and 3 of the simulation.
Given some parameters, <code>generate_data</code> produces a simulated dataset and <code>ANOVA_F_aov</code> and <code>Welch_F</code> use the simulated data to calculate <span class="math inline">\(p\)</span>-values two different ways.
We now want to know which way is better, and how.
To answer this question, we next need to repeat this chain of calculations a bunch of times.</p>
<p>We first make a function that puts our chain together in a single method.
This method is also responsible for putting the results together in a tidy structure that is easy to aggregate and analyze.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="case-ANOVA.html#cb73-1" tabindex="-1"></a>one_run <span class="ot">=</span> <span class="cf">function</span>( mu, sigma_sq, sample_size ) {</span>
<span id="cb73-2"><a href="case-ANOVA.html#cb73-2" tabindex="-1"></a>  sim_data <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(<span class="at">mu =</span> mu, <span class="at">sigma_sq =</span> sigma_sq,</span>
<span id="cb73-3"><a href="case-ANOVA.html#cb73-3" tabindex="-1"></a>                            <span class="at">sample_size =</span> sample_size)</span>
<span id="cb73-4"><a href="case-ANOVA.html#cb73-4" tabindex="-1"></a>  anova_p <span class="ot">&lt;-</span> <span class="fu">ANOVA_F_aov</span>(sim_data)</span>
<span id="cb73-5"><a href="case-ANOVA.html#cb73-5" tabindex="-1"></a>  Welch_p <span class="ot">&lt;-</span> <span class="fu">Welch_F</span>(sim_data)</span>
<span id="cb73-6"><a href="case-ANOVA.html#cb73-6" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">ANOVA =</span> anova_p, <span class="at">Welch =</span> Welch_p)</span>
<span id="cb73-7"><a href="case-ANOVA.html#cb73-7" tabindex="-1"></a>}</span>
<span id="cb73-8"><a href="case-ANOVA.html#cb73-8" tabindex="-1"></a></span>
<span id="cb73-9"><a href="case-ANOVA.html#cb73-9" tabindex="-1"></a><span class="fu">one_run</span>( <span class="at">mu =</span> mu, <span class="at">sigma_sq =</span> sigma_sq, <span class="at">sample_size =</span> sample_size )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##     ANOVA  Welch
##     &lt;dbl&gt;  &lt;dbl&gt;
## 1 0.00386 0.0266</code></pre>
<p>A single simulation trial simply does steps 2 and 3, ending with a nice dataframe or tibble that has our results for that single run.</p>
<p>We next call <code>one_run()</code> over and over; see <a href="on_functions.html#repeating-oneself">24.1</a> for some discussion of options.
The following uses <code>map_df</code> to run <code>one_run()</code> 4 times and then stack the results into a single data frame (the <code>_df</code> tells R to do the stacking):</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="case-ANOVA.html#cb75-1" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">map_df</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb75-2"><a href="case-ANOVA.html#cb75-2" tabindex="-1"></a>                  <span class="sc">~</span> <span class="fu">one_run</span>(<span class="at">mu =</span> mu, <span class="at">sigma_sq =</span> sigma_sq,</span>
<span id="cb75-3"><a href="case-ANOVA.html#cb75-3" tabindex="-1"></a>                          <span class="at">sample_size =</span> sample_size) )</span>
<span id="cb75-4"><a href="case-ANOVA.html#cb75-4" tabindex="-1"></a>sim_data</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##      ANOVA   Welch
##      &lt;dbl&gt;   &lt;dbl&gt;
## 1 0.00686  0.0874 
## 2 0.0118   0.00684
## 3 0.00882  0.0332 
## 4 0.000152 0.0121</code></pre>
<p>Voila! We have simulated <span class="math inline">\(p\)</span>-values!</p>
</div>
<div id="analyzing-the-simulation" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Analyzing the Simulation<a href="case-ANOVA.html#analyzing-the-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now have all the pieces in place to reproduce the results from Brown and Forsythe (1974).
We first focus on calculating the actual type-I error rate of these tests—that is, the proportion of the time that they reject the null hypothesis of equal means when that null is actually true—for an <span class="math inline">\(\alpha\)</span>-level of .05.
We therefore need to simulate data according to process where the population means are indeed all equal. Arbitrarily, we start with <span class="math inline">\(g = 4\)</span> groups and set all of the means equal to zero:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="case-ANOVA.html#cb77-1" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)</span></code></pre></div>
<p>In the fifth row of Table 1, Brown and Forsythe examine performance for the following parameter values for sample size and population variance:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="case-ANOVA.html#cb78-1" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>)</span>
<span id="cb78-2"><a href="case-ANOVA.html#cb78-2" tabindex="-1"></a>sigma_sq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<p>With these parameter values, we can use our <code>replicate</code> code to simulate 10,000 <span class="math inline">\(p\)</span>-values:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="case-ANOVA.html#cb79-1" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">rerun</span>(<span class="dv">10000</span>, </span>
<span id="cb79-2"><a href="case-ANOVA.html#cb79-2" tabindex="-1"></a>  sim_data <span class="ot">&lt;-</span> <span class="fu">one_run</span>(<span class="at">mu =</span> mu,</span>
<span id="cb79-3"><a href="case-ANOVA.html#cb79-3" tabindex="-1"></a>                      <span class="at">sigma_sq =</span> sigma_sq,</span>
<span id="cb79-4"><a href="case-ANOVA.html#cb79-4" tabindex="-1"></a>                      <span class="at">sample_size =</span> sample_size) )</span>
<span id="cb79-5"><a href="case-ANOVA.html#cb79-5" tabindex="-1"></a>p_vals <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(p_vals)</span>
<span id="cb79-6"><a href="case-ANOVA.html#cb79-6" tabindex="-1"></a>p_vals</span></code></pre></div>
<pre><code>## # A tibble: 10,000 × 2
##     ANOVA Welch
##     &lt;dbl&gt; &lt;dbl&gt;
##  1 0.276  0.512
##  2 0.503  0.649
##  3 0.438  0.693
##  4 0.781  0.898
##  5 0.764  0.779
##  6 0.153  0.383
##  7 0.942  0.921
##  8 0.640  0.845
##  9 0.0978 0.174
## 10 0.724  0.820
## # ℹ 9,990 more rows</code></pre>
<p>We next use our replications to calculate the rejection rates.
The rule is that the null is rejected if the <span class="math inline">\(p\)</span>-value is less than <span class="math inline">\(\alpha\)</span>. To get the rejection rate, calculate the proportion of replications where the null is rejected.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="case-ANOVA.html#cb81-1" tabindex="-1"></a><span class="fu">sum</span>(p_vals<span class="sc">$</span>ANOVA <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="dv">10000</span></span></code></pre></div>
<pre><code>## [1] 0.1357</code></pre>
<p>This is equivalent to taking the mean of the logical conditions:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="case-ANOVA.html#cb83-1" tabindex="-1"></a><span class="fu">mean</span>(p_vals<span class="sc">$</span>ANOVA <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.1357</code></pre>
<p>We get a rejection rate that is much larger than <span class="math inline">\(\alpha = .05\)</span>.
We have learned that the ANOVA F-test does not adequately control Type-I error under this set of conditions.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="case-ANOVA.html#cb85-1" tabindex="-1"></a><span class="fu">mean</span>(p_vals<span class="sc">$</span>Welch <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.063</code></pre>
<p>The Welch test does much better, although it appears to be a little bit in excess of 0.05.</p>
<p>Note that these two numbers are quite close (though not quite identical) to the corresponding entries in Table 1 of Brown and Forsythe (1974). The difference is due to the fact that both Table 1 and are results are actually <em>estimated</em> rejection rates, because we have not actually simulated an infinite number of replications. The estimation error arising from using a finite number of replications is called <em>simulation error</em> (or <em>Monte Carlo error</em>).
Later on, we will look more at how to estimate and control the Monte Carlo simulation error in our studies.</p>
</div>
<div id="exAnovaExercises" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Exercises<a href="case-ANOVA.html#exAnovaExercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following exercises involve exploring and tweaking the above simulation code we have developed to replicate the results of Brown and Forsythe (1974).</p>
<ol style="list-style-type: decimal">
<li><p>Table 1 from Brown and Forsythe reported rejection rates for <span class="math inline">\(\alpha = .01\)</span> and <span class="math inline">\(\alpha = .10\)</span> in addition to <span class="math inline">\(\alpha = .05\)</span>. Calculate the rejection rates of the ANOVA F and Welch tests for all three <span class="math inline">\(\alpha\)</span>-levels.</p></li>
<li><p>Try simulating the Type-I error rates for the parameter values in the first two rows of Table 1 of the original paper. Use 10,000 replications. How do your results compare to the results reported in Table 1?</p></li>
<li><p>Try simulating the <strong>power levels</strong> for a couple of sets of parameter values from Table 2. Use 10,000 replications. How do your results compare to the results reported in the Table?</p></li>
<li><p>One might, instead of having <code>one_run</code> return a single row with the columns for the <span class="math inline">\(p\)</span>-values, have multiple rows with each row being a test (so one row for ANOVA and one for Welch). E.g., it might produce results like this:</p></li>
</ol>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="case-ANOVA.html#cb87-1" tabindex="-1"></a><span class="fu">one_run_long</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   method pvalue
##   &lt;chr&gt;   &lt;dbl&gt;
## 1 ANOVA   0.835
## 2 Welch   0.780</code></pre>
<p>Modify <code>one_run()</code> to do this, update your simulation code, and then use <code>group_by()</code> plus <code>summarise()</code> to calculate rejection rates in one go. The “long” approach is often nicer when evaluating more than two methods, or when each method returns not just a <span class="math inline">\(p\)</span>-value but other quantities of interest.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="structure-of-a-simulation-study.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap-DGP.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jepusto/Designing-Simulations-in-R/edit/master/015-Case-study-ANOVA.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Designing-Simulations-in-R.pdf", "Designing-Simulations-in-R.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
