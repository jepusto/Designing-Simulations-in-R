<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Estimation procedures | Designing Monte Carlo Simulations in R</title>
  <meta name="description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Estimation procedures | Designing Monte Carlo Simulations in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="github-repo" content="jepusto/Designing-Simulations-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Estimation procedures | Designing Monte Carlo Simulations in R" />
  
  <meta name="twitter:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  

<meta name="author" content="Luke W. Miratrix and James E. Pustejovsky (Equal authors)" />


<meta name="date" content="2023-05-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap_DGP.html"/>
<link rel="next" href="performance-criteria.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Designing Simulations in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#some-of-simulations-many-uses"><i class="fa fa-check"></i><b>1.1</b> Some of simulation’s many uses</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#comparing-statistical-approaches"><i class="fa fa-check"></i><b>1.1.1</b> Comparing statistical approaches</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#assessing-performance-of-complex-pipelines"><i class="fa fa-check"></i><b>1.1.2</b> Assessing performance of complex pipelines</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#assessing-performance-under-misspecification"><i class="fa fa-check"></i><b>1.1.3</b> Assessing performance under misspecification</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#assessing-the-finite-sample-performance-of-a-statistical-approach"><i class="fa fa-check"></i><b>1.1.4</b> Assessing the finite sample performance of a statistical approach</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#conducting-power-analyses"><i class="fa fa-check"></i><b>1.1.5</b> Conducting Power Analyses</a></li>
<li class="chapter" data-level="1.1.6" data-path="introduction.html"><a href="introduction.html#simulating-processess"><i class="fa fa-check"></i><b>1.1.6</b> Simulating processess</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-perils-of-simulation-as-evidence"><i class="fa fa-check"></i><b>1.2</b> The perils of simulation as evidence</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#why-r-and-rstudio"><i class="fa fa-check"></i><b>1.3</b> Why R and RStudio?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#templates-vs.-patterns"><i class="fa fa-check"></i><b>1.3.1</b> Templates vs. Patterns</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#the-tidyverse-and-a-recommended-text"><i class="fa fa-check"></i><b>1.3.2</b> The tidyverse and a recommended text</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#functions"><i class="fa fa-check"></i><b>1.3.3</b> Functions</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#a-dangerous-function"><i class="fa fa-check"></i><b>1.3.4</b> A dangerous function</a></li>
<li class="chapter" data-level="1.3.5" data-path="introduction.html"><a href="introduction.html#function-skeletons"><i class="fa fa-check"></i><b>1.3.5</b> Function skeletons</a></li>
<li class="chapter" data-level="1.3.6" data-path="introduction.html"><a href="introduction.html#pipe-dreams"><i class="fa fa-check"></i><b>1.3.6</b> <code>%&gt;%</code> (Pipe) dreams</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html"><i class="fa fa-check"></i><b>2</b> An initial simulation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulation-for-a-single-scenario"><i class="fa fa-check"></i><b>2.1</b> Simulation for a single scenario</a></li>
<li class="chapter" data-level="2.2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulating-across-different-scenarios"><i class="fa fa-check"></i><b>2.2</b> Simulating across different scenarios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html"><i class="fa fa-check"></i><b>3</b> Structure of a simulation study</a>
<ul>
<li class="chapter" data-level="3.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#general-structure-of-a-simulation"><i class="fa fa-check"></i><b>3.1</b> General structure of a simulation</a></li>
<li class="chapter" data-level="3.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#tidy-simulations"><i class="fa fa-check"></i><b>3.2</b> Tidy simulations</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#the-data-generating-process-dgp"><i class="fa fa-check"></i><b>3.2.1</b> The Data Generating Process (DGP)</a></li>
<li class="chapter" data-level="3.2.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#estimation-methods"><i class="fa fa-check"></i><b>3.2.2</b> Estimation methods</a></li>
<li class="chapter" data-level="3.2.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#repetition"><i class="fa fa-check"></i><b>3.2.3</b> Repetition</a></li>
<li class="chapter" data-level="3.2.4" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#performance-summaries"><i class="fa fa-check"></i><b>3.2.4</b> Performance summaries</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#multiple-scenarios"><i class="fa fa-check"></i><b>3.3</b> Multiple Scenarios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="case_ANOVA.html"><a href="case_ANOVA.html"><i class="fa fa-check"></i><b>4</b> Case Study: Heteroskedastic ANOVA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="case_ANOVA.html"><a href="case_ANOVA.html#the-data-generating-model"><i class="fa fa-check"></i><b>4.1</b> The data-generating model</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="case_ANOVA.html"><a href="case_ANOVA.html#coding-remark"><i class="fa fa-check"></i><b>4.1.1</b> Coding remark</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="case_ANOVA.html"><a href="case_ANOVA.html#the-estimation-procedures"><i class="fa fa-check"></i><b>4.2</b> The estimation procedures</a></li>
<li class="chapter" data-level="4.3" data-path="case_ANOVA.html"><a href="case_ANOVA.html#running-the-simulation"><i class="fa fa-check"></i><b>4.3</b> Running the simulation</a></li>
<li class="chapter" data-level="4.4" data-path="case_ANOVA.html"><a href="case_ANOVA.html#analyzing-the-simulation"><i class="fa fa-check"></i><b>4.4</b> Analyzing the Simulation</a></li>
<li class="chapter" data-level="4.5" data-path="case_ANOVA.html"><a href="case_ANOVA.html#exAnovaExercises"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap_DGP.html"><a href="chap_DGP.html"><i class="fa fa-check"></i><b>5</b> Data-generating models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap_DGP.html"><a href="chap_DGP.html#a-statistical-model-is-a-recipe-for-data-generation"><i class="fa fa-check"></i><b>5.1</b> A statistical model is a recipe for data generation</a></li>
<li class="chapter" data-level="5.2" data-path="chap_DGP.html"><a href="chap_DGP.html#checking-the-data-generating-function"><i class="fa fa-check"></i><b>5.2</b> Checking the data-generating function</a></li>
<li class="chapter" data-level="5.3" data-path="chap_DGP.html"><a href="chap_DGP.html#case_cluster"><i class="fa fa-check"></i><b>5.3</b> Example: Simulating clustered data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chap_DGP.html"><a href="chap_DGP.html#a-design-decision-what-do-we-want-to-manipulate"><i class="fa fa-check"></i><b>5.3.1</b> A design decision: What do we want to manipulate?</a></li>
<li class="chapter" data-level="5.3.2" data-path="chap_DGP.html"><a href="chap_DGP.html#a-model-for-a-cluster-rct"><i class="fa fa-check"></i><b>5.3.2</b> A model for a cluster RCT</a></li>
<li class="chapter" data-level="5.3.3" data-path="chap_DGP.html"><a href="chap_DGP.html#converting-our-model-to-code"><i class="fa fa-check"></i><b>5.3.3</b> Converting our model to code</a></li>
<li class="chapter" data-level="5.3.4" data-path="chap_DGP.html"><a href="chap_DGP.html#standardization-in-a-data-generating-process"><i class="fa fa-check"></i><b>5.3.4</b> Standardization in a data generating process</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap_DGP.html"><a href="chap_DGP.html#exercises"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chap_DGP.html"><a href="chap_DGP.html#ex_dgp"><i class="fa fa-check"></i><b>5.4.1</b> The Shifted-and-scaled t distribution</a></li>
<li class="chapter" data-level="5.4.2" data-path="chap_DGP.html"><a href="chap_DGP.html#the-cluster-rct-dgp"><i class="fa fa-check"></i><b>5.4.2</b> The Cluster RCT DGP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimation-procedures.html"><a href="estimation-procedures.html"><i class="fa fa-check"></i><b>6</b> Estimation procedures</a>
<ul>
<li class="chapter" data-level="6.1" data-path="estimation-procedures.html"><a href="estimation-procedures.html#checking-the-estimation-function"><i class="fa fa-check"></i><b>6.1</b> Checking the estimation function</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-procedures.html"><a href="estimation-procedures.html#checking-via-simulation"><i class="fa fa-check"></i><b>6.2</b> Checking via simulation</a></li>
<li class="chapter" data-level="6.3" data-path="estimation-procedures.html"><a href="estimation-procedures.html#multiple-estimation-procedures"><i class="fa fa-check"></i><b>6.3</b> Multiple estimation procedures</a></li>
<li class="chapter" data-level="6.4" data-path="estimation-procedures.html"><a href="estimation-procedures.html#exercises-1"><i class="fa fa-check"></i><b>6.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="estimation-procedures.html"><a href="estimation-procedures.html#more-welch-and-adding-the-bff-test"><i class="fa fa-check"></i><b>6.4.1</b> More Welch and adding the BFF test</a></li>
<li class="chapter" data-level="6.4.2" data-path="estimation-procedures.html"><a href="estimation-procedures.html#more-estimators-for-the-crt"><i class="fa fa-check"></i><b>6.4.2</b> More estimators for the CRT</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="performance-criteria.html"><a href="performance-criteria.html"><i class="fa fa-check"></i><b>7</b> Performance criteria</a>
<ul>
<li class="chapter" data-level="7.1" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-vs.-estimation"><i class="fa fa-check"></i><b>7.1</b> Inference vs. Estimation</a></li>
<li class="chapter" data-level="7.2" data-path="performance-criteria.html"><a href="performance-criteria.html#comparing-estimators"><i class="fa fa-check"></i><b>7.2</b> Comparing estimators</a></li>
<li class="chapter" data-level="7.3" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-point-estimator"><i class="fa fa-check"></i><b>7.3</b> Assessing a point estimator</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="performance-criteria.html"><a href="performance-criteria.html#example-on-our-cluster-rct"><i class="fa fa-check"></i><b>7.3.1</b> Example on our Cluster RCT</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-standard-error-estimator"><i class="fa fa-check"></i><b>7.4</b> Assessing a standard error estimator</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="performance-criteria.html"><a href="performance-criteria.html#why-not-assess-the-estimate-se-directly"><i class="fa fa-check"></i><b>7.4.1</b> Why not assess the estimate SE directly?</a></li>
<li class="chapter" data-level="7.4.2" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-ses-for-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>7.4.2</b> Assessing SEs for our Cluster RCT simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-an-inferential-procedure"><i class="fa fa-check"></i><b>7.5</b> Assessing an inferential procedure</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="performance-criteria.html"><a href="performance-criteria.html#validity"><i class="fa fa-check"></i><b>7.5.1</b> Validity</a></li>
<li class="chapter" data-level="7.5.2" data-path="performance-criteria.html"><a href="performance-criteria.html#power"><i class="fa fa-check"></i><b>7.5.2</b> Power</a></li>
<li class="chapter" data-level="7.5.3" data-path="performance-criteria.html"><a href="performance-criteria.html#the-rejection-rate"><i class="fa fa-check"></i><b>7.5.3</b> The Rejection Rate</a></li>
<li class="chapter" data-level="7.5.4" data-path="performance-criteria.html"><a href="performance-criteria.html#our-cluster-rct-simulation"><i class="fa fa-check"></i><b>7.5.4</b> Our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-confidence-intervals"><i class="fa fa-check"></i><b>7.6</b> Assessing confidence intervals</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="performance-criteria.html"><a href="performance-criteria.html#clusters-with-confidence"><i class="fa fa-check"></i><b>7.6.1</b> Clusters with Confidence</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="performance-criteria.html"><a href="performance-criteria.html#further-measures-of-performance"><i class="fa fa-check"></i><b>7.7</b> Further measures of performance</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="performance-criteria.html"><a href="performance-criteria.html#sec_relative_performance"><i class="fa fa-check"></i><b>7.7.1</b> Relative vs. Absolute Criteria</a></li>
<li class="chapter" data-level="7.7.2" data-path="performance-criteria.html"><a href="performance-criteria.html#robust-measures-of-performance"><i class="fa fa-check"></i><b>7.7.2</b> Robust measures of performance</a></li>
<li class="chapter" data-level="7.7.3" data-path="performance-criteria.html"><a href="performance-criteria.html#summary-of-peformance-measures"><i class="fa fa-check"></i><b>7.7.3</b> Summary of peformance measures</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="performance-criteria.html"><a href="performance-criteria.html#uncertainty-in-performance-estimates-the-mcse"><i class="fa fa-check"></i><b>7.8</b> Uncertainty in performance estimates (the MCSE)</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-for-variance-estimators"><i class="fa fa-check"></i><b>7.8.1</b> MCSE for variance estimators</a></li>
<li class="chapter" data-level="7.8.2" data-path="performance-criteria.html"><a href="performance-criteria.html#calculating-mcses-with-the-simhelpers-package"><i class="fa fa-check"></i><b>7.8.2</b> Calculating MCSEs with the simhelpers package</a></li>
<li class="chapter" data-level="7.8.3" data-path="performance-criteria.html"><a href="performance-criteria.html#cluster-rct-continued-do-we-have-enough-simulation-trials"><i class="fa fa-check"></i><b>7.8.3</b> Cluster RCT, continued: Do we have enough simulation trials?</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="performance-criteria.html"><a href="performance-criteria.html#exercises-2"><i class="fa fa-check"></i><b>7.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="case_Cronbach.html"><a href="case_Cronbach.html"><i class="fa fa-check"></i><b>8</b> Project: Cronbach Alpha</a>
<ul>
<li class="chapter" data-level="8.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#background"><i class="fa fa-check"></i><b>8.1</b> Background</a></li>
<li class="chapter" data-level="8.2" data-path="case_Cronbach.html"><a href="case_Cronbach.html#getting-started"><i class="fa fa-check"></i><b>8.2</b> Getting started</a></li>
<li class="chapter" data-level="8.3" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-data-generating-function"><i class="fa fa-check"></i><b>8.3</b> The data-generating function</a></li>
<li class="chapter" data-level="8.4" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-estimation-function"><i class="fa fa-check"></i><b>8.4</b> The estimation function</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercices-naive-confidence-intervals"><i class="fa fa-check"></i><b>8.4.1</b> Exercices (Naive confidence intervals)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="case_Cronbach.html"><a href="case_Cronbach.html#estimator-performance"><i class="fa fa-check"></i><b>8.5</b> Estimator performance</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-calculating-performance"><i class="fa fa-check"></i><b>8.5.1</b> Exercises (Calculating Performance)</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="case_Cronbach.html"><a href="case_Cronbach.html#replication-and-the-simulation"><i class="fa fa-check"></i><b>8.6</b> Replication (and the simulation)</a></li>
<li class="chapter" data-level="8.7" data-path="case_Cronbach.html"><a href="case_Cronbach.html#extension-confidence-interval-coverage"><i class="fa fa-check"></i><b>8.7</b> Extension: Confidence interval coverage</a></li>
<li class="chapter" data-level="8.8" data-path="case_Cronbach.html"><a href="case_Cronbach.html#a-taste-of-multiple-scenarios"><i class="fa fa-check"></i><b>8.8</b> A taste of multiple scenarios</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-3"><i class="fa fa-check"></i><b>8.8.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html"><i class="fa fa-check"></i><b>9</b> Case study: Attrition in a simple randomized experiment</a>
<ul>
<li class="chapter" data-level="9.1" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#the-data-generating-process"><i class="fa fa-check"></i><b>9.1</b> The data generating process</a></li>
<li class="chapter" data-level="9.2" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#estimators"><i class="fa fa-check"></i><b>9.2</b> Estimators</a></li>
<li class="chapter" data-level="9.3" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#performance-criteria-1"><i class="fa fa-check"></i><b>9.3</b> Performance criteria</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exp_design.html"><a href="exp_design.html"><i class="fa fa-check"></i><b>10</b> Designing the multifactor simulation experiment</a>
<ul>
<li class="chapter" data-level="10.1" data-path="exp_design.html"><a href="exp_design.html#choosing-parameter-combinations"><i class="fa fa-check"></i><b>10.1</b> Choosing parameter combinations</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="exp_design.html"><a href="exp_design.html#choosing-parameters-for-the-clustered-rct"><i class="fa fa-check"></i><b>10.1.1</b> Choosing parameters for the Clustered RCT</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="exp_design.html"><a href="exp_design.html#using-pmap-to-run-multifactor-simulations"><i class="fa fa-check"></i><b>10.2</b> Using pmap to run multifactor simulations</a></li>
<li class="chapter" data-level="10.3" data-path="exp_design.html"><a href="exp_design.html#ways-of-repeating-oneself"><i class="fa fa-check"></i><b>10.3</b> Ways of repeating oneself</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="exp_design.html"><a href="exp_design.html#getting-raw-results-ready-for-analysis"><i class="fa fa-check"></i><b>10.3.1</b> Getting raw results ready for analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="exp_design.html"><a href="exp_design.html#running-the-cluster-rct-multifactor-experiment"><i class="fa fa-check"></i><b>10.4</b> Running the Cluster RCT multifactor experiment</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="exp_design.html"><a href="exp_design.html#making-analyze_data-quiet"><i class="fa fa-check"></i><b>10.4.1</b> Making analyze_data() quiet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html"><i class="fa fa-check"></i><b>11</b> Analyzing the multifactor experiment</a>
<ul>
<li class="chapter" data-level="11.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#bundling"><i class="fa fa-check"></i><b>11.1</b> Bundling</a></li>
<li class="chapter" data-level="11.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#aggregation"><i class="fa fa-check"></i><b>11.2</b> Aggregation</a></li>
<li class="chapter" data-level="11.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#regression-summarization"><i class="fa fa-check"></i><b>11.3</b> Regression Summarization</a></li>
<li class="chapter" data-level="11.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focus-on-subset-kick-rest-to-supplement"><i class="fa fa-check"></i><b>11.4</b> Focus on subset, kick rest to supplement</a></li>
<li class="chapter" data-level="11.5" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#analyzing-results-when-some-trials-have-failed"><i class="fa fa-check"></i><b>11.5</b> Analyzing results when some trials have failed</a></li>
<li class="chapter" data-level="11.6" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#a-demonstration-of-visualization"><i class="fa fa-check"></i><b>11.6</b> A demonstration of visualization</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#the-initial-analysis"><i class="fa fa-check"></i><b>11.6.1</b> The initial analysis</a></li>
<li class="chapter" data-level="11.6.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focusing-on-validity"><i class="fa fa-check"></i><b>11.6.2</b> Focusing on validity</a></li>
<li class="chapter" data-level="11.6.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#looking-at-main-effects"><i class="fa fa-check"></i><b>11.6.3</b> Looking at main effects</a></li>
<li class="chapter" data-level="11.6.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#recap"><i class="fa fa-check"></i><b>11.6.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#exercises-4"><i class="fa fa-check"></i><b>11.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html"><i class="fa fa-check"></i><b>12</b> Case study: Comparing different estimators</a>
<ul>
<li class="chapter" data-level="12.1" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-generating-process-1"><i class="fa fa-check"></i><b>12.1</b> The data generating process</a></li>
<li class="chapter" data-level="12.2" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-analysis-methods"><i class="fa fa-check"></i><b>12.2</b> The data analysis methods</a></li>
<li class="chapter" data-level="12.3" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-simulation-itself"><i class="fa fa-check"></i><b>12.3</b> The simulation itself</a></li>
<li class="chapter" data-level="12.4" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#calculating-performance-measures-for-all-our-estimators"><i class="fa fa-check"></i><b>12.4</b> Calculating performance measures for all our estimators</a></li>
<li class="chapter" data-level="12.5" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#improving-the-visualization-of-the-results"><i class="fa fa-check"></i><b>12.5</b> Improving the visualization of the results</a></li>
<li class="chapter" data-level="12.6" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#extension-the-bias-variance-tradeoff"><i class="fa fa-check"></i><b>12.6</b> Extension: The Bias-variance tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html"><i class="fa fa-check"></i><b>13</b> Presentation of simulation results</a>
<ul>
<li class="chapter" data-level="13.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#tabulation"><i class="fa fa-check"></i><b>13.1</b> Tabulation</a></li>
<li class="chapter" data-level="13.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#visualization"><i class="fa fa-check"></i><b>13.2</b> Visualization</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-1-biserial-correlation-estimation"><i class="fa fa-check"></i><b>13.2.1</b> Example 1: Biserial correlation estimation</a></li>
<li class="chapter" data-level="13.2.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-2-variance-estimation-and-meta-regression"><i class="fa fa-check"></i><b>13.2.2</b> Example 2: Variance estimation and Meta-regression</a></li>
<li class="chapter" data-level="13.2.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-heat-maps-of-coverage"><i class="fa fa-check"></i><b>13.2.3</b> Example: Heat maps of coverage</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#modeling"><i class="fa fa-check"></i><b>13.3</b> Modeling</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sec_reproducability.html"><a href="sec_reproducability.html"><i class="fa fa-check"></i><b>14</b> Ensuring reproducibility</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sec_reproducability.html"><a href="sec_reproducability.html#seeds-and-pseudo-random-number-generators"><i class="fa fa-check"></i><b>14.1</b> Seeds and pseudo-random number generators</a></li>
<li class="chapter" data-level="14.2" data-path="sec_reproducability.html"><a href="sec_reproducability.html#including-seed-in-our-simulation-driver"><i class="fa fa-check"></i><b>14.2</b> Including seed in our simulation driver</a></li>
<li class="chapter" data-level="14.3" data-path="sec_reproducability.html"><a href="sec_reproducability.html#reasons-for-setting-the-seed"><i class="fa fa-check"></i><b>14.3</b> Reasons for setting the seed</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="optimize_code.html"><a href="optimize_code.html"><i class="fa fa-check"></i><b>15</b> Optimizing code (and why you often shouldn’t)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="optimize_code.html"><a href="optimize_code.html#hand-building-functions"><i class="fa fa-check"></i><b>15.1</b> Hand-building functions</a></li>
<li class="chapter" data-level="15.2" data-path="optimize_code.html"><a href="optimize_code.html#sec_comp_efficiency"><i class="fa fa-check"></i><b>15.2</b> Computational efficiency versus simplicity</a></li>
<li class="chapter" data-level="15.3" data-path="optimize_code.html"><a href="optimize_code.html#reusing-code-to-speed-up-computation"><i class="fa fa-check"></i><b>15.3</b> Reusing code to speed up computation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html"><i class="fa fa-check"></i><b>16</b> Error trapping and other headaches</a>
<ul>
<li class="chapter" data-level="16.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#safe_code"><i class="fa fa-check"></i><b>16.1</b> Safe code</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#what-to-do-with-warnings"><i class="fa fa-check"></i><b>16.1.1</b> What to do with warnings</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#about_stopifnot"><i class="fa fa-check"></i><b>16.2</b> Protecting your functions with “stop”</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="saving_files.html"><a href="saving_files.html"><i class="fa fa-check"></i><b>17</b> Saving files and results</a>
<ul>
<li class="chapter" data-level="17.1" data-path="saving_files.html"><a href="saving_files.html#saving-simulations-in-general"><i class="fa fa-check"></i><b>17.1</b> Saving simulations in general</a></li>
<li class="chapter" data-level="17.2" data-path="saving_files.html"><a href="saving_files.html#saving-simulations-as-you-go"><i class="fa fa-check"></i><b>17.2</b> Saving simulations as you go</a></li>
<li class="chapter" data-level="17.3" data-path="saving_files.html"><a href="saving_files.html#dynamically-making-directories"><i class="fa fa-check"></i><b>17.3</b> Dynamically making directories</a></li>
<li class="chapter" data-level="17.4" data-path="saving_files.html"><a href="saving_files.html#loading-and-combining-files-of-simulation-results"><i class="fa fa-check"></i><b>17.4</b> Loading and combining files of simulation results</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="on_functions.html"><a href="on_functions.html"><i class="fa fa-check"></i><b>18</b> Coding tidbits</a>
<ul>
<li class="chapter" data-level="18.1" data-path="on_functions.html"><a href="on_functions.html#repeating_oneself"><i class="fa fa-check"></i><b>18.1</b> Ways of repeating yourself</a></li>
<li class="chapter" data-level="18.2" data-path="on_functions.html"><a href="on_functions.html#default_arguments"><i class="fa fa-check"></i><b>18.2</b> Default arguments for functions</a></li>
<li class="chapter" data-level="18.3" data-path="on_functions.html"><a href="on_functions.html#testing-and-debugging-code-in-your-scripts"><i class="fa fa-check"></i><b>18.3</b> Testing and debugging code in your scripts</a></li>
<li class="chapter" data-level="18.4" data-path="on_functions.html"><a href="on_functions.html#keep-multiple-files-of-code"><i class="fa fa-check"></i><b>18.4</b> Keep multiple files of code</a></li>
<li class="chapter" data-level="18.5" data-path="on_functions.html"><a href="on_functions.html#the-source-command-and-keeping-things-organized"><i class="fa fa-check"></i><b>18.5</b> The source command and keeping things organized</a></li>
<li class="chapter" data-level="18.6" data-path="on_functions.html"><a href="on_functions.html#debugging-with-browser"><i class="fa fa-check"></i><b>18.6</b> Debugging with browser</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="parallel-processing.html"><a href="parallel-processing.html"><i class="fa fa-check"></i><b>19</b> Parallel Processing</a>
<ul>
<li class="chapter" data-level="19.1" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-on-your-computer"><i class="fa fa-check"></i><b>19.1</b> Parallel on your computer</a></li>
<li class="chapter" data-level="19.2" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-off-your-computer"><i class="fa fa-check"></i><b>19.2</b> Parallel off your computer</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="parallel-processing.html"><a href="parallel-processing.html#what-is-a-command-line-interface"><i class="fa fa-check"></i><b>19.2.1</b> What is a command-line interface?</a></li>
<li class="chapter" data-level="19.2.2" data-path="parallel-processing.html"><a href="parallel-processing.html#running-a-job-on-a-cluster"><i class="fa fa-check"></i><b>19.2.2</b> Running a job on a cluster</a></li>
<li class="chapter" data-level="19.2.3" data-path="parallel-processing.html"><a href="parallel-processing.html#checking-on-a-job"><i class="fa fa-check"></i><b>19.2.3</b> Checking on a job</a></li>
<li class="chapter" data-level="19.2.4" data-path="parallel-processing.html"><a href="parallel-processing.html#running-lots-of-jobs-on-a-cluster"><i class="fa fa-check"></i><b>19.2.4</b> Running lots of jobs on a cluster</a></li>
<li class="chapter" data-level="19.2.5" data-path="parallel-processing.html"><a href="parallel-processing.html#resources-for-harvards-odyssey"><i class="fa fa-check"></i><b>19.2.5</b> Resources for Harvard’s Odyssey</a></li>
<li class="chapter" data-level="19.2.6" data-path="parallel-processing.html"><a href="parallel-processing.html#acknowledgements-1"><i class="fa fa-check"></i><b>19.2.6</b> Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html"><i class="fa fa-check"></i><b>20</b> Using simulation as a power calculator</a>
<ul>
<li class="chapter" data-level="20.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#getting-design-parameters-from-pilot-data"><i class="fa fa-check"></i><b>20.1</b> Getting design parameters from pilot data</a></li>
<li class="chapter" data-level="20.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#the-data-generating-process-2"><i class="fa fa-check"></i><b>20.2</b> The data generating process</a></li>
<li class="chapter" data-level="20.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#running-the-simulation-1"><i class="fa fa-check"></i><b>20.3</b> Running the simulation</a></li>
<li class="chapter" data-level="20.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#evaluating-power"><i class="fa fa-check"></i><b>20.4</b> Evaluating power</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#checking-validity-of-our-models"><i class="fa fa-check"></i><b>20.4.1</b> Checking validity of our models</a></li>
<li class="chapter" data-level="20.4.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-precision-se"><i class="fa fa-check"></i><b>20.4.2</b> Assessing Precision (SE)</a></li>
<li class="chapter" data-level="20.4.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-power"><i class="fa fa-check"></i><b>20.4.3</b> Assessing power</a></li>
<li class="chapter" data-level="20.4.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-minimum-detectable-effects"><i class="fa fa-check"></i><b>20.4.4</b> Assessing Minimum Detectable Effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html"><i class="fa fa-check"></i><b>21</b> Simulation under the Potential Outcomes Framework</a>
<ul>
<li class="chapter" data-level="21.1" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#finite-vs.-superpopulation-inference"><i class="fa fa-check"></i><b>21.1</b> Finite vs. Superpopulation inference</a></li>
<li class="chapter" data-level="21.2" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#data-generation-processes-for-potential-outcomes"><i class="fa fa-check"></i><b>21.2</b> Data generation processes for potential outcomes</a></li>
<li class="chapter" data-level="21.3" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#finite-sample-performance-measures"><i class="fa fa-check"></i><b>21.3</b> Finite sample performance measures</a></li>
<li class="chapter" data-level="21.4" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#nested-finite-simulation-procedure"><i class="fa fa-check"></i><b>21.4</b> Nested finite simulation procedure</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html"><i class="fa fa-check"></i><b>22</b> Simulations as evidence</a>
<ul>
<li class="chapter" data-level="22.1" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#use-extensive-multi-factor-simulations"><i class="fa fa-check"></i><b>22.1</b> Use extensive multi-factor simulations</a></li>
<li class="chapter" data-level="22.2" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#beat-them-at-their-own-game"><i class="fa fa-check"></i><b>22.2</b> Beat them at their own game</a></li>
<li class="chapter" data-level="22.3" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#calibrated-simulations"><i class="fa fa-check"></i><b>22.3</b> Calibrated simulations</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>23</b> The Parametric bootstrap</a>
<ul>
<li class="chapter" data-level="23.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#air-conditioners-a-stolen-case-study"><i class="fa fa-check"></i><b>23.1</b> Air conditioners: a stolen case study</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="further-readings-and-resources.html"><a href="further-readings-and-resources.html"><i class="fa fa-check"></i><b>24</b> Further readings and resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Designing Monte Carlo Simulations in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimation-procedures" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Estimation procedures<a href="estimation-procedures.html#estimation-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the abstract, a function that implements an estimation procedure should have the following form:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="estimation-procedures.html#cb104-1" aria-hidden="true" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb104-2"><a href="estimation-procedures.html#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="estimation-procedures.html#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculations/model-fitting/estimation procedures</span></span>
<span id="cb104-4"><a href="estimation-procedures.html#cb104-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-5"><a href="estimation-procedures.html#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(estimates)</span>
<span id="cb104-6"><a href="estimation-procedures.html#cb104-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The function takes a set of data as input, fits a model or otherwise calculates an estimate, possibly with associated standard errors and so forth, and produces as output these estimates.
In principle, you should be able to run your function on real data as well as simulated.</p>
<p>The estimates could be point-estimates of parameters, standard errors, confidence intervals, etc.
Depending on the research question, this function might involve a combination of several procedures (e.g., a diagnostic test for heteroskedasticity, followed by the conventional formula or heteroskedasticity-robust formula for standard errors).
Also depending on the research question, we might need to create <em>several</em> functions that implement different estimation procedures to be compared.</p>
<p>In Chapter <span class="citation">(<a href="#ref-case_ANOVA" role="doc-biblioref"><strong>case_ANOVA?</strong></a>)</span>, for example, we saw different functions for some of the methods Brown and Forsythe considered for heteroskedastic ANOVA.
We re-print them here, taking full advantage of our digital-bookness:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="estimation-procedures.html#cb105-1" aria-hidden="true" tabindex="-1"></a>ANOVA_F <span class="ot">&lt;-</span> <span class="cf">function</span>(sim_data) {</span>
<span id="cb105-2"><a href="estimation-procedures.html#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="estimation-procedures.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">with</span>(sim_data, <span class="fu">tapply</span>(x, group, mean))</span>
<span id="cb105-4"><a href="estimation-procedures.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  s_sq <span class="ot">&lt;-</span> <span class="fu">with</span>(sim_data, <span class="fu">tapply</span>(x, group, var))</span>
<span id="cb105-5"><a href="estimation-procedures.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">table</span>(sim_data<span class="sc">$</span>group)</span>
<span id="cb105-6"><a href="estimation-procedures.html#cb105-6" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">length</span>(x_bar)</span>
<span id="cb105-7"><a href="estimation-procedures.html#cb105-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-8"><a href="estimation-procedures.html#cb105-8" aria-hidden="true" tabindex="-1"></a>  df1 <span class="ot">&lt;-</span> g <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb105-9"><a href="estimation-procedures.html#cb105-9" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(n) <span class="sc">-</span> g</span>
<span id="cb105-10"><a href="estimation-procedures.html#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="estimation-procedures.html#cb105-11" aria-hidden="true" tabindex="-1"></a>  msbtw <span class="ot">&lt;-</span> <span class="fu">sum</span>(n <span class="sc">*</span> (x_bar <span class="sc">-</span> <span class="fu">mean</span>(sim_data<span class="sc">$</span>x))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> df1</span>
<span id="cb105-12"><a href="estimation-procedures.html#cb105-12" aria-hidden="true" tabindex="-1"></a>  mswn <span class="ot">&lt;-</span> <span class="fu">sum</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> s_sq) <span class="sc">/</span> df2</span>
<span id="cb105-13"><a href="estimation-procedures.html#cb105-13" aria-hidden="true" tabindex="-1"></a>  fstat <span class="ot">&lt;-</span> msbtw <span class="sc">/</span> mswn</span>
<span id="cb105-14"><a href="estimation-procedures.html#cb105-14" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">&lt;-</span> <span class="fu">pf</span>(fstat, df1, df2, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb105-15"><a href="estimation-procedures.html#cb105-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-16"><a href="estimation-procedures.html#cb105-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pval)</span>
<span id="cb105-17"><a href="estimation-procedures.html#cb105-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-18"><a href="estimation-procedures.html#cb105-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-19"><a href="estimation-procedures.html#cb105-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-20"><a href="estimation-procedures.html#cb105-20" aria-hidden="true" tabindex="-1"></a>Welch_F <span class="ot">&lt;-</span> <span class="cf">function</span>(sim_data) {</span>
<span id="cb105-21"><a href="estimation-procedures.html#cb105-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-22"><a href="estimation-procedures.html#cb105-22" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">with</span>(sim_data, <span class="fu">tapply</span>(x, group, mean))</span>
<span id="cb105-23"><a href="estimation-procedures.html#cb105-23" aria-hidden="true" tabindex="-1"></a>  s_sq <span class="ot">&lt;-</span> <span class="fu">with</span>(sim_data, <span class="fu">tapply</span>(x, group, var))</span>
<span id="cb105-24"><a href="estimation-procedures.html#cb105-24" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">table</span>(sim_data<span class="sc">$</span>group)</span>
<span id="cb105-25"><a href="estimation-procedures.html#cb105-25" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">length</span>(x_bar)</span>
<span id="cb105-26"><a href="estimation-procedures.html#cb105-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-27"><a href="estimation-procedures.html#cb105-27" aria-hidden="true" tabindex="-1"></a>  w <span class="ot">&lt;-</span> n <span class="sc">/</span> s_sq</span>
<span id="cb105-28"><a href="estimation-procedures.html#cb105-28" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">sum</span>(w)</span>
<span id="cb105-29"><a href="estimation-procedures.html#cb105-29" aria-hidden="true" tabindex="-1"></a>  x_tilde <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">*</span> x_bar) <span class="sc">/</span> u</span>
<span id="cb105-30"><a href="estimation-procedures.html#cb105-30" aria-hidden="true" tabindex="-1"></a>  msbtw <span class="ot">&lt;-</span> <span class="fu">sum</span>(w <span class="sc">*</span> (x_bar <span class="sc">-</span> x_tilde)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (g <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb105-31"><a href="estimation-procedures.html#cb105-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-32"><a href="estimation-procedures.html#cb105-32" aria-hidden="true" tabindex="-1"></a>  G <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="dv">1</span> <span class="sc">-</span> w <span class="sc">/</span> u)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb105-33"><a href="estimation-procedures.html#cb105-33" aria-hidden="true" tabindex="-1"></a>  denom <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span>  G <span class="sc">*</span> <span class="dv">2</span> <span class="sc">*</span> (g <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> (g<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb105-34"><a href="estimation-procedures.html#cb105-34" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> msbtw <span class="sc">/</span> denom</span>
<span id="cb105-35"><a href="estimation-procedures.html#cb105-35" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> (g<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="dv">3</span> <span class="sc">*</span> G)</span>
<span id="cb105-36"><a href="estimation-procedures.html#cb105-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-37"><a href="estimation-procedures.html#cb105-37" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">&lt;-</span> <span class="fu">pf</span>(W, <span class="at">df1 =</span> g <span class="sc">-</span> <span class="dv">1</span>, <span class="at">df2 =</span> f, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb105-38"><a href="estimation-procedures.html#cb105-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-39"><a href="estimation-procedures.html#cb105-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pval)</span>
<span id="cb105-40"><a href="estimation-procedures.html#cb105-40" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="checking-the-estimation-function" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Checking the estimation function<a href="estimation-procedures.html#checking-the-estimation-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Just as with the data-generating function, it is important to verify the accuracy of the estimation functions. For the ANOVA-F test, this can be done simply by checking the result of our <code>ANOVA_F</code> against the built-in <code>oneway.test</code> function. Let’s do that with a fresh set of data:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="estimation-procedures.html#cb106-1" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">generate_data</span>(<span class="at">mu =</span> mu, <span class="at">sigma_sq =</span> sigma_sq,</span>
<span id="cb106-2"><a href="estimation-procedures.html#cb106-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sample_size =</span> sample_size)</span>
<span id="cb106-3"><a href="estimation-procedures.html#cb106-3" aria-hidden="true" tabindex="-1"></a>aov_results <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(x <span class="sc">~</span> <span class="fu">factor</span>(group), <span class="at">data =</span> sim_data, </span>
<span id="cb106-4"><a href="estimation-procedures.html#cb106-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb106-5"><a href="estimation-procedures.html#cb106-5" aria-hidden="true" tabindex="-1"></a>aov_results</span></code></pre></div>
<pre><code>## 
##  One-way analysis of means
## 
## data:  x and factor(group)
## F = 3.574, num df = 3, denom df = 11,
## p-value = 0.05048</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="estimation-procedures.html#cb108-1" aria-hidden="true" tabindex="-1"></a>F_results <span class="ot">&lt;-</span> <span class="fu">ANOVA_F</span>(sim_data)</span>
<span id="cb108-2"><a href="estimation-procedures.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(aov_results<span class="sc">$</span>p.value, F_results)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>We use <code>all.equal()</code> because it will check equality up to a tolerance in R, which can avoid some weird floating point errors due to rounding in R.</p>
<p>We can follow the same approach to check the results of the Welch test because it is also implemented in <code>oneway.test</code>:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="estimation-procedures.html#cb110-1" aria-hidden="true" tabindex="-1"></a>aov_results <span class="ot">&lt;-</span> <span class="fu">oneway.test</span>(x <span class="sc">~</span> <span class="fu">factor</span>(group),</span>
<span id="cb110-2"><a href="estimation-procedures.html#cb110-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> sim_data, </span>
<span id="cb110-3"><a href="estimation-procedures.html#cb110-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-4"><a href="estimation-procedures.html#cb110-4" aria-hidden="true" tabindex="-1"></a>aov_results</span></code></pre></div>
<pre><code>## 
##  One-way analysis of means (not assuming
##  equal variances)
## 
## data:  x and factor(group)
## F = 7.7855, num df = 3.0000, denom df =
## 3.0976, p-value = 0.05967</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="estimation-procedures.html#cb112-1" aria-hidden="true" tabindex="-1"></a>Welch_results <span class="ot">&lt;-</span> <span class="fu">Welch_F</span>(sim_data)</span>
<span id="cb112-2"><a href="estimation-procedures.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(aov_results<span class="sc">$</span>p.value, Welch_results)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>See <span class="citation">(<a href="#ref-sec_comp_efficiency" role="doc-biblioref"><strong>sec_comp_efficiency?</strong></a>)</span> for a bit more on checking functions, and a side-note about transparency in the writing of papers.</p>
</div>
<div id="checking-via-simulation" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Checking via simulation<a href="estimation-procedures.html#checking-via-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If your estimation procedure truly is new, how would you check it?
Well, one obvious answer is simulation!</p>
<p>In principle, for large samples and data generated under the assumptions required by your new procedure, you should have a fairly good sense that it should work and how it should work.
It is often the case that as you design your simulation, and then start analyzing the results, you will find your estimators are really not working as planned.</p>
<p>This will usually be due to (at least) three factors: you didn’t implement your method correctly, your method is not yet a good idea in the first place, and you don’t understand something important about how your method works.
You can then debug your code, revise your method, and do some serious thinking to eventually end up with a deeper understanding of method that is a better idea in general, and correctly implemented in all likelihood.</p>
<p>For example, in one research project Luke and other co-authors was working on a way to improve Instrumental Variable (IV) estimation using post-stratification.
The idea is to group units based on a covariate that predicts compliance status, and then estimate within each group; hopefully this would improve overall estimation.</p>
<p>In the first simulation, the estimates were full of NAs and odd results because we failed to properly account for what happens when the number of compliers was estimated to be zero.
That was table stakes: after repairing that, we still found odd behavior and serious and unexpected bias, which turned out to be due to failing to implement the averaging of the groups step correctly.
We fixed the estimator again and re-ran, and found that even when we had a variable that was almost perfectly predictive of compliance, gains were still surprisingly minimal.
Eventually we understood that the groups with very few compliers were will so unstable that they ruined the overall estimate.
These results inspired us to introduce other estimators that dropped or down-weighted these strata, which gave our paper a deeper purpose and contribution.</p>
<p>Simulation is an iterative process.
It is to help you, the researcher, learn about your estimators so you can find a way forward with your work.
What you learn then feeds back to the prior research, and you have a cycle that you eventually step off of, if you want to finish your paper.
But do not expect it to be a single, well-defined, trajectory.</p>
</div>
<div id="multiple-estimation-procedures" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Multiple estimation procedures<a href="estimation-procedures.html#multiple-estimation-procedures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In <span class="citation">(<a href="#ref-chap_DGP" role="doc-biblioref"><strong>chap_DGP?</strong></a>)</span> (<span class="citation">(<a href="#ref-case_cluster" role="doc-biblioref"><strong>case_cluster?</strong></a>)</span>) we introduced a case study of evaluating different procedures for estimating treatment impacts in a cluster randomized trial.
As a point of design, we recommend writing different functions for each estimation method one is planning on evaluating. This makes it easier to plug into play different methods as desired, and also helps generate a code base that is flexible and useful for other purposes.
It also, continuing our usual mantra, makes debugging easier: you can focus attention on one thing at a time, and worry less about how errors in one area might propagate to others.</p>
<p>For the cluster RCT context, we use two libraries, the <code>lme4</code> package (for multilevel modeling), the <code>arm</code> package (which gives us nice access to standard errors, with <code>se.fixef()</code>), and <code>lmerTest</code> (which gives us <span class="math inline">\(p\)</span>-values for multilevel modeling).
We also need the <code>estimatr</code> package to get robust SEs with <code>lm_robust</code>.
This use of different packages for different estimators is quite typical: in many simulations, many of the estimation approaches being considered are usually taken from the literature, and if you’re lucky this means you can simply use a package that implements those methods.</p>
<p>We load our libraries at the top of our code:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="estimation-procedures.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( lme4 )</span>
<span id="cb114-2"><a href="estimation-procedures.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( arm )</span>
<span id="cb114-3"><a href="estimation-procedures.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( lmerTest )</span>
<span id="cb114-4"><a href="estimation-procedures.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( estimatr )</span></code></pre></div>
<p>Our three analysis functions are then Multilevel Regression (MLM):</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="estimation-procedures.html#cb115-1" aria-hidden="true" tabindex="-1"></a>analysis_MLM <span class="ot">&lt;-</span> <span class="cf">function</span>( dat ) {</span>
<span id="cb115-2"><a href="estimation-procedures.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  M1 <span class="ot">=</span> <span class="fu">lmer</span>( Yobs <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Z <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>sid),</span>
<span id="cb115-3"><a href="estimation-procedures.html#cb115-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>dat )</span>
<span id="cb115-4"><a href="estimation-procedures.html#cb115-4" aria-hidden="true" tabindex="-1"></a>  est <span class="ot">=</span> <span class="fu">fixef</span>( M1 )[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb115-5"><a href="estimation-procedures.html#cb115-5" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">=</span> <span class="fu">se.fixef</span>( M1 )[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb115-6"><a href="estimation-procedures.html#cb115-6" aria-hidden="true" tabindex="-1"></a>  pv <span class="ot">=</span> <span class="fu">summary</span>(M1)<span class="sc">$</span>coefficients[<span class="st">&quot;Z&quot;</span>,<span class="dv">5</span>]</span>
<span id="cb115-7"><a href="estimation-procedures.html#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>( <span class="at">ATE_hat =</span> est, <span class="at">SE_hat =</span> se, <span class="at">p_value =</span> pv )</span>
<span id="cb115-8"><a href="estimation-procedures.html#cb115-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Linear Regression with Cluster-Robust Standard Errors (LM):</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="estimation-procedures.html#cb116-1" aria-hidden="true" tabindex="-1"></a>analysis_OLS <span class="ot">&lt;-</span> <span class="cf">function</span>( dat ) {</span>
<span id="cb116-2"><a href="estimation-procedures.html#cb116-2" aria-hidden="true" tabindex="-1"></a>  M2 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>( Yobs <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Z, </span>
<span id="cb116-3"><a href="estimation-procedures.html#cb116-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>dat, <span class="at">clusters=</span>sid )</span>
<span id="cb116-4"><a href="estimation-procedures.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  est <span class="ot">&lt;-</span> M2<span class="sc">$</span>coefficients[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb116-5"><a href="estimation-procedures.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  se  <span class="ot">&lt;-</span> M2<span class="sc">$</span>std.error[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb116-6"><a href="estimation-procedures.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  pv <span class="ot">&lt;-</span> M2<span class="sc">$</span>p.value[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb116-7"><a href="estimation-procedures.html#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>( <span class="at">ATE_hat =</span> est, <span class="at">SE_hat =</span> se, <span class="at">p_value =</span> pv )</span>
<span id="cb116-8"><a href="estimation-procedures.html#cb116-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>and Aggregate data (Agg):</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="estimation-procedures.html#cb117-1" aria-hidden="true" tabindex="-1"></a>analysis_agg <span class="ot">&lt;-</span> <span class="cf">function</span>( dat ) {</span>
<span id="cb117-2"><a href="estimation-procedures.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  datagg <span class="ot">&lt;-</span> </span>
<span id="cb117-3"><a href="estimation-procedures.html#cb117-3" aria-hidden="true" tabindex="-1"></a>    dat <span class="sc">%&gt;%</span> </span>
<span id="cb117-4"><a href="estimation-procedures.html#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>( sid, Z ) <span class="sc">%&gt;%</span></span>
<span id="cb117-5"><a href="estimation-procedures.html#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>( </span>
<span id="cb117-6"><a href="estimation-procedures.html#cb117-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">Ybar =</span> <span class="fu">mean</span>( Yobs ),</span>
<span id="cb117-7"><a href="estimation-procedures.html#cb117-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">n =</span> <span class="fu">n</span>() </span>
<span id="cb117-8"><a href="estimation-procedures.html#cb117-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb117-9"><a href="estimation-procedures.html#cb117-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-10"><a href="estimation-procedures.html#cb117-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>( <span class="fu">nrow</span>( datagg ) <span class="sc">==</span> <span class="fu">length</span>(<span class="fu">unique</span>(dat<span class="sc">$</span>sid) ) )</span>
<span id="cb117-11"><a href="estimation-procedures.html#cb117-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-12"><a href="estimation-procedures.html#cb117-12" aria-hidden="true" tabindex="-1"></a>  M3 <span class="ot">&lt;-</span> <span class="fu">lm_robust</span>( Ybar <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Z, </span>
<span id="cb117-13"><a href="estimation-procedures.html#cb117-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data=</span>datagg, <span class="at">se_type =</span> <span class="st">&quot;HC2&quot;</span> )</span>
<span id="cb117-14"><a href="estimation-procedures.html#cb117-14" aria-hidden="true" tabindex="-1"></a>  est <span class="ot">&lt;-</span> M3<span class="sc">$</span>coefficients[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb117-15"><a href="estimation-procedures.html#cb117-15" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> M3<span class="sc">$</span>std.error[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb117-16"><a href="estimation-procedures.html#cb117-16" aria-hidden="true" tabindex="-1"></a>  pv <span class="ot">&lt;-</span> M3<span class="sc">$</span>p.value[[<span class="st">&quot;Z&quot;</span>]]</span>
<span id="cb117-17"><a href="estimation-procedures.html#cb117-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>( <span class="at">ATE_hat =</span> est, <span class="at">SE_hat =</span> se, <span class="at">p_value =</span> pv )</span>
<span id="cb117-18"><a href="estimation-procedures.html#cb117-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Note the <code>stopifnot</code> command: putting <em>assert statements</em> in your code like this is a good way to guarantee you are not introducing weird and hard-to-track errors in your code.
For example, R likes to recycle vectors to make them the right length; if you gave it a wrong length in error, this can be a brutal error to discover.
These statements halt your code as soon as something goes wrong, rather than letting that initial wrongness flow on to further work, showing up in odd results that you don’t understand later on.
See Section <span class="citation">(<a href="#ref-about_stopifnot" role="doc-biblioref"><strong>about_stopifnot?</strong></a>)</span> for more.</p>
<p>Finally, we write a single function that puts all these together:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="estimation-procedures.html#cb118-1" aria-hidden="true" tabindex="-1"></a>analyze_data <span class="ot">=</span> <span class="cf">function</span>( dat ) {</span>
<span id="cb118-2"><a href="estimation-procedures.html#cb118-2" aria-hidden="true" tabindex="-1"></a>  MLM <span class="ot">=</span> <span class="fu">analysis_MLM</span>( dat )</span>
<span id="cb118-3"><a href="estimation-procedures.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  LR <span class="ot">=</span> <span class="fu">analysis_OLS</span>( dat )</span>
<span id="cb118-4"><a href="estimation-procedures.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  Agg <span class="ot">=</span> <span class="fu">analysis_agg</span>( dat )</span>
<span id="cb118-5"><a href="estimation-procedures.html#cb118-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-6"><a href="estimation-procedures.html#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>( <span class="at">MLM =</span> MLM, <span class="at">LR =</span> LR, <span class="at">Agg =</span> Agg,</span>
<span id="cb118-7"><a href="estimation-procedures.html#cb118-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">.id =</span> <span class="st">&quot;method&quot;</span> )</span>
<span id="cb118-8"><a href="estimation-procedures.html#cb118-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>When we pass a dataset to it, we get a nice table of results that we can evaluate:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="estimation-procedures.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">analyze_data</span>( dat )</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<pre><code>## # A tibble: 3 × 4
##   method ATE_hat SE_hat p_value
##   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1 MLM       1.55  0.758  0.0706
## 2 LR        1.55  0.130  0.0529
## 3 Agg       1.63  0.150  0.0583</code></pre>
<p>Each method for analysis is a single line. We record estimated impact, estimated standard error, and a nominal p-value.
Note how the <code>bind_rows()</code> method can take naming on the fly, and give us a column of <code>method</code>, which will be very useful to keep track of what estimated what.
We intentionally wrap up our results with a data frame to make later processing of data with the tidyverse package much easier.</p>
</div>
<div id="exercises-1" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Exercises<a href="estimation-procedures.html#exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="more-welch-and-adding-the-bff-test" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> More Welch and adding the BFF test<a href="estimation-procedures.html#more-welch-and-adding-the-bff-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s continue to explore and tweak the simulation code we’ve developed to replicate the results of Brown and Forsythe (1974).
Below is the key functions for the data-generating process (taken from the prior chapter).
The estimation procedures are above.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="estimation-procedures.html#cb122-1" aria-hidden="true" tabindex="-1"></a>generate_data <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma_sq, sample_size) {</span>
<span id="cb122-2"><a href="estimation-procedures.html#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="estimation-procedures.html#cb122-3" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">sum</span>(sample_size) </span>
<span id="cb122-4"><a href="estimation-procedures.html#cb122-4" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">length</span>(sample_size) </span>
<span id="cb122-5"><a href="estimation-procedures.html#cb122-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-6"><a href="estimation-procedures.html#cb122-6" aria-hidden="true" tabindex="-1"></a>  group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>g, <span class="at">times =</span> sample_size) </span>
<span id="cb122-7"><a href="estimation-procedures.html#cb122-7" aria-hidden="true" tabindex="-1"></a>  mu_long <span class="ot">&lt;-</span> <span class="fu">rep</span>(mu, <span class="at">times =</span> sample_size)</span>
<span id="cb122-8"><a href="estimation-procedures.html#cb122-8" aria-hidden="true" tabindex="-1"></a>  sigma_long <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">sqrt</span>(sigma_sq), <span class="at">times =</span> sample_size) </span>
<span id="cb122-9"><a href="estimation-procedures.html#cb122-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb122-10"><a href="estimation-procedures.html#cb122-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> mu_long, <span class="at">sd =</span> sigma_long)</span>
<span id="cb122-11"><a href="estimation-procedures.html#cb122-11" aria-hidden="true" tabindex="-1"></a>  sim_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> group, <span class="at">x =</span> x)</span>
<span id="cb122-12"><a href="estimation-procedures.html#cb122-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-13"><a href="estimation-procedures.html#cb122-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sim_data)</span>
<span id="cb122-14"><a href="estimation-procedures.html#cb122-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Write a function that implements the Brown-Forsythe F*-test (the BFF* test!) as described on p. 130 of Brown and Forsythe (1974).
Call it on a sample dataset to check it.</p></li>
<li><p>Now incorporate the function into the <code>one_run()</code> function from the previous question, and use it to estimate rejection rates of the BFF* test for the parameter values in the fifth line of Table 1 of Brown and Forsythe (1974).</p></li>
</ol>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="estimation-procedures.html#cb123-1" aria-hidden="true" tabindex="-1"></a>BF_F <span class="ot">&lt;-</span> <span class="cf">function</span>(x_bar, s_sq, n, g) {</span>
<span id="cb123-2"><a href="estimation-procedures.html#cb123-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-3"><a href="estimation-procedures.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fill in the guts here</span></span>
<span id="cb123-4"><a href="estimation-procedures.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-5"><a href="estimation-procedures.html#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="at">pval =</span> pval)</span>
<span id="cb123-6"><a href="estimation-procedures.html#cb123-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb123-7"><a href="estimation-procedures.html#cb123-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-8"><a href="estimation-procedures.html#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Further R code here</span></span></code></pre></div>
</div>
<div id="more-estimators-for-the-crt" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> More estimators for the CRT<a href="estimation-procedures.html#more-estimators-for-the-crt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol start="3" style="list-style-type: decimal">
<li>Sometimes you might want to consider two versions of an estimator. For example, in our cluster RCT code above we are using robust standard errors for the linear model estimator. Say we also want to include naive standard error estimates that we get out of the <code>lm</code> call.</li>
</ol>
<p>Extend the <code>OLS</code> call to be</p>
<pre><code>analysis_OLS &lt;- function( dat, robustSE = TRUE ) {</code></pre>
<p>and have the code inside calculate SEs based on the flag. Then modify the <code>analyze_data()</code> to include both approaches (you will have to call <code>analysis_OLS</code> twice).</p>
<p>Note that, efficiency-wise, this might not be ideal, but clarity-wise it might be considered helpful. Articulate two reasons for this design choice, and articulate two reasons for instead having the <code>analysis_OLS</code> method generate both standard errors internally in a single call.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap_DGP.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="performance-criteria.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jepusto/Designing-Simulations-in-R/edit/master/030-Estimation-procedures.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Designing-Simulations-in-R.pdf", "Designing-Simulations-in-R.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
