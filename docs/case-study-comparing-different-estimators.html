<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Case study: Comparing different estimators | Designing Monte Carlo Simulations in R</title>
  <meta name="description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Case study: Comparing different estimators | Designing Monte Carlo Simulations in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="github-repo" content="jepusto/Designing-Simulations-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Case study: Comparing different estimators | Designing Monte Carlo Simulations in R" />
  
  <meta name="twitter:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  

<meta name="author" content="Luke W. Miratrix and James E. Pustejovsky (Equal authors)" />


<meta name="date" content="2023-11-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analyzing-the-multifactor-experiment.html"/>
<link rel="next" href="presentation-of-simulation-results.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Designing Simulations in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#some-of-simulations-many-uses"><i class="fa fa-check"></i><b>1.1</b> Some of simulation’s many uses</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#comparing-statistical-approaches"><i class="fa fa-check"></i><b>1.1.1</b> Comparing statistical approaches</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#assessing-performance-of-complex-pipelines"><i class="fa fa-check"></i><b>1.1.2</b> Assessing performance of complex pipelines</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#assessing-performance-under-misspecification"><i class="fa fa-check"></i><b>1.1.3</b> Assessing performance under misspecification</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#assessing-the-finite-sample-performance-of-a-statistical-approach"><i class="fa fa-check"></i><b>1.1.4</b> Assessing the finite sample performance of a statistical approach</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#conducting-power-analyses"><i class="fa fa-check"></i><b>1.1.5</b> Conducting Power Analyses</a></li>
<li class="chapter" data-level="1.1.6" data-path="introduction.html"><a href="introduction.html#simulating-processess"><i class="fa fa-check"></i><b>1.1.6</b> Simulating processess</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-perils-of-simulation-as-evidence"><i class="fa fa-check"></i><b>1.2</b> The perils of simulation as evidence</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#why-r-and-rstudio"><i class="fa fa-check"></i><b>1.3</b> Why R and RStudio?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#templates-vs.-patterns"><i class="fa fa-check"></i><b>1.3.1</b> Templates vs. Patterns</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#the-tidyverse-and-a-recommended-text"><i class="fa fa-check"></i><b>1.3.2</b> The tidyverse and a recommended text</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#functions"><i class="fa fa-check"></i><b>1.3.3</b> Functions</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#a-dangerous-function"><i class="fa fa-check"></i><b>1.3.4</b> A dangerous function</a></li>
<li class="chapter" data-level="1.3.5" data-path="introduction.html"><a href="introduction.html#function-skeletons"><i class="fa fa-check"></i><b>1.3.5</b> Function skeletons</a></li>
<li class="chapter" data-level="1.3.6" data-path="introduction.html"><a href="introduction.html#pipe-dreams"><i class="fa fa-check"></i><b>1.3.6</b> <code>%&gt;%</code> (Pipe) dreams</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html"><i class="fa fa-check"></i><b>2</b> An initial simulation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulation-for-a-single-scenario"><i class="fa fa-check"></i><b>2.1</b> Simulation for a single scenario</a></li>
<li class="chapter" data-level="2.2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulating-across-different-scenarios"><i class="fa fa-check"></i><b>2.2</b> Simulating across different scenarios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html"><i class="fa fa-check"></i><b>3</b> Structure of a simulation study</a>
<ul>
<li class="chapter" data-level="3.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#general-structure-of-a-simulation"><i class="fa fa-check"></i><b>3.1</b> General structure of a simulation</a></li>
<li class="chapter" data-level="3.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#tidy-simulations"><i class="fa fa-check"></i><b>3.2</b> Tidy simulations</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#the-data-generating-process-dgp"><i class="fa fa-check"></i><b>3.2.1</b> The Data Generating Process (DGP)</a></li>
<li class="chapter" data-level="3.2.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#estimation-methods"><i class="fa fa-check"></i><b>3.2.2</b> Estimation methods</a></li>
<li class="chapter" data-level="3.2.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#repetition"><i class="fa fa-check"></i><b>3.2.3</b> Repetition</a></li>
<li class="chapter" data-level="3.2.4" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#performance-summaries"><i class="fa fa-check"></i><b>3.2.4</b> Performance summaries</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#multiple-scenarios"><i class="fa fa-check"></i><b>3.3</b> Multiple Scenarios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="case_ANOVA.html"><a href="case_ANOVA.html"><i class="fa fa-check"></i><b>4</b> Case Study: Heteroskedastic ANOVA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="case_ANOVA.html"><a href="case_ANOVA.html#the-data-generating-model"><i class="fa fa-check"></i><b>4.1</b> The data-generating model</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="case_ANOVA.html"><a href="case_ANOVA.html#coding-remark"><i class="fa fa-check"></i><b>4.1.1</b> Coding remark</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="case_ANOVA.html"><a href="case_ANOVA.html#the-estimation-procedures"><i class="fa fa-check"></i><b>4.2</b> The estimation procedures</a></li>
<li class="chapter" data-level="4.3" data-path="case_ANOVA.html"><a href="case_ANOVA.html#running-the-simulation"><i class="fa fa-check"></i><b>4.3</b> Running the simulation</a></li>
<li class="chapter" data-level="4.4" data-path="case_ANOVA.html"><a href="case_ANOVA.html#analyzing-the-simulation"><i class="fa fa-check"></i><b>4.4</b> Analyzing the Simulation</a></li>
<li class="chapter" data-level="4.5" data-path="case_ANOVA.html"><a href="case_ANOVA.html#exAnovaExercises"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap_DGP.html"><a href="chap_DGP.html"><i class="fa fa-check"></i><b>5</b> Data-generating models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap_DGP.html"><a href="chap_DGP.html#a-statistical-model-is-a-recipe-for-data-generation"><i class="fa fa-check"></i><b>5.1</b> A statistical model is a recipe for data generation</a></li>
<li class="chapter" data-level="5.2" data-path="chap_DGP.html"><a href="chap_DGP.html#checking-the-data-generating-function"><i class="fa fa-check"></i><b>5.2</b> Checking the data-generating function</a></li>
<li class="chapter" data-level="5.3" data-path="chap_DGP.html"><a href="chap_DGP.html#case_cluster"><i class="fa fa-check"></i><b>5.3</b> Example: Simulating clustered data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chap_DGP.html"><a href="chap_DGP.html#a-design-decision-what-do-we-want-to-manipulate"><i class="fa fa-check"></i><b>5.3.1</b> A design decision: What do we want to manipulate?</a></li>
<li class="chapter" data-level="5.3.2" data-path="chap_DGP.html"><a href="chap_DGP.html#a-model-for-a-cluster-rct"><i class="fa fa-check"></i><b>5.3.2</b> A model for a cluster RCT</a></li>
<li class="chapter" data-level="5.3.3" data-path="chap_DGP.html"><a href="chap_DGP.html#converting-our-model-to-code"><i class="fa fa-check"></i><b>5.3.3</b> Converting our model to code</a></li>
<li class="chapter" data-level="5.3.4" data-path="chap_DGP.html"><a href="chap_DGP.html#standardization-in-a-data-generating-process"><i class="fa fa-check"></i><b>5.3.4</b> Standardization in a data generating process</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap_DGP.html"><a href="chap_DGP.html#exercises"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chap_DGP.html"><a href="chap_DGP.html#ex_dgp"><i class="fa fa-check"></i><b>5.4.1</b> The Shifted-and-scaled t distribution</a></li>
<li class="chapter" data-level="5.4.2" data-path="chap_DGP.html"><a href="chap_DGP.html#the-cluster-rct-dgp"><i class="fa fa-check"></i><b>5.4.2</b> The Cluster RCT DGP</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimation-procedures.html"><a href="estimation-procedures.html"><i class="fa fa-check"></i><b>6</b> Estimation procedures</a>
<ul>
<li class="chapter" data-level="6.1" data-path="estimation-procedures.html"><a href="estimation-procedures.html#checking-the-estimation-function"><i class="fa fa-check"></i><b>6.1</b> Checking the estimation function</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-procedures.html"><a href="estimation-procedures.html#checking-via-simulation"><i class="fa fa-check"></i><b>6.2</b> Checking via simulation</a></li>
<li class="chapter" data-level="6.3" data-path="estimation-procedures.html"><a href="estimation-procedures.html#multiple-estimation-procedures"><i class="fa fa-check"></i><b>6.3</b> Multiple estimation procedures</a></li>
<li class="chapter" data-level="6.4" data-path="estimation-procedures.html"><a href="estimation-procedures.html#exercises-1"><i class="fa fa-check"></i><b>6.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="estimation-procedures.html"><a href="estimation-procedures.html#more-welch-and-adding-the-bff-test"><i class="fa fa-check"></i><b>6.4.1</b> More Welch and adding the BFF test</a></li>
<li class="chapter" data-level="6.4.2" data-path="estimation-procedures.html"><a href="estimation-procedures.html#more-estimators-for-the-crt"><i class="fa fa-check"></i><b>6.4.2</b> More estimators for the CRT</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="performance-criteria.html"><a href="performance-criteria.html"><i class="fa fa-check"></i><b>7</b> Performance criteria</a>
<ul>
<li class="chapter" data-level="7.1" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-vs.-estimation"><i class="fa fa-check"></i><b>7.1</b> Inference vs. Estimation</a></li>
<li class="chapter" data-level="7.2" data-path="performance-criteria.html"><a href="performance-criteria.html#comparing-estimators"><i class="fa fa-check"></i><b>7.2</b> Comparing estimators</a></li>
<li class="chapter" data-level="7.3" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-point-estimator"><i class="fa fa-check"></i><b>7.3</b> Assessing a point estimator</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="performance-criteria.html"><a href="performance-criteria.html#example-on-our-cluster-rct"><i class="fa fa-check"></i><b>7.3.1</b> Example on our Cluster RCT</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-standard-error-estimator"><i class="fa fa-check"></i><b>7.4</b> Assessing a standard error estimator</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="performance-criteria.html"><a href="performance-criteria.html#why-not-assess-the-estimate-se-directly"><i class="fa fa-check"></i><b>7.4.1</b> Why not assess the estimate SE directly?</a></li>
<li class="chapter" data-level="7.4.2" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-ses-for-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>7.4.2</b> Assessing SEs for our Cluster RCT simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-an-inferential-procedure"><i class="fa fa-check"></i><b>7.5</b> Assessing an inferential procedure</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="performance-criteria.html"><a href="performance-criteria.html#validity"><i class="fa fa-check"></i><b>7.5.1</b> Validity</a></li>
<li class="chapter" data-level="7.5.2" data-path="performance-criteria.html"><a href="performance-criteria.html#power"><i class="fa fa-check"></i><b>7.5.2</b> Power</a></li>
<li class="chapter" data-level="7.5.3" data-path="performance-criteria.html"><a href="performance-criteria.html#the-rejection-rate"><i class="fa fa-check"></i><b>7.5.3</b> The Rejection Rate</a></li>
<li class="chapter" data-level="7.5.4" data-path="performance-criteria.html"><a href="performance-criteria.html#our-cluster-rct-simulation"><i class="fa fa-check"></i><b>7.5.4</b> Our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-confidence-intervals"><i class="fa fa-check"></i><b>7.6</b> Assessing confidence intervals</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="performance-criteria.html"><a href="performance-criteria.html#clusters-with-confidence"><i class="fa fa-check"></i><b>7.6.1</b> Clusters with Confidence</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="performance-criteria.html"><a href="performance-criteria.html#further-measures-of-performance"><i class="fa fa-check"></i><b>7.7</b> Further measures of performance</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="performance-criteria.html"><a href="performance-criteria.html#sec_relative_performance"><i class="fa fa-check"></i><b>7.7.1</b> Relative vs. Absolute Criteria</a></li>
<li class="chapter" data-level="7.7.2" data-path="performance-criteria.html"><a href="performance-criteria.html#robust-measures-of-performance"><i class="fa fa-check"></i><b>7.7.2</b> Robust measures of performance</a></li>
<li class="chapter" data-level="7.7.3" data-path="performance-criteria.html"><a href="performance-criteria.html#summary-of-peformance-measures"><i class="fa fa-check"></i><b>7.7.3</b> Summary of peformance measures</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="performance-criteria.html"><a href="performance-criteria.html#uncertainty-in-performance-estimates-the-mcse"><i class="fa fa-check"></i><b>7.8</b> Uncertainty in performance estimates (the MCSE)</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-for-variance-estimators"><i class="fa fa-check"></i><b>7.8.1</b> MCSE for variance estimators</a></li>
<li class="chapter" data-level="7.8.2" data-path="performance-criteria.html"><a href="performance-criteria.html#calculating-mcses-with-the-simhelpers-package"><i class="fa fa-check"></i><b>7.8.2</b> Calculating MCSEs with the simhelpers package</a></li>
<li class="chapter" data-level="7.8.3" data-path="performance-criteria.html"><a href="performance-criteria.html#cluster-rct-continued-do-we-have-enough-simulation-trials"><i class="fa fa-check"></i><b>7.8.3</b> Cluster RCT, continued: Do we have enough simulation trials?</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="performance-criteria.html"><a href="performance-criteria.html#exercises-2"><i class="fa fa-check"></i><b>7.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="case_Cronbach.html"><a href="case_Cronbach.html"><i class="fa fa-check"></i><b>8</b> Project: Cronbach Alpha</a>
<ul>
<li class="chapter" data-level="8.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#background"><i class="fa fa-check"></i><b>8.1</b> Background</a></li>
<li class="chapter" data-level="8.2" data-path="case_Cronbach.html"><a href="case_Cronbach.html#getting-started"><i class="fa fa-check"></i><b>8.2</b> Getting started</a></li>
<li class="chapter" data-level="8.3" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-data-generating-function"><i class="fa fa-check"></i><b>8.3</b> The data-generating function</a></li>
<li class="chapter" data-level="8.4" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-estimation-function"><i class="fa fa-check"></i><b>8.4</b> The estimation function</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercices-naive-confidence-intervals"><i class="fa fa-check"></i><b>8.4.1</b> Exercices (Naive confidence intervals)</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="case_Cronbach.html"><a href="case_Cronbach.html#estimator-performance"><i class="fa fa-check"></i><b>8.5</b> Estimator performance</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-calculating-performance"><i class="fa fa-check"></i><b>8.5.1</b> Exercises (Calculating Performance)</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="case_Cronbach.html"><a href="case_Cronbach.html#replication-and-the-simulation"><i class="fa fa-check"></i><b>8.6</b> Replication (and the simulation)</a></li>
<li class="chapter" data-level="8.7" data-path="case_Cronbach.html"><a href="case_Cronbach.html#extension-confidence-interval-coverage"><i class="fa fa-check"></i><b>8.7</b> Extension: Confidence interval coverage</a></li>
<li class="chapter" data-level="8.8" data-path="case_Cronbach.html"><a href="case_Cronbach.html#a-taste-of-multiple-scenarios"><i class="fa fa-check"></i><b>8.8</b> A taste of multiple scenarios</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-3"><i class="fa fa-check"></i><b>8.8.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html"><i class="fa fa-check"></i><b>9</b> Case study: Attrition in a simple randomized experiment</a>
<ul>
<li class="chapter" data-level="9.1" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#the-data-generating-process"><i class="fa fa-check"></i><b>9.1</b> The data generating process</a></li>
<li class="chapter" data-level="9.2" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#estimators"><i class="fa fa-check"></i><b>9.2</b> Estimators</a></li>
<li class="chapter" data-level="9.3" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#performance-criteria-1"><i class="fa fa-check"></i><b>9.3</b> Performance criteria</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="exp_design.html"><a href="exp_design.html"><i class="fa fa-check"></i><b>10</b> Designing the multifactor simulation experiment</a>
<ul>
<li class="chapter" data-level="10.1" data-path="exp_design.html"><a href="exp_design.html#choosing-parameter-combinations"><i class="fa fa-check"></i><b>10.1</b> Choosing parameter combinations</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="exp_design.html"><a href="exp_design.html#choosing-parameters-for-the-clustered-rct"><i class="fa fa-check"></i><b>10.1.1</b> Choosing parameters for the Clustered RCT</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="exp_design.html"><a href="exp_design.html#using-pmap-to-run-multifactor-simulations"><i class="fa fa-check"></i><b>10.2</b> Using pmap to run multifactor simulations</a></li>
<li class="chapter" data-level="10.3" data-path="exp_design.html"><a href="exp_design.html#ways-of-repeating-oneself"><i class="fa fa-check"></i><b>10.3</b> Ways of repeating oneself</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="exp_design.html"><a href="exp_design.html#getting-raw-results-ready-for-analysis"><i class="fa fa-check"></i><b>10.3.1</b> Getting raw results ready for analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="exp_design.html"><a href="exp_design.html#running-the-cluster-rct-multifactor-experiment"><i class="fa fa-check"></i><b>10.4</b> Running the Cluster RCT multifactor experiment</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="exp_design.html"><a href="exp_design.html#making-analyze_data-quiet"><i class="fa fa-check"></i><b>10.4.1</b> Making analyze_data() quiet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html"><i class="fa fa-check"></i><b>11</b> Analyzing the multifactor experiment</a>
<ul>
<li class="chapter" data-level="11.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#bundling"><i class="fa fa-check"></i><b>11.1</b> Bundling</a></li>
<li class="chapter" data-level="11.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#aggregation"><i class="fa fa-check"></i><b>11.2</b> Aggregation</a></li>
<li class="chapter" data-level="11.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#regression-summarization"><i class="fa fa-check"></i><b>11.3</b> Regression Summarization</a></li>
<li class="chapter" data-level="11.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focus-on-subset-kick-rest-to-supplement"><i class="fa fa-check"></i><b>11.4</b> Focus on subset, kick rest to supplement</a></li>
<li class="chapter" data-level="11.5" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#analyzing-results-when-some-trials-have-failed"><i class="fa fa-check"></i><b>11.5</b> Analyzing results when some trials have failed</a></li>
<li class="chapter" data-level="11.6" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#a-demonstration-of-visualization"><i class="fa fa-check"></i><b>11.6</b> A demonstration of visualization</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#the-initial-analysis"><i class="fa fa-check"></i><b>11.6.1</b> The initial analysis</a></li>
<li class="chapter" data-level="11.6.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focusing-on-validity"><i class="fa fa-check"></i><b>11.6.2</b> Focusing on validity</a></li>
<li class="chapter" data-level="11.6.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#looking-at-main-effects"><i class="fa fa-check"></i><b>11.6.3</b> Looking at main effects</a></li>
<li class="chapter" data-level="11.6.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#recap"><i class="fa fa-check"></i><b>11.6.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#exercises-4"><i class="fa fa-check"></i><b>11.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html"><i class="fa fa-check"></i><b>12</b> Case study: Comparing different estimators</a>
<ul>
<li class="chapter" data-level="12.1" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-generating-process-1"><i class="fa fa-check"></i><b>12.1</b> The data generating process</a></li>
<li class="chapter" data-level="12.2" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-analysis-methods"><i class="fa fa-check"></i><b>12.2</b> The data analysis methods</a></li>
<li class="chapter" data-level="12.3" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-simulation-itself"><i class="fa fa-check"></i><b>12.3</b> The simulation itself</a></li>
<li class="chapter" data-level="12.4" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#calculating-performance-measures-for-all-our-estimators"><i class="fa fa-check"></i><b>12.4</b> Calculating performance measures for all our estimators</a></li>
<li class="chapter" data-level="12.5" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#improving-the-visualization-of-the-results"><i class="fa fa-check"></i><b>12.5</b> Improving the visualization of the results</a></li>
<li class="chapter" data-level="12.6" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#extension-the-bias-variance-tradeoff"><i class="fa fa-check"></i><b>12.6</b> Extension: The Bias-variance tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html"><i class="fa fa-check"></i><b>13</b> Presentation of simulation results</a>
<ul>
<li class="chapter" data-level="13.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#tabulation"><i class="fa fa-check"></i><b>13.1</b> Tabulation</a></li>
<li class="chapter" data-level="13.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#visualization"><i class="fa fa-check"></i><b>13.2</b> Visualization</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-1-biserial-correlation-estimation"><i class="fa fa-check"></i><b>13.2.1</b> Example 1: Biserial correlation estimation</a></li>
<li class="chapter" data-level="13.2.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-2-variance-estimation-and-meta-regression"><i class="fa fa-check"></i><b>13.2.2</b> Example 2: Variance estimation and Meta-regression</a></li>
<li class="chapter" data-level="13.2.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-heat-maps-of-coverage"><i class="fa fa-check"></i><b>13.2.3</b> Example: Heat maps of coverage</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#modeling"><i class="fa fa-check"></i><b>13.3</b> Modeling</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sec_reproducability.html"><a href="sec_reproducability.html"><i class="fa fa-check"></i><b>14</b> Ensuring reproducibility</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sec_reproducability.html"><a href="sec_reproducability.html#seeds-and-pseudo-random-number-generators"><i class="fa fa-check"></i><b>14.1</b> Seeds and pseudo-random number generators</a></li>
<li class="chapter" data-level="14.2" data-path="sec_reproducability.html"><a href="sec_reproducability.html#including-seed-in-our-simulation-driver"><i class="fa fa-check"></i><b>14.2</b> Including seed in our simulation driver</a></li>
<li class="chapter" data-level="14.3" data-path="sec_reproducability.html"><a href="sec_reproducability.html#reasons-for-setting-the-seed"><i class="fa fa-check"></i><b>14.3</b> Reasons for setting the seed</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="optimize_code.html"><a href="optimize_code.html"><i class="fa fa-check"></i><b>15</b> Optimizing code (and why you often shouldn’t)</a>
<ul>
<li class="chapter" data-level="15.1" data-path="optimize_code.html"><a href="optimize_code.html#hand-building-functions"><i class="fa fa-check"></i><b>15.1</b> Hand-building functions</a></li>
<li class="chapter" data-level="15.2" data-path="optimize_code.html"><a href="optimize_code.html#sec_comp_efficiency"><i class="fa fa-check"></i><b>15.2</b> Computational efficiency versus simplicity</a></li>
<li class="chapter" data-level="15.3" data-path="optimize_code.html"><a href="optimize_code.html#reusing-code-to-speed-up-computation"><i class="fa fa-check"></i><b>15.3</b> Reusing code to speed up computation</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html"><i class="fa fa-check"></i><b>16</b> Error trapping and other headaches</a>
<ul>
<li class="chapter" data-level="16.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#safe_code"><i class="fa fa-check"></i><b>16.1</b> Safe code</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#making-a-safe-function-call"><i class="fa fa-check"></i><b>16.1.1</b> Making a safe function call</a></li>
<li class="chapter" data-level="16.1.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#what-to-do-with-warnings-in-simulations"><i class="fa fa-check"></i><b>16.1.2</b> What to do with warnings in simulations</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#about_stopifnot"><i class="fa fa-check"></i><b>16.2</b> Protecting your functions with “stop”</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="saving_files.html"><a href="saving_files.html"><i class="fa fa-check"></i><b>17</b> Saving files and results</a>
<ul>
<li class="chapter" data-level="17.1" data-path="saving_files.html"><a href="saving_files.html#saving-simulations-in-general"><i class="fa fa-check"></i><b>17.1</b> Saving simulations in general</a></li>
<li class="chapter" data-level="17.2" data-path="saving_files.html"><a href="saving_files.html#saving-simulations-as-you-go"><i class="fa fa-check"></i><b>17.2</b> Saving simulations as you go</a></li>
<li class="chapter" data-level="17.3" data-path="saving_files.html"><a href="saving_files.html#dynamically-making-directories"><i class="fa fa-check"></i><b>17.3</b> Dynamically making directories</a></li>
<li class="chapter" data-level="17.4" data-path="saving_files.html"><a href="saving_files.html#loading-and-combining-files-of-simulation-results"><i class="fa fa-check"></i><b>17.4</b> Loading and combining files of simulation results</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="on_functions.html"><a href="on_functions.html"><i class="fa fa-check"></i><b>18</b> Coding tidbits</a>
<ul>
<li class="chapter" data-level="18.1" data-path="on_functions.html"><a href="on_functions.html#repeating_oneself"><i class="fa fa-check"></i><b>18.1</b> Ways of repeating yourself</a></li>
<li class="chapter" data-level="18.2" data-path="on_functions.html"><a href="on_functions.html#default_arguments"><i class="fa fa-check"></i><b>18.2</b> Default arguments for functions</a></li>
<li class="chapter" data-level="18.3" data-path="on_functions.html"><a href="on_functions.html#testing-and-debugging-code-in-your-scripts"><i class="fa fa-check"></i><b>18.3</b> Testing and debugging code in your scripts</a></li>
<li class="chapter" data-level="18.4" data-path="on_functions.html"><a href="on_functions.html#keep-multiple-files-of-code"><i class="fa fa-check"></i><b>18.4</b> Keep multiple files of code</a></li>
<li class="chapter" data-level="18.5" data-path="on_functions.html"><a href="on_functions.html#the-source-command-and-keeping-things-organized"><i class="fa fa-check"></i><b>18.5</b> The source command and keeping things organized</a></li>
<li class="chapter" data-level="18.6" data-path="on_functions.html"><a href="on_functions.html#debugging-with-browser"><i class="fa fa-check"></i><b>18.6</b> Debugging with browser</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="parallel-processing.html"><a href="parallel-processing.html"><i class="fa fa-check"></i><b>19</b> Parallel Processing</a>
<ul>
<li class="chapter" data-level="19.1" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-on-your-computer"><i class="fa fa-check"></i><b>19.1</b> Parallel on your computer</a></li>
<li class="chapter" data-level="19.2" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-off-your-computer"><i class="fa fa-check"></i><b>19.2</b> Parallel off your computer</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="parallel-processing.html"><a href="parallel-processing.html#what-is-a-command-line-interface"><i class="fa fa-check"></i><b>19.2.1</b> What is a command-line interface?</a></li>
<li class="chapter" data-level="19.2.2" data-path="parallel-processing.html"><a href="parallel-processing.html#running-a-job-on-a-cluster"><i class="fa fa-check"></i><b>19.2.2</b> Running a job on a cluster</a></li>
<li class="chapter" data-level="19.2.3" data-path="parallel-processing.html"><a href="parallel-processing.html#checking-on-a-job"><i class="fa fa-check"></i><b>19.2.3</b> Checking on a job</a></li>
<li class="chapter" data-level="19.2.4" data-path="parallel-processing.html"><a href="parallel-processing.html#running-lots-of-jobs-on-a-cluster"><i class="fa fa-check"></i><b>19.2.4</b> Running lots of jobs on a cluster</a></li>
<li class="chapter" data-level="19.2.5" data-path="parallel-processing.html"><a href="parallel-processing.html#resources-for-harvards-odyssey"><i class="fa fa-check"></i><b>19.2.5</b> Resources for Harvard’s Odyssey</a></li>
<li class="chapter" data-level="19.2.6" data-path="parallel-processing.html"><a href="parallel-processing.html#acknowledgements-1"><i class="fa fa-check"></i><b>19.2.6</b> Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html"><i class="fa fa-check"></i><b>20</b> Using simulation as a power calculator</a>
<ul>
<li class="chapter" data-level="20.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#getting-design-parameters-from-pilot-data"><i class="fa fa-check"></i><b>20.1</b> Getting design parameters from pilot data</a></li>
<li class="chapter" data-level="20.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#the-data-generating-process-2"><i class="fa fa-check"></i><b>20.2</b> The data generating process</a></li>
<li class="chapter" data-level="20.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#running-the-simulation-1"><i class="fa fa-check"></i><b>20.3</b> Running the simulation</a></li>
<li class="chapter" data-level="20.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#evaluating-power"><i class="fa fa-check"></i><b>20.4</b> Evaluating power</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#checking-validity-of-our-models"><i class="fa fa-check"></i><b>20.4.1</b> Checking validity of our models</a></li>
<li class="chapter" data-level="20.4.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-precision-se"><i class="fa fa-check"></i><b>20.4.2</b> Assessing Precision (SE)</a></li>
<li class="chapter" data-level="20.4.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-power"><i class="fa fa-check"></i><b>20.4.3</b> Assessing power</a></li>
<li class="chapter" data-level="20.4.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-minimum-detectable-effects"><i class="fa fa-check"></i><b>20.4.4</b> Assessing Minimum Detectable Effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html"><i class="fa fa-check"></i><b>21</b> Simulation under the Potential Outcomes Framework</a>
<ul>
<li class="chapter" data-level="21.1" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#finite-vs.-superpopulation-inference"><i class="fa fa-check"></i><b>21.1</b> Finite vs. Superpopulation inference</a></li>
<li class="chapter" data-level="21.2" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#data-generation-processes-for-potential-outcomes"><i class="fa fa-check"></i><b>21.2</b> Data generation processes for potential outcomes</a></li>
<li class="chapter" data-level="21.3" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#finite-sample-performance-measures"><i class="fa fa-check"></i><b>21.3</b> Finite sample performance measures</a></li>
<li class="chapter" data-level="21.4" data-path="simulation-under-the-potential-outcomes-framework.html"><a href="simulation-under-the-potential-outcomes-framework.html#nested-finite-simulation-procedure"><i class="fa fa-check"></i><b>21.4</b> Nested finite simulation procedure</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html"><i class="fa fa-check"></i><b>22</b> Simulations as evidence</a>
<ul>
<li class="chapter" data-level="22.1" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#use-extensive-multi-factor-simulations"><i class="fa fa-check"></i><b>22.1</b> Use extensive multi-factor simulations</a></li>
<li class="chapter" data-level="22.2" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#beat-them-at-their-own-game"><i class="fa fa-check"></i><b>22.2</b> Beat them at their own game</a></li>
<li class="chapter" data-level="22.3" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#calibrated-simulations"><i class="fa fa-check"></i><b>22.3</b> Calibrated simulations</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>23</b> The Parametric bootstrap</a>
<ul>
<li class="chapter" data-level="23.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#air-conditioners-a-stolen-case-study"><i class="fa fa-check"></i><b>23.1</b> Air conditioners: a stolen case study</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="further-readings-and-resources.html"><a href="further-readings-and-resources.html"><i class="fa fa-check"></i><b>24</b> Further readings and resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Designing Monte Carlo Simulations in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="case-study-comparing-different-estimators" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Case study: Comparing different estimators<a href="case-study-comparing-different-estimators.html#case-study-comparing-different-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Features of this case study</em>
- Calculating performance metrics by estimator using tidyverse.
- Visualization of simulation results.
- Construction of the classic Bias + SE + RMSE performance plot.</p>
<p>In this case study we examine a simulation where we wish to compare different forms of
estimator for estimating the same thing. We still generate data, evaluate it,
and see how well our evaluation works. The difference is we now evaluate it
multiple ways, storing how the different ways work.</p>
<p>For our simple working example we are going to compare estimation of the
center of a symmetric distribution via mean, trimmed mean, and median (so the
mean and median are the same). These are the three estimation strategies
that we might be comparing in a paper (pretend we have “invented” the trimmed
mean and want to demonstrate its utility).</p>
<p>We are, as usual, going to break building this simulation evaluation down into lots of
functions to show the general framework. This framework can readily be
extended to more complicated simulation studies.
This case study illustrates how methodologists might compare different strategies for estimation, and is
closest to what we might see in the “simulation” section of a stats paper.</p>
<div id="the-data-generating-process-1" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> The data generating process<a href="case-study-comparing-different-estimators.html#the-data-generating-process-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For our data-generation function we will use the scaled <span class="math inline">\(t\)</span>-distribution so
the standard deviation will always be 1 but we will have different fatness of
tails (high chance of outliers):</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="case-study-comparing-different-estimators.html#cb275-1" tabindex="-1"></a>gen.data <span class="ot">=</span> <span class="cf">function</span>( n, df0 ) {</span>
<span id="cb275-2"><a href="case-study-comparing-different-estimators.html#cb275-2" tabindex="-1"></a>    <span class="fu">rt</span>( n, <span class="at">df=</span>df0 ) <span class="sc">/</span> <span class="fu">sqrt</span>( df0 <span class="sc">/</span> (df0<span class="dv">-2</span>) )</span>
<span id="cb275-3"><a href="case-study-comparing-different-estimators.html#cb275-3" tabindex="-1"></a>}</span></code></pre></div>
<p>The variance of a <span class="math inline">\(t\)</span> is <span class="math inline">\(df/(df-2)\)</span>, so if we divide our observations by the
square root of this, we will standardize them so they have unit variance.
See, the standard deviation is 1 (up to random error, and as long as df0 &gt;
2)!:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="case-study-comparing-different-estimators.html#cb276-1" tabindex="-1"></a><span class="fu">sd</span>( <span class="fu">gen.data</span>( <span class="dv">100000</span>, <span class="at">df0 =</span> <span class="dv">3</span> ) )</span></code></pre></div>
<pre><code>## [1] 1.01542</code></pre>
<p>(Normally our data generation code would be a bit more fancy.)</p>
<p>We next define the parameter we want (in our case this is the mean, is what
we are trying to estimate):</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="case-study-comparing-different-estimators.html#cb278-1" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">0</span></span></code></pre></div>
</div>
<div id="the-data-analysis-methods" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> The data analysis methods<a href="case-study-comparing-different-estimators.html#the-data-analysis-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We then write a function that takes data and uses all our different
estimators on it. We return a data frame of the three estimates, with each
row being one of our estimators. This is useful if our estimators return an
estimate and a standard error, for example.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="case-study-comparing-different-estimators.html#cb279-1" tabindex="-1"></a>analyze.data <span class="ot">=</span> <span class="cf">function</span>( data ) {</span>
<span id="cb279-2"><a href="case-study-comparing-different-estimators.html#cb279-2" tabindex="-1"></a>    mn <span class="ot">=</span> <span class="fu">mean</span>( data )</span>
<span id="cb279-3"><a href="case-study-comparing-different-estimators.html#cb279-3" tabindex="-1"></a>    md <span class="ot">=</span> <span class="fu">median</span>( data )</span>
<span id="cb279-4"><a href="case-study-comparing-different-estimators.html#cb279-4" tabindex="-1"></a>    mn.tr <span class="ot">=</span> <span class="fu">mean</span>( data, <span class="at">trim=</span><span class="fl">0.1</span> )</span>
<span id="cb279-5"><a href="case-study-comparing-different-estimators.html#cb279-5" tabindex="-1"></a>    <span class="fu">data.frame</span>( <span class="at">estimator =</span> <span class="fu">c</span>( <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;trim.mean&quot;</span>, <span class="st">&quot;median&quot;</span> ),</span>
<span id="cb279-6"><a href="case-study-comparing-different-estimators.html#cb279-6" tabindex="-1"></a>                <span class="at">estimate =</span> <span class="fu">c</span>( mn, mn.tr, md ) )</span>
<span id="cb279-7"><a href="case-study-comparing-different-estimators.html#cb279-7" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s test:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="case-study-comparing-different-estimators.html#cb280-1" tabindex="-1"></a>dt <span class="ot">=</span> <span class="fu">gen.data</span>( <span class="dv">100</span>, <span class="dv">3</span> )</span>
<span id="cb280-2"><a href="case-study-comparing-different-estimators.html#cb280-2" tabindex="-1"></a><span class="fu">analyze.data</span>( dt )</span></code></pre></div>
<pre><code>##   estimator     estimate
## 1      mean -0.044891002
## 2 trim.mean  0.005257327
## 3    median  0.004890847</code></pre>
<p>Note that we have bundled our multiple methods into a single function.
With complex methods we generally advocate a separate function for each method, but sometimes for a target simulation having a host of methods wrapped in a single function is clean and tidy code.</p>
<p>Also note the three lines of output for our returned value.
This long-form output will make processing the simulation results easier.
That being said, returning in wide format is also completely legitimate.</p>
</div>
<div id="the-simulation-itself" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> The simulation itself<a href="case-study-comparing-different-estimators.html#the-simulation-itself" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To evaluate, do a bunch of times, and assess results. Let’s start by looking
at a specific case. We generate 1000 datasets of size 10, and estimate the
center using our three different estimators.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="case-study-comparing-different-estimators.html#cb282-1" tabindex="-1"></a>raw.exps <span class="ot">&lt;-</span> <span class="fu">replicate</span>( <span class="dv">1000</span>, {</span>
<span id="cb282-2"><a href="case-study-comparing-different-estimators.html#cb282-2" tabindex="-1"></a>    dt <span class="ot">=</span> <span class="fu">gen.data</span>( <span class="at">n=</span><span class="dv">10</span>, <span class="at">df0=</span><span class="dv">5</span> )</span>
<span id="cb282-3"><a href="case-study-comparing-different-estimators.html#cb282-3" tabindex="-1"></a>    <span class="fu">analyze.data</span>( dt )</span>
<span id="cb282-4"><a href="case-study-comparing-different-estimators.html#cb282-4" tabindex="-1"></a>}, <span class="at">simplify =</span> <span class="cn">FALSE</span> )</span>
<span id="cb282-5"><a href="case-study-comparing-different-estimators.html#cb282-5" tabindex="-1"></a>raw.exps <span class="ot">=</span> <span class="fu">bind_rows</span>( raw.exps, <span class="at">.id =</span> <span class="st">&quot;runID&quot;</span> )</span></code></pre></div>
<p>Note how our <code>.id</code> argument gives each simulation run an ID. This can be
useful to see how the estimators covary.</p>
<p>We now have 1000 estimates for each of our estimators:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="case-study-comparing-different-estimators.html#cb283-1" tabindex="-1"></a><span class="fu">head</span>( raw.exps )</span></code></pre></div>
<pre><code>##   runID estimator    estimate
## 1     1      mean -0.09919345
## 2     1 trim.mean -0.20887036
## 3     1    median -0.12237738
## 4     2      mean -0.19312165
## 5     2 trim.mean -0.22091715
## 6     2    median -0.18534152</code></pre>
</div>
<div id="calculating-performance-measures-for-all-our-estimators" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Calculating performance measures for all our estimators<a href="case-study-comparing-different-estimators.html#calculating-performance-measures-for-all-our-estimators" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We then want to assess estimator performance for each estimator.
We first write a function to calculate what we want from 1000 estimates:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="case-study-comparing-different-estimators.html#cb285-1" tabindex="-1"></a>estimator.quality <span class="ot">=</span> <span class="cf">function</span>( estimates, mu ) {</span>
<span id="cb285-2"><a href="case-study-comparing-different-estimators.html#cb285-2" tabindex="-1"></a>    RMSE <span class="ot">=</span> <span class="fu">sqrt</span>( <span class="fu">mean</span>( (estimates <span class="sc">-</span> mu)<span class="sc">^</span><span class="dv">2</span> ) )</span>
<span id="cb285-3"><a href="case-study-comparing-different-estimators.html#cb285-3" tabindex="-1"></a>    bias <span class="ot">=</span> <span class="fu">mean</span>( estimates <span class="sc">-</span> mu )</span>
<span id="cb285-4"><a href="case-study-comparing-different-estimators.html#cb285-4" tabindex="-1"></a>    SE <span class="ot">=</span> <span class="fu">sd</span>( estimates )</span>
<span id="cb285-5"><a href="case-study-comparing-different-estimators.html#cb285-5" tabindex="-1"></a>    <span class="fu">data.frame</span>( <span class="at">RMSE=</span>RMSE, <span class="at">bias=</span>bias, <span class="at">SE=</span>SE )</span>
<span id="cb285-6"><a href="case-study-comparing-different-estimators.html#cb285-6" tabindex="-1"></a>}</span></code></pre></div>
<p>The key is our function is estimation-method agnostic: we will use it for each of our three estimators.
Here we evaluate our ‘mean’ estimator:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="case-study-comparing-different-estimators.html#cb286-1" tabindex="-1"></a><span class="fu">filter</span>( raw.exps, estimator <span class="sc">==</span> <span class="st">&quot;mean&quot;</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb286-2"><a href="case-study-comparing-different-estimators.html#cb286-2" tabindex="-1"></a>    <span class="fu">pull</span>( estimate ) <span class="sc">%&gt;%</span></span>
<span id="cb286-3"><a href="case-study-comparing-different-estimators.html#cb286-3" tabindex="-1"></a>    <span class="fu">estimator.quality</span>( <span class="at">mu =</span> mu )</span></code></pre></div>
<pre><code>##        RMSE        bias        SE
## 1 0.3318663 -0.01079814 0.3318566</code></pre>
<p>Aside: Perhaps, code-wise, the above is piping having gone too far? If you don’t like this style, you can do
this:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="case-study-comparing-different-estimators.html#cb288-1" tabindex="-1"></a><span class="fu">estimator.quality</span>( raw.exps<span class="sc">$</span>estimate[ raw.exps<span class="sc">$</span>estimator<span class="sc">==</span><span class="st">&quot;mean&quot;</span>], mu )</span></code></pre></div>
<pre><code>##        RMSE        bias        SE
## 1 0.3318663 -0.01079814 0.3318566</code></pre>
<p>To do all our three estimators, we group by estimator and evaluate for each
estimator. In tidyverse 1.0 <code>summarise</code> can handle multiple responses, but they
will look a bit weird in our output, hence the ‘unpack()’ argument which
makes each column its own column (if we do not unpack, we have a “data frame
column” which is an odd thing).</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="case-study-comparing-different-estimators.html#cb290-1" tabindex="-1"></a>raw.exps <span class="sc">%&gt;%</span></span>
<span id="cb290-2"><a href="case-study-comparing-different-estimators.html#cb290-2" tabindex="-1"></a>    <span class="fu">group_by</span>( estimator ) <span class="sc">%&gt;%</span></span>
<span id="cb290-3"><a href="case-study-comparing-different-estimators.html#cb290-3" tabindex="-1"></a>    <span class="fu">summarise</span>( <span class="at">qual =</span> <span class="fu">estimator.quality</span>( estimate, <span class="at">mu =</span> <span class="dv">0</span> ) ) <span class="sc">%&gt;%</span></span>
<span id="cb290-4"><a href="case-study-comparing-different-estimators.html#cb290-4" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">unpack</span>( <span class="at">cols=</span><span class="fu">c</span>(qual) )</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   estimator  RMSE     bias    SE
##   &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
## 1 mean      0.332 -0.0108  0.332
## 2 median    0.331 -0.00855 0.331
## 3 trim.mean 0.311 -0.0105  0.311</code></pre>
<p>We then pack up the above into a function, as usual.
Our function takes our two parameters of sample size and degrees of freedom, and returns a data frame of results.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="case-study-comparing-different-estimators.html#cb292-1" tabindex="-1"></a>run.simulation <span class="ot">=</span> <span class="cf">function</span>( n, df0 ) {</span>
<span id="cb292-2"><a href="case-study-comparing-different-estimators.html#cb292-2" tabindex="-1"></a>    raw.exps <span class="ot">&lt;-</span> <span class="fu">replicate</span>( <span class="dv">1000</span>, {</span>
<span id="cb292-3"><a href="case-study-comparing-different-estimators.html#cb292-3" tabindex="-1"></a>        dt <span class="ot">=</span> <span class="fu">gen.data</span>( <span class="at">n=</span>n, <span class="at">df0=</span>df0 )</span>
<span id="cb292-4"><a href="case-study-comparing-different-estimators.html#cb292-4" tabindex="-1"></a>        <span class="fu">analyze.data</span>( dt )</span>
<span id="cb292-5"><a href="case-study-comparing-different-estimators.html#cb292-5" tabindex="-1"></a>    }, <span class="at">simplify =</span> <span class="cn">FALSE</span> )</span>
<span id="cb292-6"><a href="case-study-comparing-different-estimators.html#cb292-6" tabindex="-1"></a>    raw.exps <span class="ot">=</span> <span class="fu">bind_rows</span>( raw.exps, <span class="at">.id =</span> <span class="st">&quot;runID&quot;</span> )</span>
<span id="cb292-7"><a href="case-study-comparing-different-estimators.html#cb292-7" tabindex="-1"></a></span>
<span id="cb292-8"><a href="case-study-comparing-different-estimators.html#cb292-8" tabindex="-1"></a>    rs <span class="ot">&lt;-</span> raw.exps <span class="sc">%&gt;%</span></span>
<span id="cb292-9"><a href="case-study-comparing-different-estimators.html#cb292-9" tabindex="-1"></a>        <span class="fu">group_by</span>( estimator ) <span class="sc">%&gt;%</span></span>
<span id="cb292-10"><a href="case-study-comparing-different-estimators.html#cb292-10" tabindex="-1"></a>        <span class="fu">summarise</span>( <span class="at">qual =</span> <span class="fu">estimator.quality</span>( estimate, <span class="at">mu =</span> <span class="dv">0</span> ) ) <span class="sc">%&gt;%</span></span>
<span id="cb292-11"><a href="case-study-comparing-different-estimators.html#cb292-11" tabindex="-1"></a>        tidyr<span class="sc">::</span><span class="fu">unpack</span>( <span class="at">cols=</span><span class="fu">c</span>( qual ) )</span>
<span id="cb292-12"><a href="case-study-comparing-different-estimators.html#cb292-12" tabindex="-1"></a></span>
<span id="cb292-13"><a href="case-study-comparing-different-estimators.html#cb292-13" tabindex="-1"></a>    rs</span>
<span id="cb292-14"><a href="case-study-comparing-different-estimators.html#cb292-14" tabindex="-1"></a>}</span></code></pre></div>
<p>Our function will take our two parameters, run a simulation, and give us the
results. We see here that none of our estimators are particularly biased and
the trimmed mean has, possibly, the smallest RMSE, although it is a close
call.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="case-study-comparing-different-estimators.html#cb293-1" tabindex="-1"></a><span class="fu">run.simulation</span>( <span class="dv">10</span>, <span class="dv">5</span> )</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   estimator  RMSE    bias    SE
##   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 mean      0.318 0.0136  0.318
## 2 median    0.315 0.00888 0.315
## 3 trim.mean 0.294 0.0111  0.294</code></pre>
<p>Ok, now we want to see how sample size impacts our different estimators. If
we also vary degrees of freedom we have a <em>three</em>-factor experiment, where
one of the factors is our estimator itself. We are going to use a new clever
trick. As before, we use <code>pmap()</code>, but now we store the entire dataframe of
results we get back from our function in a new column of our original
dataframe. See R for DS, Chapter 25.3. This trick works best if we have
everything as a <code>tibble</code> which is basically a dataframe that prints a lot
nicer and doesn’t try to second-guess what you are up to all the time.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="case-study-comparing-different-estimators.html#cb295-1" tabindex="-1"></a>ns <span class="ot">=</span> <span class="fu">c</span>( <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">250</span>, <span class="dv">1250</span> )</span>
<span id="cb295-2"><a href="case-study-comparing-different-estimators.html#cb295-2" tabindex="-1"></a>dfs <span class="ot">=</span> <span class="fu">c</span>( <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">30</span> )</span>
<span id="cb295-3"><a href="case-study-comparing-different-estimators.html#cb295-3" tabindex="-1"></a>lvls <span class="ot">=</span> <span class="fu">expand_grid</span>( <span class="at">n=</span>ns, <span class="at">df=</span>dfs )</span>
<span id="cb295-4"><a href="case-study-comparing-different-estimators.html#cb295-4" tabindex="-1"></a></span>
<span id="cb295-5"><a href="case-study-comparing-different-estimators.html#cb295-5" tabindex="-1"></a><span class="co"># So it stores our dataframe results in our lvls data properly.</span></span>
<span id="cb295-6"><a href="case-study-comparing-different-estimators.html#cb295-6" tabindex="-1"></a>lvls <span class="ot">=</span> <span class="fu">as_tibble</span>(lvls)</span>
<span id="cb295-7"><a href="case-study-comparing-different-estimators.html#cb295-7" tabindex="-1"></a></span>
<span id="cb295-8"><a href="case-study-comparing-different-estimators.html#cb295-8" tabindex="-1"></a>results <span class="ot">&lt;-</span> lvls <span class="sc">%&gt;%</span> <span class="fu">mutate</span>( <span class="at">results =</span> <span class="fu">pmap</span>( lvls, run.simulation ) )</span></code></pre></div>
<p>We have stored our results (a bunch of dataframes) in our main matrix of
simulation runs.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="case-study-comparing-different-estimators.html#cb296-1" tabindex="-1"></a><span class="fu">print</span>( results, <span class="at">n=</span><span class="dv">4</span> )</span></code></pre></div>
<pre><code>## # A tibble: 16 × 3
##       n    df results         
##   &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;          
## 1    10     3 &lt;tibble [3 × 4]&gt;
## 2    10     5 &lt;tibble [3 × 4]&gt;
## 3    10    15 &lt;tibble [3 × 4]&gt;
## 4    10    30 &lt;tibble [3 × 4]&gt;
## # ℹ 12 more rows</code></pre>
<p>The <code>unnest()</code> function will stack up our dataframes, replicating the other columns in the main dataframe so it makes a nice rectangular dataset, all nice like. See (hard to read) R for DS Chapter 25.4.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="case-study-comparing-different-estimators.html#cb298-1" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">unnest</span>( results, <span class="at">cols=</span><span class="st">&quot;results&quot;</span> )</span>
<span id="cb298-2"><a href="case-study-comparing-different-estimators.html#cb298-2" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>## # A tibble: 48 × 6
##        n    df estimator  RMSE      bias    SE
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
##  1    10     3 mean      0.308 -0.00795  0.308
##  2    10     3 median    0.244 -0.00403  0.244
##  3    10     3 trim.mean 0.250 -0.00347  0.250
##  4    10     5 mean      0.321 -0.00142  0.322
##  5    10     5 median    0.315 -0.00763  0.315
##  6    10     5 trim.mean 0.294 -0.000161 0.294
##  7    10    15 mean      0.316 -0.00903  0.316
##  8    10    15 median    0.357  0.00890  0.357
##  9    10    15 trim.mean 0.316 -0.00138  0.316
## 10    10    30 mean      0.315 -0.00450  0.315
## # ℹ 38 more rows</code></pre>
<p>And plot:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="case-study-comparing-different-estimators.html#cb300-1" tabindex="-1"></a><span class="fu">ggplot</span>( results, <span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>RMSE, <span class="at">col=</span>estimator) ) <span class="sc">+</span></span>
<span id="cb300-2"><a href="case-study-comparing-different-estimators.html#cb300-2" tabindex="-1"></a>            <span class="fu">facet_wrap</span>( <span class="sc">~</span> df, <span class="at">nrow=</span><span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb300-3"><a href="case-study-comparing-different-estimators.html#cb300-3" tabindex="-1"></a>            <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb300-4"><a href="case-study-comparing-different-estimators.html#cb300-4" tabindex="-1"></a>            <span class="fu">scale_x_log10</span>( <span class="at">breaks=</span>ns )</span></code></pre></div>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-146-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="improving-the-visualization-of-the-results" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> Improving the visualization of the results<a href="case-study-comparing-different-estimators.html#improving-the-visualization-of-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The above doesn’t show differences clearly because all the RMSE goes to zero.
It helps to log our outcome, or otherwise rescale. The logging version shows
differences are relatively constant given changing sample size.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="case-study-comparing-different-estimators.html#cb301-1" tabindex="-1"></a><span class="fu">ggplot</span>( results, <span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>RMSE, <span class="at">col=</span>estimator) ) <span class="sc">+</span></span>
<span id="cb301-2"><a href="case-study-comparing-different-estimators.html#cb301-2" tabindex="-1"></a>    <span class="fu">facet_wrap</span>( <span class="sc">~</span> df, <span class="at">nrow=</span><span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb301-3"><a href="case-study-comparing-different-estimators.html#cb301-3" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb301-4"><a href="case-study-comparing-different-estimators.html#cb301-4" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>( <span class="at">breaks=</span>ns ) <span class="sc">+</span></span>
<span id="cb301-5"><a href="case-study-comparing-different-estimators.html#cb301-5" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>()</span></code></pre></div>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-147-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Better is to rescale using our knowledge of standard errors. If we scale by
the square root of sample size, we should get horizontal lines. We now
clearly see the trends.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="case-study-comparing-different-estimators.html#cb302-1" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">mutate</span>( results, <span class="at">scaleRMSE =</span> RMSE <span class="sc">*</span> <span class="fu">sqrt</span>(n) )</span></code></pre></div>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="case-study-comparing-different-estimators.html#cb303-1" tabindex="-1"></a><span class="fu">ggplot</span>( results, <span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>scaleRMSE, <span class="at">col=</span>estimator) ) <span class="sc">+</span></span>
<span id="cb303-2"><a href="case-study-comparing-different-estimators.html#cb303-2" tabindex="-1"></a>    <span class="fu">facet_wrap</span>( <span class="sc">~</span> df, <span class="at">nrow=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb303-3"><a href="case-study-comparing-different-estimators.html#cb303-3" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb303-4"><a href="case-study-comparing-different-estimators.html#cb303-4" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>( <span class="at">breaks=</span>ns )</span></code></pre></div>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-149-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Overall, we see the scaled error of the mean it is stable across the
different distributions. The trimmed mean is a real advantage when the
degrees of freedom are small. We are cropping outliers that destabilize our
estimate which leads to great wins. As the distribution grows more normal,
this is no longer an advantage and we get closer to the mean in terms of
performance. Here we are penalized slightly bye having dropped 10% of our
data, so the standard errors will be slightly larger.</p>
<p>The median is not able to take advantage of the nuances of a data set because
it is entirely determined by the middle value. When outliers cause real
concern, this cost is minimal. When outliers are not a concern, the median is
just worse.</p>
<p>Overall, the trimmed mean seems an excellent choice: in the presence of
outliers it is far more stable than the mean, and when there are no outliers
the cost of using it is small.</p>
<p>In terms of thinking about designing simulation studies, we see clear
visual displays of simulation results can tell very clear stories. Eschew
complicated tables with lots of numbers.</p>
</div>
<div id="extension-the-bias-variance-tradeoff" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Extension: The Bias-variance tradeoff<a href="case-study-comparing-different-estimators.html#extension-the-bias-variance-tradeoff" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can use the above simulation to examine these same estimators when we the
median is not the same as the mean. Say we want the mean of a distribution,
but have systematic outliers. If we just use the median, or trimmed mean, we
might have bias if the outliers tend to be on one side or another. For
example, consider the exponential distribution:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="case-study-comparing-different-estimators.html#cb304-1" tabindex="-1"></a>nums <span class="ot">=</span> <span class="fu">rexp</span>( <span class="dv">100000</span> )</span>
<span id="cb304-2"><a href="case-study-comparing-different-estimators.html#cb304-2" tabindex="-1"></a><span class="fu">mean</span>( nums )</span></code></pre></div>
<pre><code>## [1] 1.002233</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="case-study-comparing-different-estimators.html#cb306-1" tabindex="-1"></a><span class="fu">mean</span>( nums, <span class="at">trim=</span><span class="fl">0.1</span> )</span></code></pre></div>
<pre><code>## [1] 0.8323088</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="case-study-comparing-different-estimators.html#cb308-1" tabindex="-1"></a><span class="fu">median</span>( nums )</span></code></pre></div>
<pre><code>## [1] 0.6908992</code></pre>
<p>Our trimming, etc., is <em>biased</em> if we think of our goal as estimating the
mean. But if the trimmed estimators are much more stable, we might still
wish to use them. Let’s find out.</p>
<p>Let’s generate a mixture distribution, just for fun. It will have a nice
normal base with some extreme outliers. We will make sure the overall mean,
including the outliers, is always 1, however. (So our target, <span class="math inline">\(\mu\)</span> is now 1,
not 0.)</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="case-study-comparing-different-estimators.html#cb310-1" tabindex="-1"></a>gen.data.outliers <span class="ot">=</span> <span class="cf">function</span>( n, <span class="at">prob.outlier =</span> <span class="fl">0.05</span> ) {</span>
<span id="cb310-2"><a href="case-study-comparing-different-estimators.html#cb310-2" tabindex="-1"></a>    nN <span class="ot">=</span> <span class="fu">rbinom</span>( <span class="dv">1</span>, n, prob.outlier )</span>
<span id="cb310-3"><a href="case-study-comparing-different-estimators.html#cb310-3" tabindex="-1"></a>    nrm <span class="ot">=</span> <span class="fu">rnorm</span>( n <span class="sc">-</span> nN, <span class="at">mean=</span><span class="fl">0.5</span>, <span class="at">sd=</span><span class="dv">1</span> )</span>
<span id="cb310-4"><a href="case-study-comparing-different-estimators.html#cb310-4" tabindex="-1"></a>    outmean <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span><span class="sc">-</span>prob.outlier)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">/</span> prob.outlier</span>
<span id="cb310-5"><a href="case-study-comparing-different-estimators.html#cb310-5" tabindex="-1"></a>    outs <span class="ot">=</span> <span class="fu">rnorm</span>( nN, <span class="at">mean=</span>outmean, <span class="at">sd=</span><span class="dv">10</span> )</span>
<span id="cb310-6"><a href="case-study-comparing-different-estimators.html#cb310-6" tabindex="-1"></a>    <span class="fu">c</span>( nrm, outs )</span>
<span id="cb310-7"><a href="case-study-comparing-different-estimators.html#cb310-7" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s look at our distribution</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="case-study-comparing-different-estimators.html#cb311-1" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">gen.data.outliers</span>( <span class="dv">10000000</span>, <span class="at">prob.outlier =</span> <span class="fl">0.05</span> )</span>
<span id="cb311-2"><a href="case-study-comparing-different-estimators.html#cb311-2" tabindex="-1"></a><span class="fu">mean</span>( Y )</span></code></pre></div>
<pre><code>## [1] 1.000522</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="case-study-comparing-different-estimators.html#cb313-1" tabindex="-1"></a><span class="fu">sd</span>( Y )</span></code></pre></div>
<pre><code>## [1] 3.273068</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="case-study-comparing-different-estimators.html#cb315-1" tabindex="-1"></a><span class="fu">hist</span>( Y, <span class="at">breaks=</span><span class="dv">30</span>, <span class="at">col=</span><span class="st">&quot;grey&quot;</span>, <span class="at">prob=</span><span class="cn">TRUE</span> )</span></code></pre></div>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-152-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We steal the code from above, modifying it slightly for our new function and
changing our target parameter from 0 to 1:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="case-study-comparing-different-estimators.html#cb316-1" tabindex="-1"></a>run.simulation.exp <span class="ot">=</span> <span class="cf">function</span>( n ) {</span>
<span id="cb316-2"><a href="case-study-comparing-different-estimators.html#cb316-2" tabindex="-1"></a>    raw.exps <span class="ot">&lt;-</span> <span class="fu">replicate</span>( <span class="dv">1000</span>, {</span>
<span id="cb316-3"><a href="case-study-comparing-different-estimators.html#cb316-3" tabindex="-1"></a>        dt <span class="ot">=</span> <span class="fu">gen.data.outliers</span>( <span class="at">n=</span>n )</span>
<span id="cb316-4"><a href="case-study-comparing-different-estimators.html#cb316-4" tabindex="-1"></a>        <span class="fu">analyze.data</span>( dt )</span>
<span id="cb316-5"><a href="case-study-comparing-different-estimators.html#cb316-5" tabindex="-1"></a>    }, <span class="at">simplify =</span> <span class="cn">FALSE</span> )</span>
<span id="cb316-6"><a href="case-study-comparing-different-estimators.html#cb316-6" tabindex="-1"></a>    raw.exps <span class="ot">=</span> <span class="fu">bind_rows</span>( raw.exps, <span class="at">.id =</span> <span class="st">&quot;runID&quot;</span> )</span>
<span id="cb316-7"><a href="case-study-comparing-different-estimators.html#cb316-7" tabindex="-1"></a></span>
<span id="cb316-8"><a href="case-study-comparing-different-estimators.html#cb316-8" tabindex="-1"></a>    rs <span class="ot">&lt;-</span> raw.exps <span class="sc">%&gt;%</span></span>
<span id="cb316-9"><a href="case-study-comparing-different-estimators.html#cb316-9" tabindex="-1"></a>        <span class="fu">group_by</span>( estimator ) <span class="sc">%&gt;%</span></span>
<span id="cb316-10"><a href="case-study-comparing-different-estimators.html#cb316-10" tabindex="-1"></a>        <span class="fu">summarise</span>( <span class="at">qual =</span> <span class="fu">estimator.quality</span>( estimate, <span class="at">mu =</span> <span class="dv">1</span> ) ) <span class="sc">%&gt;%</span></span>
<span id="cb316-11"><a href="case-study-comparing-different-estimators.html#cb316-11" tabindex="-1"></a>        tidyr<span class="sc">::</span><span class="fu">unpack</span>( <span class="at">cols =</span> <span class="fu">c</span>( qual ) )</span>
<span id="cb316-12"><a href="case-study-comparing-different-estimators.html#cb316-12" tabindex="-1"></a></span>
<span id="cb316-13"><a href="case-study-comparing-different-estimators.html#cb316-13" tabindex="-1"></a>    rs</span>
<span id="cb316-14"><a href="case-study-comparing-different-estimators.html#cb316-14" tabindex="-1"></a>}</span>
<span id="cb316-15"><a href="case-study-comparing-different-estimators.html#cb316-15" tabindex="-1"></a></span>
<span id="cb316-16"><a href="case-study-comparing-different-estimators.html#cb316-16" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">run.simulation.exp</span>( <span class="dv">100</span> )</span>
<span id="cb316-17"><a href="case-study-comparing-different-estimators.html#cb316-17" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   estimator  RMSE     bias    SE
##   &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
## 1 mean      0.326 -0.00208 0.326
## 2 median    0.475 -0.457   0.130
## 3 trim.mean 0.455 -0.440   0.115</code></pre>
<p>And for our experiment we vary the sample size</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="case-study-comparing-different-estimators.html#cb318-1" tabindex="-1"></a>ns <span class="ot">=</span> <span class="fu">c</span>( <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">80</span>, <span class="dv">160</span>, <span class="dv">320</span> )</span>
<span id="cb318-2"><a href="case-study-comparing-different-estimators.html#cb318-2" tabindex="-1"></a>lvls <span class="ot">=</span> <span class="fu">tibble</span>( <span class="at">n=</span>ns )</span></code></pre></div>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="case-study-comparing-different-estimators.html#cb319-1" tabindex="-1"></a>results <span class="ot">&lt;-</span> lvls <span class="sc">%&gt;%</span> </span>
<span id="cb319-2"><a href="case-study-comparing-different-estimators.html#cb319-2" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">results =</span> <span class="fu">pmap</span>( lvls, run.simulation.exp ) ) <span class="sc">%&gt;%</span> </span>
<span id="cb319-3"><a href="case-study-comparing-different-estimators.html#cb319-3" tabindex="-1"></a>  <span class="fu">unnest</span>( <span class="at">cols =</span> <span class="fu">c</span>(results) )</span>
<span id="cb319-4"><a href="case-study-comparing-different-estimators.html#cb319-4" tabindex="-1"></a><span class="fu">head</span>( results )</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##       n estimator  RMSE      bias    SE
##   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1    10 mean      1.04  -0.0265   1.04 
## 2    10 median    0.593 -0.454    0.381
## 3    10 trim.mean 0.655 -0.381    0.533
## 4    20 mean      0.740 -0.000791 0.740
## 5    20 median    0.536 -0.454    0.285
## 6    20 trim.mean 0.518 -0.410    0.317</code></pre>
<p>Here we are going to plot multiple outcomes. Often with the simulation study
we are interested in different measures of performance. For us, we want to
know the standard error, bias, and overall error (RMSE). To plot this we
first gather our outcomes to make a long form dataframe of results:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="case-study-comparing-different-estimators.html#cb321-1" tabindex="-1"></a>res2 <span class="ot">=</span> <span class="fu">gather</span>( results, RMSE, bias, SE, <span class="at">key=</span><span class="st">&quot;Measure&quot;</span>,<span class="at">value=</span><span class="st">&quot;value&quot;</span> )</span>
<span id="cb321-2"><a href="case-study-comparing-different-estimators.html#cb321-2" tabindex="-1"></a>res2 <span class="ot">=</span> <span class="fu">mutate</span>( res2, <span class="at">Measure =</span> <span class="fu">factor</span>( Measure, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;SE&quot;</span>,<span class="st">&quot;bias&quot;</span>,<span class="st">&quot;RMSE&quot;</span> )))</span></code></pre></div>
<p>And then we plot, making a facet for each outcome of interest:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="case-study-comparing-different-estimators.html#cb322-1" tabindex="-1"></a><span class="fu">ggplot</span>( res2, <span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span>value, <span class="at">col=</span>estimator) ) <span class="sc">+</span></span>
<span id="cb322-2"><a href="case-study-comparing-different-estimators.html#cb322-2" tabindex="-1"></a>    <span class="fu">facet_grid</span>( . <span class="sc">~</span> Measure ) <span class="sc">+</span></span>
<span id="cb322-3"><a href="case-study-comparing-different-estimators.html#cb322-3" tabindex="-1"></a>    <span class="fu">geom_hline</span>( <span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">&quot;darkgrey&quot;</span> ) <span class="sc">+</span></span>
<span id="cb322-4"><a href="case-study-comparing-different-estimators.html#cb322-4" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb322-5"><a href="case-study-comparing-different-estimators.html#cb322-5" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>( <span class="at">breaks=</span>ns ) <span class="sc">+</span></span>
<span id="cb322-6"><a href="case-study-comparing-different-estimators.html#cb322-6" tabindex="-1"></a>    <span class="fu">labs</span>( <span class="at">y=</span><span class="st">&quot;&quot;</span> )</span></code></pre></div>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-156-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We see how different estimators have different biases and different
uncertainties. The bias is negative for our trimmed estimators because we
are losing the big outliers above and so getting answers that are too low.</p>
<p>The RMSE captures the trade-off in terms of what estimator gives the lowest
overall <em>error</em>. For this distribution, the mean wins as the sample size
increases because the bias basically stays the same and the SE drops. But
for smaller samples the trimming is superior. The median (essentially
trimming 50% above and below) is overkill and has too much negative bias.</p>
<p>From a simulation study point of view, notice how we are looking at three
different qualities of our estimators. Some people really care about bias,
some care about RMSE. By presenting all results we are transparent about how
the different estimators operate.</p>
<p>Next steps would be to also examine the associated estimated standard errors
for the estimators, seeing if these estimates of estimator uncertainty are
good or poor. This leads to investigation of coverage rates and similar.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analyzing-the-multifactor-experiment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="presentation-of-simulation-results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jepusto/Designing-Simulations-in-R/edit/master/072-case-study-comparing-estimators.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Designing-Simulations-in-R.pdf", "Designing-Simulations-in-R.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
