<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Introduction | Designing Monte Carlo Simulations in R</title>
  <meta name="description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Introduction | Designing Monte Carlo Simulations in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="github-repo" content="jepusto/Designing-Simulations-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Introduction | Designing Monte Carlo Simulations in R" />
  
  <meta name="twitter:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  

<meta name="author" content="Luke W. Miratrix and James E. Pustejovsky (Equal authors)" />


<meta name="date" content="2024-06-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="an-initial-simulation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Designing Simulations in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#some-of-simulations-many-uses"><i class="fa fa-check"></i><b>1.1</b> Some of simulation’s many uses</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#comparing-statistical-approaches"><i class="fa fa-check"></i><b>1.1.1</b> Comparing statistical approaches</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#assessing-performance-of-complex-pipelines"><i class="fa fa-check"></i><b>1.1.2</b> Assessing performance of complex pipelines</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#assessing-performance-under-misspecification"><i class="fa fa-check"></i><b>1.1.3</b> Assessing performance under misspecification</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#assessing-the-finite-sample-performance-of-a-statistical-approach"><i class="fa fa-check"></i><b>1.1.4</b> Assessing the finite sample performance of a statistical approach</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#conducting-power-analyses"><i class="fa fa-check"></i><b>1.1.5</b> Conducting Power Analyses</a></li>
<li class="chapter" data-level="1.1.6" data-path="introduction.html"><a href="introduction.html#simulating-processess"><i class="fa fa-check"></i><b>1.1.6</b> Simulating processess</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-perils-of-simulation-as-evidence"><i class="fa fa-check"></i><b>1.2</b> The perils of simulation as evidence</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#why-r-and-rstudio"><i class="fa fa-check"></i><b>1.3</b> Why R and RStudio?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#templates-vs.-patterns"><i class="fa fa-check"></i><b>1.3.1</b> Templates vs. Patterns</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#the-tidyverse-and-a-recommended-text"><i class="fa fa-check"></i><b>1.3.2</b> The tidyverse and a recommended text</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#functions"><i class="fa fa-check"></i><b>1.3.3</b> Functions</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#a-dangerous-function"><i class="fa fa-check"></i><b>1.3.4</b> A dangerous function</a></li>
<li class="chapter" data-level="1.3.5" data-path="introduction.html"><a href="introduction.html#function-skeletons"><i class="fa fa-check"></i><b>1.3.5</b> Function skeletons</a></li>
<li class="chapter" data-level="1.3.6" data-path="introduction.html"><a href="introduction.html#pipe-dreams"><i class="fa fa-check"></i><b>1.3.6</b> <code>%&gt;%</code> (Pipe) dreams</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html"><i class="fa fa-check"></i><b>2</b> An initial simulation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulation-for-a-single-scenario"><i class="fa fa-check"></i><b>2.1</b> Simulation for a single scenario</a></li>
<li class="chapter" data-level="2.2" data-path="an-initial-simulation.html"><a href="an-initial-simulation.html#simulating-across-different-scenarios"><i class="fa fa-check"></i><b>2.2</b> Simulating across different scenarios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html"><i class="fa fa-check"></i><b>3</b> Structure of a simulation study</a>
<ul>
<li class="chapter" data-level="3.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#general-structure-of-a-simulation"><i class="fa fa-check"></i><b>3.1</b> General structure of a simulation</a></li>
<li class="chapter" data-level="3.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#tidy-simulations"><i class="fa fa-check"></i><b>3.2</b> Tidy simulations</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#the-data-generating-process-dgp"><i class="fa fa-check"></i><b>3.2.1</b> The Data Generating Process (DGP)</a></li>
<li class="chapter" data-level="3.2.2" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#estimation-procedures"><i class="fa fa-check"></i><b>3.2.2</b> Estimation procedures</a></li>
<li class="chapter" data-level="3.2.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#repetition"><i class="fa fa-check"></i><b>3.2.3</b> Repetition</a></li>
<li class="chapter" data-level="3.2.4" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#performance-summaries"><i class="fa fa-check"></i><b>3.2.4</b> Performance summaries</a></li>
<li class="chapter" data-level="3.2.5" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#why-the-tidy-approach"><i class="fa fa-check"></i><b>3.2.5</b> Why the tidy approach?</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="structure-of-a-simulation-study.html"><a href="structure-of-a-simulation-study.html#multiple-scenarios"><i class="fa fa-check"></i><b>3.3</b> Multiple Scenarios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="case-ANOVA.html"><a href="case-ANOVA.html"><i class="fa fa-check"></i><b>4</b> Case Study: Heteroskedastic ANOVA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#the-data-generating-model"><i class="fa fa-check"></i><b>4.1</b> The data-generating model</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#coding-remark"><i class="fa fa-check"></i><b>4.1.1</b> Coding remark</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="case-ANOVA.html"><a href="case-ANOVA.html#the-estimation-procedures"><i class="fa fa-check"></i><b>4.2</b> The estimation procedures</a></li>
<li class="chapter" data-level="4.3" data-path="case-ANOVA.html"><a href="case-ANOVA.html#running-the-simulation"><i class="fa fa-check"></i><b>4.3</b> Running the simulation</a></li>
<li class="chapter" data-level="4.4" data-path="case-ANOVA.html"><a href="case-ANOVA.html#analyzing-the-simulation"><i class="fa fa-check"></i><b>4.4</b> Analyzing the Simulation</a></li>
<li class="chapter" data-level="4.5" data-path="case-ANOVA.html"><a href="case-ANOVA.html#exAnovaExercises"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap-DGP.html"><a href="chap-DGP.html"><i class="fa fa-check"></i><b>5</b> Data-Generating Processes (DGPs)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap-DGP.html"><a href="chap-DGP.html#a-statistical-model-is-a-recipe-for-data-generation"><i class="fa fa-check"></i><b>5.1</b> A statistical model is a recipe for data generation</a></li>
<li class="chapter" data-level="5.2" data-path="chap-DGP.html"><a href="chap-DGP.html#checking-the-data-generating-function"><i class="fa fa-check"></i><b>5.2</b> Checking the data-generating function</a></li>
<li class="chapter" data-level="5.3" data-path="chap-DGP.html"><a href="chap-DGP.html#case-cluster"><i class="fa fa-check"></i><b>5.3</b> Example: Simulating clustered data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chap-DGP.html"><a href="chap-DGP.html#a-design-decision-what-do-we-want-to-manipulate"><i class="fa fa-check"></i><b>5.3.1</b> A design decision: What do we want to manipulate?</a></li>
<li class="chapter" data-level="5.3.2" data-path="chap-DGP.html"><a href="chap-DGP.html#a-model-for-a-cluster-rct"><i class="fa fa-check"></i><b>5.3.2</b> A model for a cluster RCT</a></li>
<li class="chapter" data-level="5.3.3" data-path="chap-DGP.html"><a href="chap-DGP.html#converting-our-model-to-code"><i class="fa fa-check"></i><b>5.3.3</b> Converting our model to code</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap-DGP.html"><a href="chap-DGP.html#exercises"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chap-DGP.html"><a href="chap-DGP.html#ex_dgp"><i class="fa fa-check"></i><b>5.4.1</b> The Welch test on a shifted-and-scaled <span class="math inline">\(t\)</span> distribution</a></li>
<li class="chapter" data-level="5.4.2" data-path="chap-DGP.html"><a href="chap-DGP.html#checking-and-extending-the-cluster-rct-dgp"><i class="fa fa-check"></i><b>5.4.2</b> Checking and extending the Cluster RCT DGP</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="chap-DGP.html"><a href="chap-DGP.html#extension-standardization-in-a-data-generating-process"><i class="fa fa-check"></i><b>5.5</b> Extension: Standardization in a data generating process</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html"><i class="fa fa-check"></i><b>6</b> Estimation procedures</a>
<ul>
<li class="chapter" data-level="6.1" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#validating-estimation-procedures"><i class="fa fa-check"></i><b>6.1</b> Validating Estimation Procedures</a></li>
<li class="chapter" data-level="6.2" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#checking-via-simulation"><i class="fa fa-check"></i><b>6.2</b> Checking via simulation</a></li>
<li class="chapter" data-level="6.3" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#including-multiple-estimation-procedures"><i class="fa fa-check"></i><b>6.3</b> Including Multiple estimation procedures</a></li>
<li class="chapter" data-level="6.4" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#exercises-1"><i class="fa fa-check"></i><b>6.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#more-welch-and-adding-the-bff-test"><i class="fa fa-check"></i><b>6.4.1</b> More Welch and adding the BFF test</a></li>
<li class="chapter" data-level="6.4.2" data-path="estimation-procedures-1.html"><a href="estimation-procedures-1.html#more-estimators-for-cluster-randomized-trials"><i class="fa fa-check"></i><b>6.4.2</b> More estimators for Cluster Randomized Trials</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html"><i class="fa fa-check"></i><b>7</b> Running the Simulation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html#writing-simulations-quick-with-the-simhelpers-package"><i class="fa fa-check"></i><b>7.1</b> Writing simulations quick with the simhelpers package</a></li>
<li class="chapter" data-level="7.2" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html#adding-checks-and-balances"><i class="fa fa-check"></i><b>7.2</b> Adding Checks and Balances</a></li>
<li class="chapter" data-level="7.3" data-path="running-the-simulation-1.html"><a href="running-the-simulation-1.html#exercises-2"><i class="fa fa-check"></i><b>7.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="performance-criteria.html"><a href="performance-criteria.html"><i class="fa fa-check"></i><b>8</b> Performance criteria</a>
<ul>
<li class="chapter" data-level="8.1" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-vs.-estimation"><i class="fa fa-check"></i><b>8.1</b> Inference vs. Estimation</a></li>
<li class="chapter" data-level="8.2" data-path="performance-criteria.html"><a href="performance-criteria.html#ways-of-assessing-and-comparing-estimation-procedures"><i class="fa fa-check"></i><b>8.2</b> Ways of Assessing and Comparing Estimation Procedures</a></li>
<li class="chapter" data-level="8.3" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-point-estimator"><i class="fa fa-check"></i><b>8.3</b> Assessing a Point Estimator</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="performance-criteria.html"><a href="performance-criteria.html#comparing-the-performances-of-the-cluster-rct-estimation-procedures"><i class="fa fa-check"></i><b>8.3.1</b> Comparing the Performances of the Cluster RCT Estimation Procedures</a></li>
<li class="chapter" data-level="8.3.2" data-path="performance-criteria.html"><a href="performance-criteria.html#handling-estimands-not-represented-by-a-parameter"><i class="fa fa-check"></i><b>8.3.2</b> Handling Estimands Not Represented By a Parameter</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-a-standard-error-estimator"><i class="fa fa-check"></i><b>8.4</b> Assessing a Standard Error Estimator</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="performance-criteria.html"><a href="performance-criteria.html#why-not-assess-the-estimated-se-directly"><i class="fa fa-check"></i><b>8.4.1</b> Why Not Assess the Estimated SE directly?</a></li>
<li class="chapter" data-level="8.4.2" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-ses-for-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>8.4.2</b> Assessing SEs for Our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-an-inferential-procedure-hypothesis-testing"><i class="fa fa-check"></i><b>8.5</b> Assessing an Inferential Procedure (Hypothesis Testing)</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="performance-criteria.html"><a href="performance-criteria.html#validity"><i class="fa fa-check"></i><b>8.5.1</b> Validity</a></li>
<li class="chapter" data-level="8.5.2" data-path="performance-criteria.html"><a href="performance-criteria.html#power"><i class="fa fa-check"></i><b>8.5.2</b> Power</a></li>
<li class="chapter" data-level="8.5.3" data-path="performance-criteria.html"><a href="performance-criteria.html#the-rejection-rate"><i class="fa fa-check"></i><b>8.5.3</b> The Rejection Rate</a></li>
<li class="chapter" data-level="8.5.4" data-path="performance-criteria.html"><a href="performance-criteria.html#inference-in-our-cluster-rct-simulation"><i class="fa fa-check"></i><b>8.5.4</b> Inference in our Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="performance-criteria.html"><a href="performance-criteria.html#assessing-confidence-intervals"><i class="fa fa-check"></i><b>8.6</b> Assessing Confidence Intervals</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="performance-criteria.html"><a href="performance-criteria.html#confidence-intervals-in-our-cluster-rct-example"><i class="fa fa-check"></i><b>8.6.1</b> Confidence Intervals in our Cluster RCT Example</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="performance-criteria.html"><a href="performance-criteria.html#additional-thoughts-on-measuring-performance"><i class="fa fa-check"></i><b>8.7</b> Additional Thoughts on Measuring Performance</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="performance-criteria.html"><a href="performance-criteria.html#sec-relative-performance"><i class="fa fa-check"></i><b>8.7.1</b> Selecting Relative vs. Absolute Criteria</a></li>
<li class="chapter" data-level="8.7.2" data-path="performance-criteria.html"><a href="performance-criteria.html#robust-measures-of-performance"><i class="fa fa-check"></i><b>8.7.2</b> Robust Measures of Performance</a></li>
<li class="chapter" data-level="8.7.3" data-path="performance-criteria.html"><a href="performance-criteria.html#summary-of-peformance-measures"><i class="fa fa-check"></i><b>8.7.3</b> Summary of Peformance Measures</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="performance-criteria.html"><a href="performance-criteria.html#uncertainty-in-performance-estimates-the-mcse"><i class="fa fa-check"></i><b>8.8</b> Uncertainty in Performance Estimates (the MCSE)</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-for-relative-variance-estimators"><i class="fa fa-check"></i><b>8.8.1</b> MCSE for Relative Variance Estimators</a></li>
<li class="chapter" data-level="8.8.2" data-path="performance-criteria.html"><a href="performance-criteria.html#calculating-mcses-with-the-simhelpers-package"><i class="fa fa-check"></i><b>8.8.2</b> Calculating MCSEs With the <code>simhelpers</code> Package</a></li>
<li class="chapter" data-level="8.8.3" data-path="performance-criteria.html"><a href="performance-criteria.html#mcse-calculation-in-our-cluster-rct-example"><i class="fa fa-check"></i><b>8.8.3</b> MCSE Calculation in our Cluster RCT Example</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="performance-criteria.html"><a href="performance-criteria.html#exercises-3"><i class="fa fa-check"></i><b>8.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="case_Cronbach.html"><a href="case_Cronbach.html"><i class="fa fa-check"></i><b>9</b> Project: Cronbach Alpha</a>
<ul>
<li class="chapter" data-level="9.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#background"><i class="fa fa-check"></i><b>9.1</b> Background</a></li>
<li class="chapter" data-level="9.2" data-path="case_Cronbach.html"><a href="case_Cronbach.html#getting-started"><i class="fa fa-check"></i><b>9.2</b> Getting started</a></li>
<li class="chapter" data-level="9.3" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-data-generating-function"><i class="fa fa-check"></i><b>9.3</b> The data-generating function</a></li>
<li class="chapter" data-level="9.4" data-path="case_Cronbach.html"><a href="case_Cronbach.html#the-estimation-function"><i class="fa fa-check"></i><b>9.4</b> The estimation function</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercices-naive-confidence-intervals"><i class="fa fa-check"></i><b>9.4.1</b> Exercices (Naive confidence intervals)</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="case_Cronbach.html"><a href="case_Cronbach.html#estimator-performance"><i class="fa fa-check"></i><b>9.5</b> Estimator performance</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-calculating-performance"><i class="fa fa-check"></i><b>9.5.1</b> Exercises (Calculating Performance)</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="case_Cronbach.html"><a href="case_Cronbach.html#replication-and-the-simulation"><i class="fa fa-check"></i><b>9.6</b> Replication (and the simulation)</a></li>
<li class="chapter" data-level="9.7" data-path="case_Cronbach.html"><a href="case_Cronbach.html#extension-confidence-interval-coverage"><i class="fa fa-check"></i><b>9.7</b> Extension: Confidence interval coverage</a></li>
<li class="chapter" data-level="9.8" data-path="case_Cronbach.html"><a href="case_Cronbach.html#a-taste-of-multiple-scenarios"><i class="fa fa-check"></i><b>9.8</b> A taste of multiple scenarios</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="case_Cronbach.html"><a href="case_Cronbach.html#exercises-4"><i class="fa fa-check"></i><b>9.8.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html"><i class="fa fa-check"></i><b>10</b> Case study: Attrition in a simple randomized experiment</a>
<ul>
<li class="chapter" data-level="10.1" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#the-data-generating-process"><i class="fa fa-check"></i><b>10.1</b> The data generating process</a></li>
<li class="chapter" data-level="10.2" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#estimators"><i class="fa fa-check"></i><b>10.2</b> Estimators</a></li>
<li class="chapter" data-level="10.3" data-path="case-study-attrition-in-a-simple-randomized-experiment.html"><a href="case-study-attrition-in-a-simple-randomized-experiment.html#performance-criteria-1"><i class="fa fa-check"></i><b>10.3</b> Performance criteria</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="exp-design.html"><a href="exp-design.html"><i class="fa fa-check"></i><b>11</b> Designing the multifactor simulation experiment</a>
<ul>
<li class="chapter" data-level="11.1" data-path="exp-design.html"><a href="exp-design.html#choosing-parameter-combinations"><i class="fa fa-check"></i><b>11.1</b> Choosing parameter combinations</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="exp-design.html"><a href="exp-design.html#choosing-parameters-for-the-clustered-rct"><i class="fa fa-check"></i><b>11.1.1</b> Choosing parameters for the Clustered RCT</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="exp-design.html"><a href="exp-design.html#using-pmap-to-run-multifactor-simulations"><i class="fa fa-check"></i><b>11.2</b> Using pmap to run multifactor simulations</a></li>
<li class="chapter" data-level="11.3" data-path="exp-design.html"><a href="exp-design.html#ways-of-repeating-oneself"><i class="fa fa-check"></i><b>11.3</b> Ways of repeating oneself</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="exp-design.html"><a href="exp-design.html#getting-raw-results-ready-for-analysis"><i class="fa fa-check"></i><b>11.3.1</b> Getting raw results ready for analysis</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="exp-design.html"><a href="exp-design.html#running-the-cluster-rct-multifactor-experiment"><i class="fa fa-check"></i><b>11.4</b> Running the Cluster RCT multifactor experiment</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="exp-design.html"><a href="exp-design.html#making-analyze_data-quiet"><i class="fa fa-check"></i><b>11.4.1</b> Making analyze_data() quiet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html"><i class="fa fa-check"></i><b>12</b> Analyzing the multifactor experiment</a>
<ul>
<li class="chapter" data-level="12.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#bundling"><i class="fa fa-check"></i><b>12.1</b> Bundling</a></li>
<li class="chapter" data-level="12.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#aggregation"><i class="fa fa-check"></i><b>12.2</b> Aggregation</a></li>
<li class="chapter" data-level="12.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#regression-summarization"><i class="fa fa-check"></i><b>12.3</b> Regression Summarization</a></li>
<li class="chapter" data-level="12.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focus-on-subset-kick-rest-to-supplement"><i class="fa fa-check"></i><b>12.4</b> Focus on subset, kick rest to supplement</a></li>
<li class="chapter" data-level="12.5" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#analyzing-results-when-some-trials-have-failed"><i class="fa fa-check"></i><b>12.5</b> Analyzing results when some trials have failed</a></li>
<li class="chapter" data-level="12.6" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#a-demonstration-of-visualization"><i class="fa fa-check"></i><b>12.6</b> A demonstration of visualization</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#the-initial-analysis"><i class="fa fa-check"></i><b>12.6.1</b> The initial analysis</a></li>
<li class="chapter" data-level="12.6.2" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#focusing-on-validity"><i class="fa fa-check"></i><b>12.6.2</b> Focusing on validity</a></li>
<li class="chapter" data-level="12.6.3" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#looking-at-main-effects"><i class="fa fa-check"></i><b>12.6.3</b> Looking at main effects</a></li>
<li class="chapter" data-level="12.6.4" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#recap"><i class="fa fa-check"></i><b>12.6.4</b> Recap</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="analyzing-the-multifactor-experiment.html"><a href="analyzing-the-multifactor-experiment.html#exercises-5"><i class="fa fa-check"></i><b>12.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html"><i class="fa fa-check"></i><b>13</b> Case study: Comparing different estimators</a>
<ul>
<li class="chapter" data-level="13.1" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-generating-process-1"><i class="fa fa-check"></i><b>13.1</b> The data generating process</a></li>
<li class="chapter" data-level="13.2" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-data-analysis-methods"><i class="fa fa-check"></i><b>13.2</b> The data analysis methods</a></li>
<li class="chapter" data-level="13.3" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#the-simulation-itself"><i class="fa fa-check"></i><b>13.3</b> The simulation itself</a></li>
<li class="chapter" data-level="13.4" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#calculating-performance-measures-for-all-our-estimators"><i class="fa fa-check"></i><b>13.4</b> Calculating performance measures for all our estimators</a></li>
<li class="chapter" data-level="13.5" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#improving-the-visualization-of-the-results"><i class="fa fa-check"></i><b>13.5</b> Improving the visualization of the results</a></li>
<li class="chapter" data-level="13.6" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#extension-the-bias-variance-tradeoff"><i class="fa fa-check"></i><b>13.6</b> Extension: The Bias-variance tradeoff</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html"><i class="fa fa-check"></i><b>14</b> Presentation of simulation results</a>
<ul>
<li class="chapter" data-level="14.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#tabulation"><i class="fa fa-check"></i><b>14.1</b> Tabulation</a></li>
<li class="chapter" data-level="14.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#visualization"><i class="fa fa-check"></i><b>14.2</b> Visualization</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-1-biserial-correlation-estimation"><i class="fa fa-check"></i><b>14.2.1</b> Example 1: Biserial correlation estimation</a></li>
<li class="chapter" data-level="14.2.2" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-2-variance-estimation-and-meta-regression"><i class="fa fa-check"></i><b>14.2.2</b> Example 2: Variance estimation and Meta-regression</a></li>
<li class="chapter" data-level="14.2.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#example-heat-maps-of-coverage"><i class="fa fa-check"></i><b>14.2.3</b> Example: Heat maps of coverage</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="presentation-of-simulation-results.html"><a href="presentation-of-simulation-results.html#modeling"><i class="fa fa-check"></i><b>14.3</b> Modeling</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sec-reproducability.html"><a href="sec-reproducability.html"><i class="fa fa-check"></i><b>15</b> Ensuring reproducibility</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sec-reproducability.html"><a href="sec-reproducability.html#seeds-and-pseudo-random-number-generators"><i class="fa fa-check"></i><b>15.1</b> Seeds and pseudo-random number generators</a></li>
<li class="chapter" data-level="15.2" data-path="sec-reproducability.html"><a href="sec-reproducability.html#including-seed-in-our-simulation-driver"><i class="fa fa-check"></i><b>15.2</b> Including seed in our simulation driver</a></li>
<li class="chapter" data-level="15.3" data-path="sec-reproducability.html"><a href="sec-reproducability.html#reasons-for-setting-the-seed"><i class="fa fa-check"></i><b>15.3</b> Reasons for setting the seed</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="optimize-code.html"><a href="optimize-code.html"><i class="fa fa-check"></i><b>16</b> Optimizing code (and why you often shouldn’t)</a>
<ul>
<li class="chapter" data-level="16.1" data-path="optimize-code.html"><a href="optimize-code.html#hand-building-functions"><i class="fa fa-check"></i><b>16.1</b> Hand-building functions</a></li>
<li class="chapter" data-level="16.2" data-path="optimize-code.html"><a href="optimize-code.html#sec_comp_efficiency"><i class="fa fa-check"></i><b>16.2</b> Computational efficiency versus simplicity</a></li>
<li class="chapter" data-level="16.3" data-path="optimize-code.html"><a href="optimize-code.html#reusing-code-to-speed-up-computation"><i class="fa fa-check"></i><b>16.3</b> Reusing code to speed up computation</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html"><i class="fa fa-check"></i><b>17</b> Error trapping and other headaches</a>
<ul>
<li class="chapter" data-level="17.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#safe_code"><i class="fa fa-check"></i><b>17.1</b> Safe code</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#making-a-safe-function-call"><i class="fa fa-check"></i><b>17.1.1</b> Making a safe function call</a></li>
<li class="chapter" data-level="17.1.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#what-to-do-with-warnings-in-simulations"><i class="fa fa-check"></i><b>17.1.2</b> What to do with warnings in simulations</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="error-trapping-and-other-headaches.html"><a href="error-trapping-and-other-headaches.html#about-stopifnot"><i class="fa fa-check"></i><b>17.2</b> Protecting your functions with “stop”</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="saving-files.html"><a href="saving-files.html"><i class="fa fa-check"></i><b>18</b> Saving files and results</a>
<ul>
<li class="chapter" data-level="18.1" data-path="saving-files.html"><a href="saving-files.html#saving-simulations-in-general"><i class="fa fa-check"></i><b>18.1</b> Saving simulations in general</a></li>
<li class="chapter" data-level="18.2" data-path="saving-files.html"><a href="saving-files.html#saving-simulations-as-you-go"><i class="fa fa-check"></i><b>18.2</b> Saving simulations as you go</a></li>
<li class="chapter" data-level="18.3" data-path="saving-files.html"><a href="saving-files.html#dynamically-making-directories"><i class="fa fa-check"></i><b>18.3</b> Dynamically making directories</a></li>
<li class="chapter" data-level="18.4" data-path="saving-files.html"><a href="saving-files.html#loading-and-combining-files-of-simulation-results"><i class="fa fa-check"></i><b>18.4</b> Loading and combining files of simulation results</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="parallel-processing.html"><a href="parallel-processing.html"><i class="fa fa-check"></i><b>19</b> Parallel Processing</a>
<ul>
<li class="chapter" data-level="19.1" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-on-your-computer"><i class="fa fa-check"></i><b>19.1</b> Parallel on your computer</a></li>
<li class="chapter" data-level="19.2" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-off-your-computer"><i class="fa fa-check"></i><b>19.2</b> Parallel off your computer</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="parallel-processing.html"><a href="parallel-processing.html#what-is-a-command-line-interface"><i class="fa fa-check"></i><b>19.2.1</b> What is a command-line interface?</a></li>
<li class="chapter" data-level="19.2.2" data-path="parallel-processing.html"><a href="parallel-processing.html#running-a-job-on-a-cluster"><i class="fa fa-check"></i><b>19.2.2</b> Running a job on a cluster</a></li>
<li class="chapter" data-level="19.2.3" data-path="parallel-processing.html"><a href="parallel-processing.html#checking-on-a-job"><i class="fa fa-check"></i><b>19.2.3</b> Checking on a job</a></li>
<li class="chapter" data-level="19.2.4" data-path="parallel-processing.html"><a href="parallel-processing.html#running-lots-of-jobs-on-a-cluster"><i class="fa fa-check"></i><b>19.2.4</b> Running lots of jobs on a cluster</a></li>
<li class="chapter" data-level="19.2.5" data-path="parallel-processing.html"><a href="parallel-processing.html#resources-for-harvards-odyssey"><i class="fa fa-check"></i><b>19.2.5</b> Resources for Harvard’s Odyssey</a></li>
<li class="chapter" data-level="19.2.6" data-path="parallel-processing.html"><a href="parallel-processing.html#acknowledgements-1"><i class="fa fa-check"></i><b>19.2.6</b> Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html"><i class="fa fa-check"></i><b>20</b> Using simulation as a power calculator</a>
<ul>
<li class="chapter" data-level="20.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#getting-design-parameters-from-pilot-data"><i class="fa fa-check"></i><b>20.1</b> Getting design parameters from pilot data</a></li>
<li class="chapter" data-level="20.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#the-data-generating-process-2"><i class="fa fa-check"></i><b>20.2</b> The data generating process</a></li>
<li class="chapter" data-level="20.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#running-the-simulation-2"><i class="fa fa-check"></i><b>20.3</b> Running the simulation</a></li>
<li class="chapter" data-level="20.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#evaluating-power"><i class="fa fa-check"></i><b>20.4</b> Evaluating power</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#checking-validity-of-our-models"><i class="fa fa-check"></i><b>20.4.1</b> Checking validity of our models</a></li>
<li class="chapter" data-level="20.4.2" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-precision-se"><i class="fa fa-check"></i><b>20.4.2</b> Assessing Precision (SE)</a></li>
<li class="chapter" data-level="20.4.3" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-power"><i class="fa fa-check"></i><b>20.4.3</b> Assessing power</a></li>
<li class="chapter" data-level="20.4.4" data-path="using-simulation-as-a-power-calculator.html"><a href="using-simulation-as-a-power-calculator.html#assessing-minimum-detectable-effects"><i class="fa fa-check"></i><b>20.4.4</b> Assessing Minimum Detectable Effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html"><i class="fa fa-check"></i><b>21</b> Simulation under the Potential Outcomes Framework</a>
<ul>
<li class="chapter" data-level="21.1" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#finite-vs.-superpopulation-inference"><i class="fa fa-check"></i><b>21.1</b> Finite vs. Superpopulation inference</a></li>
<li class="chapter" data-level="21.2" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#data-generation-processes-for-potential-outcomes"><i class="fa fa-check"></i><b>21.2</b> Data generation processes for potential outcomes</a></li>
<li class="chapter" data-level="21.3" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#finite-sample-performance-measures"><i class="fa fa-check"></i><b>21.3</b> Finite sample performance measures</a></li>
<li class="chapter" data-level="21.4" data-path="chap-potential-outcomes.html"><a href="chap-potential-outcomes.html#nested-finite-simulation-procedure"><i class="fa fa-check"></i><b>21.4</b> Nested finite simulation procedure</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html"><i class="fa fa-check"></i><b>22</b> Simulations as evidence</a>
<ul>
<li class="chapter" data-level="22.1" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#use-extensive-multi-factor-simulations"><i class="fa fa-check"></i><b>22.1</b> Use extensive multi-factor simulations</a></li>
<li class="chapter" data-level="22.2" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#beat-them-at-their-own-game"><i class="fa fa-check"></i><b>22.2</b> Beat them at their own game</a></li>
<li class="chapter" data-level="22.3" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#calibrated-simulations"><i class="fa fa-check"></i><b>22.3</b> Calibrated simulations</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>23</b> The Parametric bootstrap</a>
<ul>
<li class="chapter" data-level="23.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#air-conditioners-a-stolen-case-study"><i class="fa fa-check"></i><b>23.1</b> Air conditioners: a stolen case study</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="on_functions.html"><a href="on_functions.html"><i class="fa fa-check"></i><b>24</b> Appendix: Coding tidbits</a>
<ul>
<li class="chapter" data-level="24.1" data-path="on_functions.html"><a href="on_functions.html#repeating-oneself"><i class="fa fa-check"></i><b>24.1</b> Other ways of repeating yourself</a></li>
<li class="chapter" data-level="24.2" data-path="on_functions.html"><a href="on_functions.html#default-arguments"><i class="fa fa-check"></i><b>24.2</b> Default arguments for functions</a></li>
<li class="chapter" data-level="24.3" data-path="on_functions.html"><a href="on_functions.html#testing-and-debugging-code-in-your-scripts"><i class="fa fa-check"></i><b>24.3</b> Testing and debugging code in your scripts</a></li>
<li class="chapter" data-level="24.4" data-path="on_functions.html"><a href="on_functions.html#keep-multiple-files-of-code"><i class="fa fa-check"></i><b>24.4</b> Keep multiple files of code</a></li>
<li class="chapter" data-level="24.5" data-path="on_functions.html"><a href="on_functions.html#the-source-command-and-keeping-things-organized"><i class="fa fa-check"></i><b>24.5</b> The source command and keeping things organized</a></li>
<li class="chapter" data-level="24.6" data-path="on_functions.html"><a href="on_functions.html#debugging-with-browser"><i class="fa fa-check"></i><b>24.6</b> Debugging with browser</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="further-readings-and-resources.html"><a href="further-readings-and-resources.html"><i class="fa fa-check"></i><b>25</b> Further readings and resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Designing Monte Carlo Simulations in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Introduction<a href="introduction.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this text we present an approach for writing Monte Carlo simulations in R.
Our focus in this text is on the best practices of simulation design and how to use simulation to be a more informed and effective quantitative analyst.
In particular, we try to provide a guide to designing simulation studies to answer questions about statistical methodology.</p>
<p>In general, simulation studies allow for investigating the performance of a statistical model or method under known data-generating processes.
By controlling the data generating process (e.g., by specifying true values for the parameters of a statistical model) and then repeatedly applying a statistical method to data generated by that process, it becomes possible to assess how well a statistical method works.</p>
<p>Overall, we will show how simulation frameworks allow for rapid exploration of the impact of different design choices and data concerns, and how simulation can answer questions that are hard to answer using direct computation (e.g., with power calculators or mathematical formula).
Simulations are particularly useful for studying models and estimation methods where relevant algebraic formulas are not available, not easily applied, or not sufficiently accurate.
For example, available algebraic formulas are often based on asymptotic approximations, which might not “kick in” if sample sizes are moderate.
This is, for example, a particular concern with hierarchical data structures that include only 20 to 40 clusters, which is the range of common sample sizes in many large-scale randomized trials in education research.</p>
<div id="some-of-simulations-many-uses" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Some of simulation’s many uses<a href="introduction.html#some-of-simulations-many-uses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simulation can be useful across a wide range of areas.
To wet the appetite, consider the following areas where one might find need of simulation.</p>
<div id="comparing-statistical-approaches" class="section level3 hasAnchor" number="1.1.1">
<h3><span class="header-section-number">1.1.1</span> Comparing statistical approaches<a href="introduction.html#comparing-statistical-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Comparing statistical approaches is perhaps the most common use of Monte Carlo simulation.
In the statistical methodology literature, for example, authors will frequently use simulation to compare their newly proposed method to more traditional approaches to make a case for their method being of real value.
Other simulation-based research will often work to align a literature by systematically comparing a suite of methods all designed to achieve a given task to one another.
In the best case, simulation can show how trade-offs between methods can occur in practice.</p>
<p>For a classic example, Brown and Forsythe (1974) compared four different procedures for conducting a hypothesis test for equality of means in several populations (i.e., one-way ANOVA) when the population variances are not equal.
We revisit this example later.
Overall, simulation can be critical for understanding the benefits and drawbacks of analytic methods in practice.</p>
<p>Comparitive simulation can also have a practical application: In many situations, more than one modeling approach is possible for addressing the same research question (or estimating the same target parameter).
Comparing the costs of one vs. another using simulation is informative for guiding the design of analytic plans (such as plans included in pre-registered study protocols).
As an example of the type of questions that researchers might encounter in designing analytic plans: what are the practical benefits and costs of using a model that allows for cross-site impact variation for a multi-site trial <span class="citation">(<a href="#ref-miratrix2021applied">Miratrix, Weiss, and Henderson 2021</a>)</span>?</p>
</div>
<div id="assessing-performance-of-complex-pipelines" class="section level3 hasAnchor" number="1.1.2">
<h3><span class="header-section-number">1.1.2</span> Assessing performance of complex pipelines<a href="introduction.html#assessing-performance-of-complex-pipelines" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In practice, statistical methods are often used in combination.
For instance, in a regression model, one could first use a statistical test for heteroskedasticity (e.g., the White test or the Breusch-Pagan test) and then determine whether to use conventional or robust standard errors depending on the result of the test. This combination of an initial diagnostic test followed by contingent use of different statistical procedures is all but impossible to analyze mathematically, but it is straight-forward to simulate (see, for example, Long &amp; Ervin, 2000).
In particular, with simulation, we can verify a proposed pipeline is <em>valid</em>, meaning that the conclusions it draws are correct at a given level of certainty.</p>
<p>Simulating an analytic pipeline can be used for statistical inference as well.
With bootstrap or parametric bootstrap approaches, for example, one is, in essence, repeatedly simulating data and putting it through an entire analytic pipeline to assess how stable estimation is.
How much a final point estimate varies across the simulation trials is the standard error for the context being simulated; an argument by analogy (the bootstrap analogy) is what connects this to inference on the original data and point estimate.</p>
</div>
<div id="assessing-performance-under-misspecification" class="section level3 hasAnchor" number="1.1.3">
<h3><span class="header-section-number">1.1.3</span> Assessing performance under misspecification<a href="introduction.html#assessing-performance-under-misspecification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many statistical estimation procedures can be shown (through mathematical analysis) to perform well when the assumptions they entail are correct.
However, in practice it is often of interest to also understand their robustness—that is, their performance when one or more of the assumptions is incorrect.
For example, how important is the normality assumption underlying multilevel modeling?
What about homoskedasticity?</p>
<p>In a similar vein, when the true data-generating process meets stringent assumptions (e.g., constant treatment effect), what are the potential gain of exploiting such structure in the estimation process?
Conversely, what are the costs of using flexible methods that do not impose the stringent assumption?
A researcher designing an analytic plan would want to be well informed of such tradeoffs in the context they are working in.
Simulation allows for such investigation and comparison.</p>
</div>
<div id="assessing-the-finite-sample-performance-of-a-statistical-approach" class="section level3 hasAnchor" number="1.1.4">
<h3><span class="header-section-number">1.1.4</span> Assessing the finite sample performance of a statistical approach<a href="introduction.html#assessing-the-finite-sample-performance-of-a-statistical-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Many statistical estimation procedures can be shown (through mathematical analysis) to work well <em>asymptotically</em>—that is, given an infinite amount of data—but their performance in small samples is more difficult to quantify.
Simulation is a tractable approach for assessing the small-sample performance of such methods, or for determining minimum required sample sizes for adequate performance.
This is perhaps one of the most important uses for simulation: mathematical theory generally is asymptotic in nature, but we are living in the finite world and practice.
In order to know whether the asymptotics “kick in” we must rely on simulation.</p>
<p>For example, heteroskedasticity-robust standard errors (HRSE) are known to work asymptotically, but can be misleading in small samples.
Long and Ervin (2000) use extensive simulations to investigate the properties of different heteroscedasticity robust standard error estimators for linear regression across a range of sample sizes, demonstrating that the most commonly used form of these estimators often does <em>not</em> work well with sample sizes typical in the social sciences.
Simulation could answer what asymptotics could not: how these estimators work in typical practice.</p>
<p>For another example, recent work has developed the Fixed-Intercept, Random Coefficient method for estimating and accounting for cross site treatment variation in multisite trials. When there are a moderate number of clusters it appears that the numerical (asymptotic based) estimates of performance are not very accurate. Simulation can unpack these trends and give a more accurate picture of effectiveness in these real contexts.</p>
</div>
<div id="conducting-power-analyses" class="section level3 hasAnchor" number="1.1.5">
<h3><span class="header-section-number">1.1.5</span> Conducting Power Analyses<a href="introduction.html#conducting-power-analyses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>By repeatedly simulating and then analyzing data from a guessed-at world, a researcher can easily calculate the power to detect the effects so modeled, if that world were true.
This can allow for power analyses far more nuanced and tailored to a given circumstance than typical power calculators. In particular, simulation can be useful for the following:</p>
<ul>
<li><p>Available formulas for power analysis in multi-site block- or cluster-randomized trials (such those implemented in the Optimal Design and PowerUp! Software) assume that sites are of equal size and that outcome distributions are unrelated to site size. Small deviations from these assumptions are unlikely to change the results, but in practice, researchers may face situations where sites vary quite widely in size or where site-level outcomes are related to site size. Simulation can estimate power in this case.</p></li>
<li><p>Available software (such as PowerUp!) allows investigators to make assumptions about anticipated rates of attrition in cluster-randomized trials, under the assumption that attrition is completely at random. However, researchers might anticipate that attrition will be related to baseline characteristics, leading to data that is missing at random but not completely at random. How will this affect the power of a planned study?</p></li>
<li><p>There are some closed-form expressions for power to test mediational relations (i.e., indirect and direct effects) in a variety of different experimental designs, and these formulas are now available in PowerUp!. However, the formulas involve a large number of parameters (including some where it may be difficult in practice to develop credible assumptions) and they apply only to a specific analytic model for the mediating relationships. Researchers planning a study to investigate mediation might therefore find it easier to generate realistic data structures and conduct power analysis via simulation.</p></li>
</ul>
</div>
<div id="simulating-processess" class="section level3 hasAnchor" number="1.1.6">
<h3><span class="header-section-number">1.1.6</span> Simulating processess<a href="introduction.html#simulating-processess" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Less central to this book, but a very common use for simulation, is to simulation some sort of complex process to better understand it or the consequences of it.
For example, some larger school districts (e.g., New York City) have centralized lotteries for school assignment where families rank some number of schools by order of preference.
The central office then assigns students to schools via a lottery procedure where each student gets a lottery number that breaks ties when there are too many students desiring to go to a specific school.
As a consequence, students have a random probability of assignment to the schools on their list, depending on their choices, the choices of other students, and their lottery numbers.</p>
<p>We can exploit this process to estimate the causal impact of being assigned to one school vs. another, treating the lottery as a natural experiment, but only if we have those probabilities of school assignment.
We can obtain them via simulation: we repeatedly run the school lottery over and over, and record where everyone gets assigned.
Using these final propensity scores we can move forward with our analysis <span class="citation">(<a href="#ref-abdulkadirouglu2017research">Abdulkadiroğlu et al. 2017</a>)</span>.</p>
<p>For another example, one that possibly illustrates the perils of simulation as taking us away from results that pass face validity, <span class="citation">Staiger and Rockoff (<a href="#ref-staiger2010searching">2010</a>)</span> simulate the process of firing teachers depending on their estimated value added scores.
Using simulation of different levels of draconian policy, they argue that substantial portions of teachers should be fired each year.
Here we see a clean example of how the assumptions driving a simulation can be explored, so we can see what the consequences of a system would be… if the assumptions behind the simulation were true.</p>
<p>A famous area of process simulation are climate models, where researchers simulate the process of climate change.
These physical simulations mimic very complex systems to try and understand how perturbations (e.g., more carbon release) will impact downstream trends.</p>
</div>
</div>
<div id="the-perils-of-simulation-as-evidence" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> The perils of simulation as evidence<a href="introduction.html#the-perils-of-simulation-as-evidence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Simulation has the potential to be a powerful tool for investigating quantitative methods.
Unfortunately, simulation-based argument also opens up a large can of worms, and is very susceptible to critique.
These critiques usually revolve around what the data generating process of the simulations is.
Are the simulated data realistic?
Was the simulation systematic in exploring a wide variety of scenarios, allowing for truly general conclusions?</p>
<p>The best way to answer these arguments is through transparency: explicitly state what was done, and provide code so people can tweak it to run their own simulations.
Another important component of a robust argument is systematic variation: design simulations so that one can easily simulate across a range of scenarios.
Once that is in place, systematically explore myriad scenarios and report all of the results.</p>
<p>Due to the flexibility in the design of simulations, they are held in great skepticism by many.
A summary of this is the motto</p>
<blockquote>
<p>Simulations are doomed to succeed.</p>
</blockquote>
<p>Simulations are alluring: once a simulation framework is set up, it is easy to tweak and adjust.
It is natural for us all to continue to do this until the simulation works “as it should.”
This means, if our goal was to show something we “know” is right (e.g., that our new estimation procedure is better than another), we will eventually find a way to align our simulation with our intuition.
This is, simply put, a version of fishing.</p>
<p>To counteract that, challenge yourself to design scenarios where things do not work as you expect.
Try to learn the edges that separate where things work, and where things do not.</p>
</div>
<div id="why-r-and-rstudio" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Why R and RStudio?<a href="introduction.html#why-r-and-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The statistical software package R runs on both PCs and Macs. The software is free and available online.
R is straightforward to learn, but is sufficiently powerful and versatile to be useful for real projects that you might carry out.
It is used widely for statistical work in such fields as education, psychology, economics, medical research, epidemiology, public health, and political science.</p>
<p>We highly recommend using RStudio, which makes using R easier. RStudio is an Integrated Development Environment (IDE) that structures your experience, helps keep things organized, and offers multiple time-saving features to make your programming experience better. You might also consider using R Markdown. R Markdown allows for generating documents with embedded R code and R output in a clean format, which can greatly help report generation.
(In fact, this book is in a variant of R Markdown.)</p>
<p>Many people seem to believe that R is particularly technically challenging and difficult to master. This probably stems from its extreme flexibility; it is a fully functional programming language as well as a statistical analysis package. R can do things that many other software packages (we’re looking at you, Stata) essentially cannot.
But these more involved things are frequently hard to do because they require you to think like a statistical programmer rather than a data analyst.
As a result, R is perceived as a “hard” language to use.
For simulation, in particular, the ability to easily write functions (bundles of commands that you can easily call in different manners), to have multiple tables of data in play at the same time, and to leverage the vast array of other people’s work all make R an attractive option.</p>
<div id="templates-vs.-patterns" class="section level3 hasAnchor" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> Templates vs. Patterns<a href="introduction.html#templates-vs.-patterns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We generally adhere to a simple, modular approach to building simulations.
We (repeatedly) demonstrate a set sequence of steps, going from coding a data generating process, to the estimation methods, to the code for evaluating a simulation result, to the final multifactor experiment.
But our many case studies are not all precisely the same; the idea of this sequence of steps is paramount, but coding is not a rigid process.
Different aspects of a particular problem may call for doing things in a slightly different manner.
And often, it is merely an issue of style or choice.</p>
<p>We believe that the variants of the coding pattens we showcase are just as important as the patterns themselves, as they take us out of a rigid model of thinking about the creation of simulations.
The different takes on the same idea will, we hope, expand the sense of what is possible and also triangulate the core coding principles we are attempting to espouse.</p>
<p>That being said, much of this code can be taken verbatim, tweaked for your own ends, and used.
We hope you end up doing just that!</p>
</div>
<div id="the-tidyverse-and-a-recommended-text" class="section level3 hasAnchor" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> The tidyverse and a recommended text<a href="introduction.html#the-tidyverse-and-a-recommended-text" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Layered on top of R are a collection of packages that make data wrangling and management much, much easier.
This collection is called the “tidyverse,” and much of this book heavily relies on it.
Loading the tidyverse packages is straightforward</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="introduction.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>( tidyverse )</span>
<span id="cb1-2"><a href="introduction.html#cb1-2" tabindex="-1"></a><span class="fu">options</span>(<span class="fu">list</span>(<span class="at">dplyr.summarise.inform =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<p>(The second line is to shut up some of tidyverse’s weird summarize warnings.)
These lines of code are pretty much the header of any script we use.</p>
<p>We use methods from the “tidyverse” for cleaner code and some nice shortcuts.
See the online, free and excellent (<a href="https://r4ds.had.co.nz/" class="uri">https://r4ds.had.co.nz/</a>)[R for Data Science textbook] for more on the tidyverse.
We will cite portions of this text throughout this manuscript.</p>
</div>
<div id="functions" class="section level3 hasAnchor" number="1.3.3">
<h3><span class="header-section-number">1.3.3</span> Functions<a href="introduction.html#functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="float">
<img src="image/function-machine.png" style="width:50.0%" alt="A function as a machine" />
<div class="figcaption">A function as a machine</div>
</div>
<p>A critical component of simulation design is the use of functions.
A function is a bundle of commands that you can name, so you can use those commands over and over.
You can think of it as a machine, with a hopper that takes some inputs, and a chute that spits out an output based on those inputs (see figure above).
A function can do anything, and it can even be random in its behavior.
For example, the <code>rnorm()</code> function in R takes a number, and gives you that many random, normally distributed, numbers in response.
See <a href="https://r4ds.had.co.nz/functions.html">Chapter 19 of R for Data Science</a> for an extended discussion, but here is an example function to get you started:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="introduction.html#cb2-1" tabindex="-1"></a>one_run <span class="ot">&lt;-</span> <span class="cf">function</span>( N, mn ) {</span>
<span id="cb2-2"><a href="introduction.html#cb2-2" tabindex="-1"></a>  vals <span class="ot">=</span> <span class="fu">rnorm</span>( N, <span class="at">mean =</span> mn )</span>
<span id="cb2-3"><a href="introduction.html#cb2-3" tabindex="-1"></a>  tt <span class="ot">=</span> <span class="fu">t.test</span>( vals )</span>
<span id="cb2-4"><a href="introduction.html#cb2-4" tabindex="-1"></a>  tt<span class="sc">$</span>p.value</span>
<span id="cb2-5"><a href="introduction.html#cb2-5" tabindex="-1"></a>}</span></code></pre></div>
<p>The above makes a new command, <code>one_run()</code> that takes a desired sample size <span class="math inline">\(N\)</span> and mean <code>mn</code> and generates <span class="math inline">\(N\)</span> normally distributed points centered on <code>mn</code>, conducts a <span class="math inline">\(t\)</span>-test on the results, and returns the <span class="math inline">\(p\)</span>-value for testing whether the mean is zero or not.
The things we pass to the function, <code>N</code> and <code>mn</code>, are called <em>parameters</em>, or <em>inputs</em>.
Inside the function, we can use these to make calculations and so forth.</p>
<p>We call our new method as so:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="introduction.html#cb3-1" tabindex="-1"></a><span class="fu">one_run</span>( <span class="dv">100</span>, <span class="dv">5</span> )</span></code></pre></div>
<pre><code>## [1] 1.290701e-73</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="introduction.html#cb5-1" tabindex="-1"></a><span class="fu">one_run</span>( <span class="dv">10</span>, <span class="fl">0.3</span> )</span></code></pre></div>
<pre><code>## [1] 0.449799</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="introduction.html#cb7-1" tabindex="-1"></a><span class="fu">one_run</span>( <span class="dv">10</span>, <span class="fl">0.3</span> )</span></code></pre></div>
<pre><code>## [1] 0.03468605</code></pre>
<p>In this case, each time we run our code, we get a different answer since we are generating random numbers with each call.</p>
<p>We can call it a lot, like so:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="introduction.html#cb9-1" tabindex="-1"></a><span class="fu">set.seed</span>( <span class="dv">30303</span> )</span>
<span id="cb9-2"><a href="introduction.html#cb9-2" tabindex="-1"></a>pvs <span class="ot">=</span> <span class="fu">replicate</span>( <span class="dv">1000</span>, <span class="fu">one_run</span>( <span class="dv">100</span>, <span class="fl">0.2</span> ) )</span>
<span id="cb9-3"><a href="introduction.html#cb9-3" tabindex="-1"></a><span class="fu">qplot</span>( pvs, <span class="at">binwidth=</span><span class="fl">0.02</span> )</span></code></pre></div>
<p><img src="Designing-Simulations-in-R_files/figure-html/pvalue_plot-1.png" width="75%" style="display: block; margin: auto;" />
We see that if our sample size is 100, and the true mean is 0.2, we often get low <span class="math inline">\(p\)</span>-values, but not always. We can calculate the power of our test as so:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="introduction.html#cb10-1" tabindex="-1"></a><span class="fu">sum</span>( pvs <span class="sc">&lt;=</span> <span class="fl">0.05</span> ) <span class="sc">/</span> <span class="dv">1000</span></span></code></pre></div>
<pre><code>## [1] 0.492</code></pre>
<p>Via simulation, we have discovered we have about a 49% chance of rejecting the null, if the alternative is 0.2 and our sample size is 100.</p>
<p>Basically the rest of the book is an elaboration of the ideas above.</p>
</div>
<div id="a-dangerous-function" class="section level3 hasAnchor" number="1.3.4">
<h3><span class="header-section-number">1.3.4</span> A dangerous function<a href="introduction.html#a-dangerous-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Functions are awesome, but if you violate their intention, you can get into trouble.
For example, consider the following script:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="introduction.html#cb12-1" tabindex="-1"></a>secret_ingredient <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb12-2"><a href="introduction.html#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="introduction.html#cb12-3" tabindex="-1"></a><span class="co"># blah blah blah</span></span>
<span id="cb12-4"><a href="introduction.html#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="introduction.html#cb12-5" tabindex="-1"></a>funky <span class="ot">&lt;-</span> <span class="cf">function</span>(input1, input2, input3) {</span>
<span id="cb12-6"><a href="introduction.html#cb12-6" tabindex="-1"></a>  </span>
<span id="cb12-7"><a href="introduction.html#cb12-7" tabindex="-1"></a>  <span class="co"># do funky stuff</span></span>
<span id="cb12-8"><a href="introduction.html#cb12-8" tabindex="-1"></a>  ratio <span class="ot">&lt;-</span> input1 <span class="sc">/</span> (input2 <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb12-9"><a href="introduction.html#cb12-9" tabindex="-1"></a>  funky_output <span class="ot">&lt;-</span> input3 <span class="sc">*</span> ratio <span class="sc">+</span> secret_ingredient</span>
<span id="cb12-10"><a href="introduction.html#cb12-10" tabindex="-1"></a>  </span>
<span id="cb12-11"><a href="introduction.html#cb12-11" tabindex="-1"></a>  <span class="fu">return</span>(funky_output)  </span>
<span id="cb12-12"><a href="introduction.html#cb12-12" tabindex="-1"></a>}</span>
<span id="cb12-13"><a href="introduction.html#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="introduction.html#cb12-14" tabindex="-1"></a><span class="fu">funky</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 5.5</code></pre>
<p>You then call it like so:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="introduction.html#cb14-1" tabindex="-1"></a>secret_ingredient <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb14-2"><a href="introduction.html#cb14-2" tabindex="-1"></a><span class="fu">funky</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 102.5</code></pre>
<p>This is bad: our function acts differently even when we give it the same arguments.
Such behavior can be quite confusing, as we generally expect the function to work a certain way, given the inputs we provided it.</p>
<p>Even worse, we can get errors depending on this extra feature:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="introduction.html#cb16-1" tabindex="-1"></a>secret_ingredient <span class="ot">&lt;-</span> <span class="st">&quot;A&quot;</span></span>
<span id="cb16-2"><a href="introduction.html#cb16-2" tabindex="-1"></a><span class="fu">funky</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## Error in input3 * ratio + secret_ingredient: non-numeric argument to binary operator</code></pre>
<p>This is the #1 gotcha with function writing.
Be careful to, in a function, only use what you are <em>passed</em>, as in only use those parameters that are specified at the head of the function.
It is easy to write terrible, confusing code in R.</p>
<p>You can fix it by <em>isolating the inputs</em>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="introduction.html#cb18-1" tabindex="-1"></a>secret_ingredient <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb18-2"><a href="introduction.html#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="introduction.html#cb18-3" tabindex="-1"></a><span class="co"># blah blah blah</span></span>
<span id="cb18-4"><a href="introduction.html#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="introduction.html#cb18-5" tabindex="-1"></a>funky <span class="ot">&lt;-</span> <span class="cf">function</span>(input1, input2, input3, secret_ingredient) {</span>
<span id="cb18-6"><a href="introduction.html#cb18-6" tabindex="-1"></a>  </span>
<span id="cb18-7"><a href="introduction.html#cb18-7" tabindex="-1"></a>  <span class="co"># do funky stuff</span></span>
<span id="cb18-8"><a href="introduction.html#cb18-8" tabindex="-1"></a>  ratio <span class="ot">&lt;-</span> input1 <span class="sc">/</span> (input2 <span class="sc">+</span> <span class="dv">4</span>)</span>
<span id="cb18-9"><a href="introduction.html#cb18-9" tabindex="-1"></a>  funky_output <span class="ot">&lt;-</span> input3 <span class="sc">*</span> ratio <span class="sc">+</span> secret_ingredient</span>
<span id="cb18-10"><a href="introduction.html#cb18-10" tabindex="-1"></a>  </span>
<span id="cb18-11"><a href="introduction.html#cb18-11" tabindex="-1"></a>  <span class="fu">return</span>(funky_output)  </span>
<span id="cb18-12"><a href="introduction.html#cb18-12" tabindex="-1"></a>}</span>
<span id="cb18-13"><a href="introduction.html#cb18-13" tabindex="-1"></a></span>
<span id="cb18-14"><a href="introduction.html#cb18-14" tabindex="-1"></a><span class="fu">funky</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 5.5</code></pre>
<p>Now things are nice:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="introduction.html#cb20-1" tabindex="-1"></a>secret_ingredient <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb20-2"><a href="introduction.html#cb20-2" tabindex="-1"></a><span class="fu">funky</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 5.5</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="introduction.html#cb22-1" tabindex="-1"></a><span class="fu">funky</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## [1] 102.5</code></pre>
</div>
<div id="function-skeletons" class="section level3 hasAnchor" number="1.3.5">
<h3><span class="header-section-number">1.3.5</span> Function skeletons<a href="introduction.html#function-skeletons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we say “skeleton” we simply mean the header of a function, without the middle stuff. E.g.,</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="introduction.html#cb24-1" tabindex="-1"></a>run_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>( N, J, mu, sigma, tau ) {</span>
<span id="cb24-2"><a href="introduction.html#cb24-2" tabindex="-1"></a>  </span>
<span id="cb24-3"><a href="introduction.html#cb24-3" tabindex="-1"></a>}</span></code></pre></div>
<p>These are useful as documentation for sketching out a general plan of how to organize code.</p>
</div>
<div id="pipe-dreams" class="section level3 hasAnchor" number="1.3.6">
<h3><span class="header-section-number">1.3.6</span> <code>%&gt;%</code> (Pipe) dreams<a href="introduction.html#pipe-dreams" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We extensively use the “pipe” in our code.
For those unfamiliar, we here spend a moment discussing it, but see R for Data Science, Chapter 18, for more.
The <code>%&gt;%</code> command allows you to apply a <strong>sequence of functions</strong> to a data frame; this makes your code read like a story book.</p>
<p>With conventional code we have</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="introduction.html#cb25-1" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">f</span>(my_data, <span class="at">a =</span> <span class="dv">4</span>)</span>
<span id="cb25-2"><a href="introduction.html#cb25-2" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">g</span>(res1, <span class="at">b =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-3"><a href="introduction.html#cb25-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">h</span>(res2, <span class="at">c =</span> <span class="st">&quot;hot sauce&quot;</span>)</span></code></pre></div>
<p>Or</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="introduction.html#cb26-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">h</span>(<span class="fu">g</span>(<span class="fu">f</span>(my_data, <span class="at">a =</span> <span class="dv">4</span>), </span>
<span id="cb26-2"><a href="introduction.html#cb26-2" tabindex="-1"></a>              <span class="at">b =</span> <span class="cn">FALSE</span>), </span>
<span id="cb26-3"><a href="introduction.html#cb26-3" tabindex="-1"></a>            <span class="at">c =</span> <span class="st">&quot;hot sauce&quot;</span>)</span></code></pre></div>
<p>Ouch.</p>
<p>With the pipe we have</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="introduction.html#cb27-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> </span>
<span id="cb27-2"><a href="introduction.html#cb27-2" tabindex="-1"></a>  my_data <span class="sc">%&gt;%</span>        <span class="co"># initial dataset</span></span>
<span id="cb27-3"><a href="introduction.html#cb27-3" tabindex="-1"></a>  <span class="fu">f</span>(<span class="at">a =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span>       <span class="co"># do f() to it</span></span>
<span id="cb27-4"><a href="introduction.html#cb27-4" tabindex="-1"></a>  <span class="fu">g</span>(<span class="at">b =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span>   <span class="co"># then do g()</span></span>
<span id="cb27-5"><a href="introduction.html#cb27-5" tabindex="-1"></a>  <span class="fu">h</span>(<span class="at">c =</span> <span class="st">&quot;hot sauce&quot;</span>) <span class="co"># then do h()</span></span></code></pre></div>
<p>Nice!</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-abdulkadirouglu2017research" class="csl-entry">
Abdulkadiroğlu, Atila, Joshua D Angrist, Yusuke Narita, and Parag A Pathak. 2017. <span>“Research Design Meets Market Design: Using Centralized Assignment for Impact Evaluation.”</span> <em>Econometrica</em> 85 (5): 1373–1432.
</div>
<div id="ref-miratrix2021applied" class="csl-entry">
Miratrix, Luke W, Michael J Weiss, and Brit Henderson. 2021. <span>“An Applied Researcher’s Guide to Estimating Effects from Multisite Individually Randomized Trials: Estimands, Estimators, and Estimates.”</span> <em>Journal of Research on Educational Effectiveness</em> 14 (1): 270–308.
</div>
<div id="ref-staiger2010searching" class="csl-entry">
Staiger, Douglas O, and Jonah E Rockoff. 2010. <span>“Searching for Effective Teachers with Imperfect Information.”</span> <em>Journal of Economic Perspectives</em> 24 (3): 97–118.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="an-initial-simulation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jepusto/Designing-Simulations-in-R/edit/master/001-introduction.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Designing-Simulations-in-R.pdf", "Designing-Simulations-in-R.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
