<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Special Topics on Reporting Simulation Results | Designing Monte Carlo Simulations in R</title>
  <meta name="description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Special Topics on Reporting Simulation Results | Designing Monte Carlo Simulations in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  <meta name="github-repo" content="jepusto/Designing-Simulations-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Special Topics on Reporting Simulation Results | Designing Monte Carlo Simulations in R" />
  
  <meta name="twitter:description" content="A text on designing, implementing, and reporting on Monte Carlo simulation studies" />
  

<meta name="author" content="Luke W. Miratrix and James E. Pustejovsky (Equal authors)" />


<meta name="date" content="2026-01-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="building-good-visualization.html"/>
<link rel="next" href="case-study-comparing-different-estimators.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<span class="math inline">
\(\newcommand{\Prob}{\text{Pr}}\)
\(\newcommand{\E}{\mathbb{E}}\)
\(\newcommand{\M}{\mathbb{M}}\)
\(\newcommand{\Q}{\mathbb{Q}}\)
\(\newcommand{\Var}{\text{Var}}\)
\(\newcommand{\Bias}{\text{Bias}}\)
\(\newcommand{\RMSE}{\text{RMSE}}\)
\(\newcommand{\Cov}{\text{Cov}}\)
\(\newcommand{\cor}{\text{cor}}\)
\(\newcommand{\diag}{\text{diag}}\)
\(\newcommand{\mat}[1]{\mathbf{#1}}\)
\(\newcommand{\bs}{\boldsymbol}\)
\(\newcommand{\trace}{\text{tr}}\)
</span>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Designing Simulations in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-authors"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I An Introductory Look</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#some-of-simulations-many-uses"><i class="fa fa-check"></i><b>1.1</b> Some of simulation’s many uses</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#comparing-statistical-approaches"><i class="fa fa-check"></i><b>1.1.1</b> Comparing statistical approaches</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#assessing-performance-of-complex-pipelines"><i class="fa fa-check"></i><b>1.1.2</b> Assessing performance of complex pipelines</a></li>
<li class="chapter" data-level="1.1.3" data-path="introduction.html"><a href="introduction.html#assessing-performance-under-misspecification"><i class="fa fa-check"></i><b>1.1.3</b> Assessing performance under misspecification</a></li>
<li class="chapter" data-level="1.1.4" data-path="introduction.html"><a href="introduction.html#assessing-the-finite-sample-performance-of-a-statistical-approach"><i class="fa fa-check"></i><b>1.1.4</b> Assessing the finite-sample performance of a statistical approach</a></li>
<li class="chapter" data-level="1.1.5" data-path="introduction.html"><a href="introduction.html#conducting-power-analyses"><i class="fa fa-check"></i><b>1.1.5</b> Conducting Power Analyses</a></li>
<li class="chapter" data-level="1.1.6" data-path="introduction.html"><a href="introduction.html#simulating-processess"><i class="fa fa-check"></i><b>1.1.6</b> Simulating processess</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#the-perils-of-simulation-as-evidence"><i class="fa fa-check"></i><b>1.2</b> The perils of simulation as evidence</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#simulating-to-learn"><i class="fa fa-check"></i><b>1.3</b> Simulating to learn</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i><b>1.4</b> Why R?</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#organization-of-the-text"><i class="fa fa-check"></i><b>1.5</b> Organization of the text</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html"><i class="fa fa-check"></i><b>2</b> Programming Preliminaries</a>
<ul>
<li class="chapter" data-level="2.1" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#welcome-to-the-tidyverse"><i class="fa fa-check"></i><b>2.1</b> Welcome to the tidyverse</a></li>
<li class="chapter" data-level="2.2" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#functions"><i class="fa fa-check"></i><b>2.2</b> Functions</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#rolling-your-own"><i class="fa fa-check"></i><b>2.2.1</b> Rolling your own</a></li>
<li class="chapter" data-level="2.2.2" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#a-dangerous-function"><i class="fa fa-check"></i><b>2.2.2</b> A dangerous function</a></li>
<li class="chapter" data-level="2.2.3" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#using-named-arguments"><i class="fa fa-check"></i><b>2.2.3</b> Using Named Arguments</a></li>
<li class="chapter" data-level="2.2.4" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#argument-defaults"><i class="fa fa-check"></i><b>2.2.4</b> Argument Defaults</a></li>
<li class="chapter" data-level="2.2.5" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#function-skeletons"><i class="fa fa-check"></i><b>2.2.5</b> Function skeletons</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#pipe-dreams"><i class="fa fa-check"></i><b>2.3</b> <code>\&gt;</code> (Pipe) dreams</a></li>
<li class="chapter" data-level="2.4" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#recipes-versus-patterns"><i class="fa fa-check"></i><b>2.4</b> Recipes versus Patterns</a></li>
<li class="chapter" data-level="2.5" data-path="programming-preliminaries.html"><a href="programming-preliminaries.html#exercises"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="t-test-simulation.html"><a href="t-test-simulation.html"><i class="fa fa-check"></i><b>3</b> An initial simulation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="t-test-simulation.html"><a href="t-test-simulation.html#simulating-a-single-scenario"><i class="fa fa-check"></i><b>3.1</b> Simulating a single scenario</a></li>
<li class="chapter" data-level="3.2" data-path="t-test-simulation.html"><a href="t-test-simulation.html#a-non-normal-population-distribution"><i class="fa fa-check"></i><b>3.2</b> A non-normal population distribution</a></li>
<li class="chapter" data-level="3.3" data-path="t-test-simulation.html"><a href="t-test-simulation.html#simulating-across-different-scenarios"><i class="fa fa-check"></i><b>3.3</b> Simulating across different scenarios</a></li>
<li class="chapter" data-level="3.4" data-path="t-test-simulation.html"><a href="t-test-simulation.html#extending-the-simulation-design"><i class="fa fa-check"></i><b>3.4</b> Extending the simulation design</a></li>
<li class="chapter" data-level="3.5" data-path="t-test-simulation.html"><a href="t-test-simulation.html#exercises-1"><i class="fa fa-check"></i><b>3.5</b> Exercises</a></li>
</ul></li>
<li class="part"><span><b>II Structure and Mechanics of a Simulation Study</b></span></li>
<li class="chapter" data-level="4" data-path="simulation-structure.html"><a href="simulation-structure.html"><i class="fa fa-check"></i><b>4</b> Structure of a simulation study</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulation-structure.html"><a href="simulation-structure.html#general-structure-of-a-simulation"><i class="fa fa-check"></i><b>4.1</b> General structure of a simulation</a></li>
<li class="chapter" data-level="4.2" data-path="simulation-structure.html"><a href="simulation-structure.html#tidy-modular-simulations"><i class="fa fa-check"></i><b>4.2</b> Tidy, modular simulations</a></li>
<li class="chapter" data-level="4.3" data-path="simulation-structure.html"><a href="simulation-structure.html#skeleton-of-a-simulation-study"><i class="fa fa-check"></i><b>4.3</b> Skeleton of a simulation study</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simulation-structure.html"><a href="simulation-structure.html#data-generating-process"><i class="fa fa-check"></i><b>4.3.1</b> Data-Generating Process</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulation-structure.html"><a href="simulation-structure.html#data-analysis-procedure"><i class="fa fa-check"></i><b>4.3.2</b> Data Analysis Procedure</a></li>
<li class="chapter" data-level="4.3.3" data-path="simulation-structure.html"><a href="simulation-structure.html#repetition"><i class="fa fa-check"></i><b>4.3.3</b> Repetition</a></li>
<li class="chapter" data-level="4.3.4" data-path="simulation-structure.html"><a href="simulation-structure.html#performance-summaries"><i class="fa fa-check"></i><b>4.3.4</b> Performance summaries</a></li>
<li class="chapter" data-level="4.3.5" data-path="simulation-structure.html"><a href="simulation-structure.html#multifactor-simulations"><i class="fa fa-check"></i><b>4.3.5</b> Multifactor simulations</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simulation-structure.html"><a href="simulation-structure.html#exercises-2"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="case-ANOVA.html"><a href="case-ANOVA.html"><i class="fa fa-check"></i><b>5</b> Case Study: Heteroskedastic ANOVA and Welch</a>
<ul>
<li class="chapter" data-level="5.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#case-anova-DGP"><i class="fa fa-check"></i><b>5.1</b> The data-generating model</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#now-make-a-function"><i class="fa fa-check"></i><b>5.1.1</b> Now make a function</a></li>
<li class="chapter" data-level="5.1.2" data-path="case-ANOVA.html"><a href="case-ANOVA.html#cautious-coding"><i class="fa fa-check"></i><b>5.1.2</b> Cautious coding</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="case-ANOVA.html"><a href="case-ANOVA.html#ANOVA-hypothesis-testing-function"><i class="fa fa-check"></i><b>5.2</b> The hypothesis testing procedures</a></li>
<li class="chapter" data-level="5.3" data-path="case-ANOVA.html"><a href="case-ANOVA.html#running-the-simulation"><i class="fa fa-check"></i><b>5.3</b> Running the simulation</a></li>
<li class="chapter" data-level="5.4" data-path="case-ANOVA.html"><a href="case-ANOVA.html#summarizing-test-performance"><i class="fa fa-check"></i><b>5.4</b> Summarizing test performance</a></li>
<li class="chapter" data-level="5.5" data-path="case-ANOVA.html"><a href="case-ANOVA.html#exAnovaExercises"><i class="fa fa-check"></i><b>5.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="case-ANOVA.html"><a href="case-ANOVA.html#BF-other-alphas"><i class="fa fa-check"></i><b>5.5.1</b> Other <span class="math inline">\(\alpha\)</span>’s</a></li>
<li class="chapter" data-level="5.5.2" data-path="case-ANOVA.html"><a href="case-ANOVA.html#BF-compare-results"><i class="fa fa-check"></i><b>5.5.2</b> Compare results</a></li>
<li class="chapter" data-level="5.5.3" data-path="case-ANOVA.html"><a href="case-ANOVA.html#BF-power"><i class="fa fa-check"></i><b>5.5.3</b> Power</a></li>
<li class="chapter" data-level="5.5.4" data-path="case-ANOVA.html"><a href="case-ANOVA.html#BF-wide-long"><i class="fa fa-check"></i><b>5.5.4</b> Wide or long?</a></li>
<li class="chapter" data-level="5.5.5" data-path="case-ANOVA.html"><a href="case-ANOVA.html#BF-other-tests"><i class="fa fa-check"></i><b>5.5.5</b> Other tests</a></li>
<li class="chapter" data-level="5.5.6" data-path="case-ANOVA.html"><a href="case-ANOVA.html#methodological-extensions"><i class="fa fa-check"></i><b>5.5.6</b> Methodological extensions</a></li>
<li class="chapter" data-level="5.5.7" data-path="case-ANOVA.html"><a href="case-ANOVA.html#power-analysis"><i class="fa fa-check"></i><b>5.5.7</b> Power analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-generating-processes.html"><a href="data-generating-processes.html"><i class="fa fa-check"></i><b>6</b> Data-generating processes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-generating-processes.html"><a href="data-generating-processes.html#DGP-examples"><i class="fa fa-check"></i><b>6.1</b> Examples</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-generating-processes.html"><a href="data-generating-processes.html#ANOVA-example"><i class="fa fa-check"></i><b>6.1.1</b> Example 1: One-way analysis of variance</a></li>
<li class="chapter" data-level="6.1.2" data-path="data-generating-processes.html"><a href="data-generating-processes.html#BVPois-example"><i class="fa fa-check"></i><b>6.1.2</b> Example 2: Bivariate Poisson model</a></li>
<li class="chapter" data-level="6.1.3" data-path="data-generating-processes.html"><a href="data-generating-processes.html#CRT-example"><i class="fa fa-check"></i><b>6.1.3</b> Example 3: Hierarchical linear model for a cluster-randomized trial</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-generating-processes.html"><a href="data-generating-processes.html#components-of-a-dgp"><i class="fa fa-check"></i><b>6.2</b> Components of a DGP</a></li>
<li class="chapter" data-level="6.3" data-path="data-generating-processes.html"><a href="data-generating-processes.html#DGP-functions"><i class="fa fa-check"></i><b>6.3</b> A statistical model is a recipe for data generation</a></li>
<li class="chapter" data-level="6.4" data-path="data-generating-processes.html"><a href="data-generating-processes.html#DGP-plotting"><i class="fa fa-check"></i><b>6.4</b> Plot the artificial data</a></li>
<li class="chapter" data-level="6.5" data-path="data-generating-processes.html"><a href="data-generating-processes.html#check-the-data-generating-function"><i class="fa fa-check"></i><b>6.5</b> Check the data-generating function</a></li>
<li class="chapter" data-level="6.6" data-path="data-generating-processes.html"><a href="data-generating-processes.html#case-cluster"><i class="fa fa-check"></i><b>6.6</b> Example: Simulating clustered data</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="data-generating-processes.html"><a href="data-generating-processes.html#a-design-decision-what-do-we-want-to-manipulate"><i class="fa fa-check"></i><b>6.6.1</b> A design decision: What do we want to manipulate?</a></li>
<li class="chapter" data-level="6.6.2" data-path="data-generating-processes.html"><a href="data-generating-processes.html#a-model-for-a-cluster-rct"><i class="fa fa-check"></i><b>6.6.2</b> A model for a cluster RCT</a></li>
<li class="chapter" data-level="6.6.3" data-path="data-generating-processes.html"><a href="data-generating-processes.html#from-equations-to-code"><i class="fa fa-check"></i><b>6.6.3</b> From equations to code</a></li>
<li class="chapter" data-level="6.6.4" data-path="data-generating-processes.html"><a href="data-generating-processes.html#DGP-standardization"><i class="fa fa-check"></i><b>6.6.4</b> Standardization in the DGP</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="data-generating-processes.html"><a href="data-generating-processes.html#three-parameter-IRT"><i class="fa fa-check"></i><b>6.7</b> Sometimes a DGP is all you need</a></li>
<li class="chapter" data-level="6.8" data-path="data-generating-processes.html"><a href="data-generating-processes.html#more-to-explore"><i class="fa fa-check"></i><b>6.8</b> More to explore</a></li>
<li class="chapter" data-level="6.9" data-path="data-generating-processes.html"><a href="data-generating-processes.html#exercises-3"><i class="fa fa-check"></i><b>6.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="data-generating-processes.html"><a href="data-generating-processes.html#Welch-t-dgp"><i class="fa fa-check"></i><b>6.9.1</b> The Welch test on a shifted-and-scaled <span class="math inline">\(t\)</span> distribution</a></li>
<li class="chapter" data-level="6.9.2" data-path="data-generating-processes.html"><a href="data-generating-processes.html#plot-the-bivariate-poisson"><i class="fa fa-check"></i><b>6.9.2</b> Plot the bivariate Poisson</a></li>
<li class="chapter" data-level="6.9.3" data-path="data-generating-processes.html"><a href="data-generating-processes.html#BVP-check"><i class="fa fa-check"></i><b>6.9.3</b> Check the bivariate Poisson function</a></li>
<li class="chapter" data-level="6.9.4" data-path="data-generating-processes.html"><a href="data-generating-processes.html#BVP-error"><i class="fa fa-check"></i><b>6.9.4</b> Add error-catching to the bivariate Poisson function</a></li>
<li class="chapter" data-level="6.9.5" data-path="data-generating-processes.html"><a href="data-generating-processes.html#BVNB1"><i class="fa fa-check"></i><b>6.9.5</b> A bivariate negative binomial distribution</a></li>
<li class="chapter" data-level="6.9.6" data-path="data-generating-processes.html"><a href="data-generating-processes.html#BVNB2"><i class="fa fa-check"></i><b>6.9.6</b> Another bivariate negative binomial distribution</a></li>
<li class="chapter" data-level="6.9.7" data-path="data-generating-processes.html"><a href="data-generating-processes.html#cluster-RCT-plot"><i class="fa fa-check"></i><b>6.9.7</b> Plot the data from a cluster-randomized trial</a></li>
<li class="chapter" data-level="6.9.8" data-path="data-generating-processes.html"><a href="data-generating-processes.html#cluster-RCT-checks"><i class="fa fa-check"></i><b>6.9.8</b> Checking the Cluster RCT DGP</a></li>
<li class="chapter" data-level="6.9.9" data-path="data-generating-processes.html"><a href="data-generating-processes.html#cluster-RCT-heterogeneity"><i class="fa fa-check"></i><b>6.9.9</b> More school-level variation</a></li>
<li class="chapter" data-level="6.9.10" data-path="data-generating-processes.html"><a href="data-generating-processes.html#cluster-RCT-baseline"><i class="fa fa-check"></i><b>6.9.10</b> Cluster-randomized trial with baseline predictors</a></li>
<li class="chapter" data-level="6.9.11" data-path="data-generating-processes.html"><a href="data-generating-processes.html#IRT-DGP-parameters"><i class="fa fa-check"></i><b>6.9.11</b> 3-parameter IRT datasets</a></li>
<li class="chapter" data-level="6.9.12" data-path="data-generating-processes.html"><a href="data-generating-processes.html#IRT-DGP-checking"><i class="fa fa-check"></i><b>6.9.12</b> Check the 3-parameter IRT DGP</a></li>
<li class="chapter" data-level="6.9.13" data-path="data-generating-processes.html"><a href="data-generating-processes.html#IRT-DGP-breaking"><i class="fa fa-check"></i><b>6.9.13</b> Explore the 3-parameter IRT model</a></li>
<li class="chapter" data-level="6.9.14" data-path="data-generating-processes.html"><a href="data-generating-processes.html#meta-regression-DGP"><i class="fa fa-check"></i><b>6.9.14</b> Random effects meta-regression</a></li>
<li class="chapter" data-level="6.9.15" data-path="data-generating-processes.html"><a href="data-generating-processes.html#Vevea-Hedges-DGP"><i class="fa fa-check"></i><b>6.9.15</b> Meta-regression with selective reporting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estimation-procedures.html"><a href="estimation-procedures.html"><i class="fa fa-check"></i><b>7</b> Estimation procedures</a>
<ul>
<li class="chapter" data-level="7.1" data-path="estimation-procedures.html"><a href="estimation-procedures.html#estimation-functions"><i class="fa fa-check"></i><b>7.1</b> Writing estimation functions</a></li>
<li class="chapter" data-level="7.2" data-path="estimation-procedures.html"><a href="estimation-procedures.html#multiple-estimation-procedures"><i class="fa fa-check"></i><b>7.2</b> Including Multiple Data Analysis Procedures</a></li>
<li class="chapter" data-level="7.3" data-path="estimation-procedures.html"><a href="estimation-procedures.html#validating-estimation-function"><i class="fa fa-check"></i><b>7.3</b> Validating an Estimation Function</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="estimation-procedures.html"><a href="estimation-procedures.html#checking-against-existing-implementations"><i class="fa fa-check"></i><b>7.3.1</b> Checking against existing implementations</a></li>
<li class="chapter" data-level="7.3.2" data-path="estimation-procedures.html"><a href="estimation-procedures.html#checking-novel-procedures"><i class="fa fa-check"></i><b>7.3.2</b> Checking novel procedures</a></li>
<li class="chapter" data-level="7.3.3" data-path="estimation-procedures.html"><a href="estimation-procedures.html#checking-with-simulations"><i class="fa fa-check"></i><b>7.3.3</b> Checking with simulations</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="estimation-procedures.html"><a href="estimation-procedures.html#error-handling"><i class="fa fa-check"></i><b>7.4</b> Handling errors, warnings, and other hiccups</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="estimation-procedures.html"><a href="estimation-procedures.html#capturing-errors-and-warnings"><i class="fa fa-check"></i><b>7.4.1</b> Capturing errors and warnings</a></li>
<li class="chapter" data-level="7.4.2" data-path="estimation-procedures.html"><a href="estimation-procedures.html#adapting-for-errors"><i class="fa fa-check"></i><b>7.4.2</b> Adapting estimators for errors and warnings</a></li>
<li class="chapter" data-level="7.4.3" data-path="estimation-procedures.html"><a href="estimation-procedures.html#the-safely-option"><i class="fa fa-check"></i><b>7.4.3</b> The <code>safely()</code> option</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="estimation-procedures.html"><a href="estimation-procedures.html#exercises-4"><i class="fa fa-check"></i><b>7.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="estimation-procedures.html"><a href="estimation-procedures.html#BFFs-forever"><i class="fa fa-check"></i><b>7.5.1</b> More Heteroskedastic ANOVA</a></li>
<li class="chapter" data-level="7.5.2" data-path="estimation-procedures.html"><a href="estimation-procedures.html#contingent-testing"><i class="fa fa-check"></i><b>7.5.2</b> Contingent testing</a></li>
<li class="chapter" data-level="7.5.3" data-path="estimation-procedures.html"><a href="estimation-procedures.html#cross-check-CRT-estimators"><i class="fa fa-check"></i><b>7.5.3</b> Check the cluster-RCT functions</a></li>
<li class="chapter" data-level="7.5.4" data-path="estimation-procedures.html"><a href="estimation-procedures.html#CRT-ANCOVA-estimators"><i class="fa fa-check"></i><b>7.5.4</b> Extending the cluster-RCT functions</a></li>
<li class="chapter" data-level="7.5.5" data-path="estimation-procedures.html"><a href="estimation-procedures.html#contingent-estimator-processing"><i class="fa fa-check"></i><b>7.5.5</b> Contingent estimator processing</a></li>
<li class="chapter" data-level="7.5.6" data-path="estimation-procedures.html"><a href="estimation-procedures.html#IRT-3PL-estimation"><i class="fa fa-check"></i><b>7.5.6</b> Estimating 3-parameter item response theory models</a></li>
<li class="chapter" data-level="7.5.7" data-path="estimation-procedures.html"><a href="estimation-procedures.html#Vevea-Hedges-estimation"><i class="fa fa-check"></i><b>7.5.7</b> Meta-regression with selective reporting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html"><i class="fa fa-check"></i><b>8</b> Running the Simulation Process</a>
<ul>
<li class="chapter" data-level="8.1" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#repeating-oneself"><i class="fa fa-check"></i><b>8.1</b> Repeating oneself</a></li>
<li class="chapter" data-level="8.2" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#one-run-at-a-time"><i class="fa fa-check"></i><b>8.2</b> One run at a time</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#one-run-reparameterization"><i class="fa fa-check"></i><b>8.2.1</b> Reparameterizing</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#bundle-sim-demo"><i class="fa fa-check"></i><b>8.3</b> Bundling simulations with <code>simhelpers</code></a></li>
<li class="chapter" data-level="8.4" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#seeds-and-pseudo-RNGs"><i class="fa fa-check"></i><b>8.4</b> Seeds and pseudo-random number generators</a></li>
<li class="chapter" data-level="8.5" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#exercises-5"><i class="fa fa-check"></i><b>8.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#Welch-simulation"><i class="fa fa-check"></i><b>8.5.1</b> Welch simulations</a></li>
<li class="chapter" data-level="8.5.2" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#Pearson-sampling-distributions"><i class="fa fa-check"></i><b>8.5.2</b> Compare sampling distributions of Pearson’s correlation coefficients</a></li>
<li class="chapter" data-level="8.5.3" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#reparameterization-redux"><i class="fa fa-check"></i><b>8.5.3</b> Reparameterization, redux</a></li>
<li class="chapter" data-level="8.5.4" data-path="running-the-simulation-process.html"><a href="running-the-simulation-process.html#fancy-cluster-RCT-sims"><i class="fa fa-check"></i><b>8.5.4</b> Fancy clustered RCT simulations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="performance-measures.html"><a href="performance-measures.html"><i class="fa fa-check"></i><b>9</b> Performance Measures</a>
<ul>
<li class="chapter" data-level="9.1" data-path="performance-measures.html"><a href="performance-measures.html#assessing-point-estimators"><i class="fa fa-check"></i><b>9.1</b> Measures for Point Estimators</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="performance-measures.html"><a href="performance-measures.html#clusterRCTperformance"><i class="fa fa-check"></i><b>9.1.1</b> Comparing the Performance of the Cluster RCT Estimation Procedures</a></li>
<li class="chapter" data-level="9.1.2" data-path="performance-measures.html"><a href="performance-measures.html#less-conventional-measures"><i class="fa fa-check"></i><b>9.1.2</b> Less Conventional Performance Measures</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="performance-measures.html"><a href="performance-measures.html#measures-for-variance-estimators"><i class="fa fa-check"></i><b>9.2</b> Measures for Variance Estimators</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="performance-measures.html"><a href="performance-measures.html#satterthwaite-degrees-of-freedom"><i class="fa fa-check"></i><b>9.2.1</b> Satterthwaite degrees of freedom</a></li>
<li class="chapter" data-level="9.2.2" data-path="performance-measures.html"><a href="performance-measures.html#assessing-ses-for-the-cluster-rct-simulation"><i class="fa fa-check"></i><b>9.2.2</b> Assessing SEs for the Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="performance-measures.html"><a href="performance-measures.html#measures-for-confidence-intervals"><i class="fa fa-check"></i><b>9.3</b> Measures for Confidence Intervals</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="performance-measures.html"><a href="performance-measures.html#cluster-RCT-CI-coverage"><i class="fa fa-check"></i><b>9.3.1</b> Confidence Intervals in the Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="performance-measures.html"><a href="performance-measures.html#assessing-inferential-procedures"><i class="fa fa-check"></i><b>9.4</b> Measures for Inferential Procedures (Hypothesis Tests)</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="performance-measures.html"><a href="performance-measures.html#validity"><i class="fa fa-check"></i><b>9.4.1</b> Validity</a></li>
<li class="chapter" data-level="9.4.2" data-path="performance-measures.html"><a href="performance-measures.html#power"><i class="fa fa-check"></i><b>9.4.2</b> Power</a></li>
<li class="chapter" data-level="9.4.3" data-path="performance-measures.html"><a href="performance-measures.html#rejection-rates"><i class="fa fa-check"></i><b>9.4.3</b> Rejection Rates</a></li>
<li class="chapter" data-level="9.4.4" data-path="performance-measures.html"><a href="performance-measures.html#inference-in-the-cluster-rct-simulation"><i class="fa fa-check"></i><b>9.4.4</b> Inference in the Cluster RCT Simulation</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="performance-measures.html"><a href="performance-measures.html#sec-relative-performance"><i class="fa fa-check"></i><b>9.5</b> Relative or Absolute Measures?</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="performance-measures.html"><a href="performance-measures.html#performance-relative-to-a-benchmark-estimator"><i class="fa fa-check"></i><b>9.5.1</b> Performance relative to a benchmark estimator</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="performance-measures.html"><a href="performance-measures.html#implicit-estimands"><i class="fa fa-check"></i><b>9.6</b> Estimands Not Represented By a Parameter</a></li>
<li class="chapter" data-level="9.7" data-path="performance-measures.html"><a href="performance-measures.html#MCSE"><i class="fa fa-check"></i><b>9.7</b> Uncertainty in Performance Estimates (the Monte Carlo Standard Error)</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="performance-measures.html"><a href="performance-measures.html#conventional-measures-for-point-estimators"><i class="fa fa-check"></i><b>9.7.1</b> Conventional measures for point estimators</a></li>
<li class="chapter" data-level="9.7.2" data-path="performance-measures.html"><a href="performance-measures.html#less-conventional-measures-for-point-estimators"><i class="fa fa-check"></i><b>9.7.2</b> Less conventional measures for point estimators</a></li>
<li class="chapter" data-level="9.7.3" data-path="performance-measures.html"><a href="performance-measures.html#MCSE-for-relative-variance"><i class="fa fa-check"></i><b>9.7.3</b> MCSE for Relative Variance Estimators</a></li>
<li class="chapter" data-level="9.7.4" data-path="performance-measures.html"><a href="performance-measures.html#mcse-for-confidence-intervals-and-hypothesis-tests"><i class="fa fa-check"></i><b>9.7.4</b> MCSE for Confidence Intervals and Hypothesis Tests</a></li>
<li class="chapter" data-level="9.7.5" data-path="performance-measures.html"><a href="performance-measures.html#calculating-mcses-with-the-simhelpers-package"><i class="fa fa-check"></i><b>9.7.5</b> Calculating MCSEs With the <code>simhelpers</code> Package</a></li>
<li class="chapter" data-level="9.7.6" data-path="performance-measures.html"><a href="performance-measures.html#mcse-calculation-in-our-cluster-rct-example"><i class="fa fa-check"></i><b>9.7.6</b> MCSE Calculation in our Cluster RCT Example</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="performance-measures.html"><a href="performance-measures.html#summary-of-peformance-measures"><i class="fa fa-check"></i><b>9.8</b> Summary of Peformance Measures</a></li>
<li class="chapter" data-level="9.9" data-path="performance-measures.html"><a href="performance-measures.html#concluding-thoughts"><i class="fa fa-check"></i><b>9.9</b> Concluding thoughts</a></li>
<li class="chapter" data-level="9.10" data-path="performance-measures.html"><a href="performance-measures.html#exercises-6"><i class="fa fa-check"></i><b>9.10</b> Exercises</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="performance-measures.html"><a href="performance-measures.html#Brown-Forsythe-performance"><i class="fa fa-check"></i><b>9.10.1</b> Brown and Forsythe (1974) results</a></li>
<li class="chapter" data-level="9.10.2" data-path="performance-measures.html"><a href="performance-measures.html#size-adjusted-power"><i class="fa fa-check"></i><b>9.10.2</b> Size-adjusted power</a></li>
<li class="chapter" data-level="9.10.3" data-path="performance-measures.html"><a href="performance-measures.html#three-correlation-estimators"><i class="fa fa-check"></i><b>9.10.3</b> Three correlation estimators</a></li>
<li class="chapter" data-level="9.10.4" data-path="performance-measures.html"><a href="performance-measures.html#cluster-RCT-t-confidence-intervals"><i class="fa fa-check"></i><b>9.10.4</b> Confidence interval comparison</a></li>
<li class="chapter" data-level="9.10.5" data-path="performance-measures.html"><a href="performance-measures.html#jackknife-MCSE"><i class="fa fa-check"></i><b>9.10.5</b> Jackknife calculation of MCSEs for RMSE</a></li>
<li class="chapter" data-level="9.10.6" data-path="performance-measures.html"><a href="performance-measures.html#jackknife-MCSE-ratio"><i class="fa fa-check"></i><b>9.10.6</b> Jackknife calculation of MCSEs for RMSE ratios</a></li>
<li class="chapter" data-level="9.10.7" data-path="performance-measures.html"><a href="performance-measures.html#cluster-RCT-SPATE"><i class="fa fa-check"></i><b>9.10.7</b> Distribution theory for person-level average treatment effects</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Systematic Simulations</b></span></li>
<li class="chapter" data-level="10" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html"><i class="fa fa-check"></i><b>10</b> Simulating across multiple scenarios</a>
<ul>
<li class="chapter" data-level="10.1" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#simulating-across-levels-of-a-single-factor"><i class="fa fa-check"></i><b>10.1</b> Simulating across levels of a single factor</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#a-performance-summary-function"><i class="fa fa-check"></i><b>10.1.1</b> A performance summary function</a></li>
<li class="chapter" data-level="10.1.2" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#adding-performance-calculations-to-the-simulation-driver"><i class="fa fa-check"></i><b>10.1.2</b> Adding performance calculations to the simulation driver</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#simulating-across-multiple-factors"><i class="fa fa-check"></i><b>10.2</b> Simulating across multiple factors</a></li>
<li class="chapter" data-level="10.3" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#using-pmap-to-run-multifactor-simulations"><i class="fa fa-check"></i><b>10.3</b> Using pmap to run multifactor simulations</a></li>
<li class="chapter" data-level="10.4" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#when-to-calculate-performance-metrics"><i class="fa fa-check"></i><b>10.4</b> When to calculate performance metrics</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#aggregate-as-you-simulate-inside"><i class="fa fa-check"></i><b>10.4.1</b> Aggregate as you simulate (inside)</a></li>
<li class="chapter" data-level="10.4.2" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#keep-all-simulation-runs-outside"><i class="fa fa-check"></i><b>10.4.2</b> Keep all simulation runs (outside)</a></li>
<li class="chapter" data-level="10.4.3" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#getting-raw-results-ready-for-analysis"><i class="fa fa-check"></i><b>10.4.3</b> Getting raw results ready for analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#summary"><i class="fa fa-check"></i><b>10.5</b> Summary</a></li>
<li class="chapter" data-level="10.6" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#exercises-7"><i class="fa fa-check"></i><b>10.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#extending-Brown-Forsythe-power"><i class="fa fa-check"></i><b>10.6.1</b> Extending Brown and Forsythe</a></li>
<li class="chapter" data-level="10.6.2" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#exercise:trimmed-mean"><i class="fa fa-check"></i><b>10.6.2</b> Comparing the trimmed mean, median and mean</a></li>
<li class="chapter" data-level="10.6.3" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#exercise:multifactor-latent-correlation"><i class="fa fa-check"></i><b>10.6.3</b> Estimating latent correlations</a></li>
<li class="chapter" data-level="10.6.4" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#exercise:multifactor-meta-regression"><i class="fa fa-check"></i><b>10.6.4</b> Meta-regression</a></li>
<li class="chapter" data-level="10.6.5" data-path="simulating-multiple-scenarios.html"><a href="simulating-multiple-scenarios.html#exercise:examine-a-multifactor-simulation-design"><i class="fa fa-check"></i><b>10.6.5</b> Examine a multifactor simulation design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="designing-multifactor-simulations.html"><a href="designing-multifactor-simulations.html"><i class="fa fa-check"></i><b>11</b> Designing multifactor simulations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="designing-multifactor-simulations.html"><a href="designing-multifactor-simulations.html#choosing-parameter-combinations"><i class="fa fa-check"></i><b>11.1</b> Choosing parameter combinations</a></li>
<li class="chapter" data-level="11.2" data-path="designing-multifactor-simulations.html"><a href="designing-multifactor-simulations.html#case-study-a-multifactor-evaluation-of-cluster-rct-estimators"><i class="fa fa-check"></i><b>11.2</b> Case Study: A multifactor evaluation of cluster RCT estimators</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="designing-multifactor-simulations.html"><a href="designing-multifactor-simulations.html#choosing-parameters-for-the-clustered-rct"><i class="fa fa-check"></i><b>11.2.1</b> Choosing parameters for the Clustered RCT</a></li>
<li class="chapter" data-level="11.2.2" data-path="designing-multifactor-simulations.html"><a href="designing-multifactor-simulations.html#redundant-factor-combinations"><i class="fa fa-check"></i><b>11.2.2</b> Redundant factor combinations</a></li>
<li class="chapter" data-level="11.2.3" data-path="designing-multifactor-simulations.html"><a href="designing-multifactor-simulations.html#running-the-simulations"><i class="fa fa-check"></i><b>11.2.3</b> Running the simulations</a></li>
<li class="chapter" data-level="11.2.4" data-path="designing-multifactor-simulations.html"><a href="designing-multifactor-simulations.html#calculating-performance-metrics"><i class="fa fa-check"></i><b>11.2.4</b> Calculating performance metrics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="presentation-of-results.html"><a href="presentation-of-results.html"><i class="fa fa-check"></i><b>12</b> Exploring and presenting simulation results</a>
<ul>
<li class="chapter" data-level="12.1" data-path="presentation-of-results.html"><a href="presentation-of-results.html#tabulation"><i class="fa fa-check"></i><b>12.1</b> Tabulation</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="presentation-of-results.html"><a href="presentation-of-results.html#example-estimators-of-treatment-variation"><i class="fa fa-check"></i><b>12.1.1</b> Example: estimators of treatment variation</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="presentation-of-results.html"><a href="presentation-of-results.html#visualization"><i class="fa fa-check"></i><b>12.2</b> Visualization</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="presentation-of-results.html"><a href="presentation-of-results.html#example-0-rmse-in-cluster-rcts"><i class="fa fa-check"></i><b>12.2.1</b> Example 0: RMSE in Cluster RCTs</a></li>
<li class="chapter" data-level="12.2.2" data-path="presentation-of-results.html"><a href="presentation-of-results.html#example-1-biserial-correlation-estimation"><i class="fa fa-check"></i><b>12.2.2</b> Example 1: Biserial correlation estimation</a></li>
<li class="chapter" data-level="12.2.3" data-path="presentation-of-results.html"><a href="presentation-of-results.html#example-2-variance-estimation-and-meta-regression"><i class="fa fa-check"></i><b>12.2.3</b> Example 2: Variance estimation and Meta-regression</a></li>
<li class="chapter" data-level="12.2.4" data-path="presentation-of-results.html"><a href="presentation-of-results.html#example-3-heat-maps-of-coverage"><i class="fa fa-check"></i><b>12.2.4</b> Example 3: Heat maps of coverage</a></li>
<li class="chapter" data-level="12.2.5" data-path="presentation-of-results.html"><a href="presentation-of-results.html#example-4-relative-performance-of-treatment-effect-estimators"><i class="fa fa-check"></i><b>12.2.5</b> Example 4: Relative performance of treatment effect estimators</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="presentation-of-results.html"><a href="presentation-of-results.html#modeling"><i class="fa fa-check"></i><b>12.3</b> Modeling</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="presentation-of-results.html"><a href="presentation-of-results.html#example-1-biserial-revisited"><i class="fa fa-check"></i><b>12.3.1</b> Example 1: Biserial, revisited</a></li>
<li class="chapter" data-level="12.3.2" data-path="presentation-of-results.html"><a href="presentation-of-results.html#example-2-comparing-methods-for-cross-classified-data"><i class="fa fa-check"></i><b>12.3.2</b> Example 2: Comparing methods for cross-classified data</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="presentation-of-results.html"><a href="presentation-of-results.html#reporting"><i class="fa fa-check"></i><b>12.4</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="building-good-visualization.html"><a href="building-good-visualization.html"><i class="fa fa-check"></i><b>13</b> Building good visualizations</a>
<ul>
<li class="chapter" data-level="13.1" data-path="building-good-visualization.html"><a href="building-good-visualization.html#subsetting-and-many-small-multiples"><i class="fa fa-check"></i><b>13.1</b> Subsetting and Many Small Multiples</a></li>
<li class="chapter" data-level="13.2" data-path="building-good-visualization.html"><a href="building-good-visualization.html#bundling"><i class="fa fa-check"></i><b>13.2</b> Bundling</a></li>
<li class="chapter" data-level="13.3" data-path="building-good-visualization.html"><a href="building-good-visualization.html#aggregation"><i class="fa fa-check"></i><b>13.3</b> Aggregation</a></li>
<li class="chapter" data-level="13.4" data-path="building-good-visualization.html"><a href="building-good-visualization.html#comparing-true-ses-with-standardization"><i class="fa fa-check"></i><b>13.4</b> Comparing true SEs with standardization</a></li>
<li class="chapter" data-level="13.5" data-path="building-good-visualization.html"><a href="building-good-visualization.html#the-bias-se-rmse-plot"><i class="fa fa-check"></i><b>13.5</b> The Bias-SE-RMSE plot</a></li>
<li class="chapter" data-level="13.6" data-path="building-good-visualization.html"><a href="building-good-visualization.html#assessing-the-quality-of-the-estimated-ses"><i class="fa fa-check"></i><b>13.6</b> Assessing the quality of the estimated SEs</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="building-good-visualization.html"><a href="building-good-visualization.html#stability-of-estimated-ses"><i class="fa fa-check"></i><b>13.6.1</b> Stability of estimated SEs</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="building-good-visualization.html"><a href="building-good-visualization.html#assessing-confidence-intervals"><i class="fa fa-check"></i><b>13.7</b> Assessing confidence intervals</a></li>
<li class="chapter" data-level="13.8" data-path="building-good-visualization.html"><a href="building-good-visualization.html#exercises-8"><i class="fa fa-check"></i><b>13.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="building-good-visualization.html"><a href="building-good-visualization.html#assessing-uncertainty"><i class="fa fa-check"></i><b>13.8.1</b> Assessing uncertainty</a></li>
<li class="chapter" data-level="13.8.2" data-path="building-good-visualization.html"><a href="building-good-visualization.html#assessing-power"><i class="fa fa-check"></i><b>13.8.2</b> Assessing power</a></li>
<li class="chapter" data-level="13.8.3" data-path="building-good-visualization.html"><a href="building-good-visualization.html#going-deeper-with-coverage"><i class="fa fa-check"></i><b>13.8.3</b> Going deeper with coverage</a></li>
<li class="chapter" data-level="13.8.4" data-path="building-good-visualization.html"><a href="building-good-visualization.html#pearson-correlations-with-a-bivariate-poisson-distribution"><i class="fa fa-check"></i><b>13.8.4</b> Pearson correlations with a bivariate Poisson distribution</a></li>
<li class="chapter" data-level="13.8.5" data-path="building-good-visualization.html"><a href="building-good-visualization.html#making-another-plot-for-assessing-ses"><i class="fa fa-check"></i><b>13.8.5</b> Making another plot for assessing SEs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="special-topics-on-reporting-simulation-results.html"><a href="special-topics-on-reporting-simulation-results.html"><i class="fa fa-check"></i><b>14</b> Special Topics on Reporting Simulation Results</a>
<ul>
<li class="chapter" data-level="14.1" data-path="special-topics-on-reporting-simulation-results.html"><a href="special-topics-on-reporting-simulation-results.html#using-regression-to-analyze-simulation-results"><i class="fa fa-check"></i><b>14.1</b> Using regression to analyze simulation results</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="special-topics-on-reporting-simulation-results.html"><a href="special-topics-on-reporting-simulation-results.html#example-1-biserial-revisited-1"><i class="fa fa-check"></i><b>14.1.1</b> Example 1: Biserial, revisited</a></li>
<li class="chapter" data-level="14.1.2" data-path="special-topics-on-reporting-simulation-results.html"><a href="special-topics-on-reporting-simulation-results.html#example-2-cluster-rct-example-revisited"><i class="fa fa-check"></i><b>14.1.2</b> Example 2: Cluster RCT example, revisited</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="special-topics-on-reporting-simulation-results.html"><a href="special-topics-on-reporting-simulation-results.html#using-regression-trees-to-find-important-factors"><i class="fa fa-check"></i><b>14.2</b> Using regression trees to find important factors</a></li>
<li class="chapter" data-level="14.3" data-path="special-topics-on-reporting-simulation-results.html"><a href="special-topics-on-reporting-simulation-results.html#analyzing-results-with-few-iterations-per-scenario"><i class="fa fa-check"></i><b>14.3</b> Analyzing results with few iterations per scenario</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="special-topics-on-reporting-simulation-results.html"><a href="special-topics-on-reporting-simulation-results.html#example-clusterrct-with-only-100-replicates-per-scenario"><i class="fa fa-check"></i><b>14.3.1</b> Example: ClusterRCT with only 100 replicates per scenario</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="special-topics-on-reporting-simulation-results.html"><a href="special-topics-on-reporting-simulation-results.html#what-to-do-with-warnings-in-simulations"><i class="fa fa-check"></i><b>14.4</b> What to do with warnings in simulations</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html"><i class="fa fa-check"></i><b>15</b> Case study: Comparing different estimators</a>
<ul>
<li class="chapter" data-level="15.1" data-path="case-study-comparing-different-estimators.html"><a href="case-study-comparing-different-estimators.html#bias-variance-tradeoffs"><i class="fa fa-check"></i><b>15.1</b> Bias-variance tradeoffs</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html"><i class="fa fa-check"></i><b>16</b> Simulations as evidence</a>
<ul>
<li class="chapter" data-level="16.1" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#strategies-for-making-relevant-simulations"><i class="fa fa-check"></i><b>16.1</b> Strategies for making relevant simulations</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#break-symmetries-and-regularities"><i class="fa fa-check"></i><b>16.1.1</b> Break symmetries and regularities</a></li>
<li class="chapter" data-level="16.1.2" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#make-your-simulation-general-with-an-extensive-multi-factor-experiment"><i class="fa fa-check"></i><b>16.1.2</b> Make your simulation general with an extensive multi-factor experiment</a></li>
<li class="chapter" data-level="16.1.3" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#use-previously-published-simulations-to-beat-them-at-their-own-game"><i class="fa fa-check"></i><b>16.1.3</b> Use previously published simulations to beat them at their own game</a></li>
<li class="chapter" data-level="16.1.4" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#calibrate-simulation-factors-to-real-data"><i class="fa fa-check"></i><b>16.1.4</b> Calibrate simulation factors to real data</a></li>
<li class="chapter" data-level="16.1.5" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#use-real-data-to-obtain-directly"><i class="fa fa-check"></i><b>16.1.5</b> Use real data to obtain directly</a></li>
<li class="chapter" data-level="16.1.6" data-path="simulations-as-evidence.html"><a href="simulations-as-evidence.html#fully-calibrated-simulations"><i class="fa fa-check"></i><b>16.1.6</b> Fully calibrated simulations</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Computational Considerations</b></span></li>
<li class="chapter" data-level="17" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html"><i class="fa fa-check"></i><b>17</b> Organizing a simulation project</a>
<ul>
<li class="chapter" data-level="17.1" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html#well-structured-r-scripts"><i class="fa fa-check"></i><b>17.1</b> Well structured R scripts</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html#about-source-command"><i class="fa fa-check"></i><b>17.1.1</b> The source command</a></li>
<li class="chapter" data-level="17.1.2" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html#putting-headers-in-your-.r-file"><i class="fa fa-check"></i><b>17.1.2</b> Putting headers in your .R file</a></li>
<li class="chapter" data-level="17.1.3" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html#about-keeping-tests-with-FALSE"><i class="fa fa-check"></i><b>17.1.3</b> Storing testing code in your scripts</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html#principled-directory-structures"><i class="fa fa-check"></i><b>17.2</b> Principled directory structures</a></li>
<li class="chapter" data-level="17.3" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html#saving-files"><i class="fa fa-check"></i><b>17.3</b> Saving simulation results</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html#saving-simulations-in-general"><i class="fa fa-check"></i><b>17.3.1</b> Saving simulations in general</a></li>
<li class="chapter" data-level="17.3.2" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html#saving-simulations-as-you-go"><i class="fa fa-check"></i><b>17.3.2</b> Saving simulations as you go</a></li>
<li class="chapter" data-level="17.3.3" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html#dynamically-making-directories"><i class="fa fa-check"></i><b>17.3.3</b> Dynamically making directories</a></li>
<li class="chapter" data-level="17.3.4" data-path="organizing-a-simulation-project.html"><a href="organizing-a-simulation-project.html#loading-and-combining-files-of-simulation-results"><i class="fa fa-check"></i><b>17.3.4</b> Loading and combining files of simulation results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="parallel-processing.html"><a href="parallel-processing.html"><i class="fa fa-check"></i><b>18</b> Parallel Processing</a>
<ul>
<li class="chapter" data-level="18.1" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-on-your-computer"><i class="fa fa-check"></i><b>18.1</b> Parallel on your computer</a></li>
<li class="chapter" data-level="18.2" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-on-a-virtual-machine"><i class="fa fa-check"></i><b>18.2</b> Parallel on a virtual machine</a></li>
<li class="chapter" data-level="18.3" data-path="parallel-processing.html"><a href="parallel-processing.html#parallel-on-a-cluster"><i class="fa fa-check"></i><b>18.3</b> Parallel on a cluster</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="parallel-processing.html"><a href="parallel-processing.html#what-is-a-command-line-interface"><i class="fa fa-check"></i><b>18.3.1</b> What is a command-line interface?</a></li>
<li class="chapter" data-level="18.3.2" data-path="parallel-processing.html"><a href="parallel-processing.html#running-a-job-on-a-cluster"><i class="fa fa-check"></i><b>18.3.2</b> Running a job on a cluster</a></li>
<li class="chapter" data-level="18.3.3" data-path="parallel-processing.html"><a href="parallel-processing.html#checking-on-a-job"><i class="fa fa-check"></i><b>18.3.3</b> Checking on a job</a></li>
<li class="chapter" data-level="18.3.4" data-path="parallel-processing.html"><a href="parallel-processing.html#running-lots-of-jobs-on-a-cluster"><i class="fa fa-check"></i><b>18.3.4</b> Running lots of jobs on a cluster</a></li>
<li class="chapter" data-level="18.3.5" data-path="parallel-processing.html"><a href="parallel-processing.html#resources-for-harvards-odyssey"><i class="fa fa-check"></i><b>18.3.5</b> Resources for Harvard’s Odyssey</a></li>
<li class="chapter" data-level="18.3.6" data-path="parallel-processing.html"><a href="parallel-processing.html#acknowledgements-1"><i class="fa fa-check"></i><b>18.3.6</b> Acknowledgements</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="debugging-and-testing.html"><a href="debugging-and-testing.html"><i class="fa fa-check"></i><b>19</b> Debugging and Testing</a>
<ul>
<li class="chapter" data-level="19.1" data-path="debugging-and-testing.html"><a href="debugging-and-testing.html#about-print"><i class="fa fa-check"></i><b>19.1</b> Debugging with <code>print()</code></a></li>
<li class="chapter" data-level="19.2" data-path="debugging-and-testing.html"><a href="debugging-and-testing.html#about-browser-debugging"><i class="fa fa-check"></i><b>19.2</b> Debugging with <code>browser()</code></a></li>
<li class="chapter" data-level="19.3" data-path="debugging-and-testing.html"><a href="debugging-and-testing.html#debugging-with-debug"><i class="fa fa-check"></i><b>19.3</b> Debugging with <code>debug()</code></a></li>
<li class="chapter" data-level="19.4" data-path="debugging-and-testing.html"><a href="debugging-and-testing.html#about-stopifnot"><i class="fa fa-check"></i><b>19.4</b> Protecting functions with <code>stop()</code></a></li>
<li class="chapter" data-level="19.5" data-path="debugging-and-testing.html"><a href="debugging-and-testing.html#testing-code"><i class="fa fa-check"></i><b>19.5</b> Testing code</a></li>
</ul></li>
<li class="part"><span><b>V Complex Data Structures</b></span></li>
<li class="chapter" data-level="20" data-path="sec:power.html"><a href="sec:power.html"><i class="fa fa-check"></i><b>20</b> Using simulation as a power calculator</a>
<ul>
<li class="chapter" data-level="20.1" data-path="sec:power.html"><a href="sec:power.html#getting-design-parameters-from-pilot-data"><i class="fa fa-check"></i><b>20.1</b> Getting design parameters from pilot data</a></li>
<li class="chapter" data-level="20.2" data-path="sec:power.html"><a href="sec:power.html#the-data-generating-process"><i class="fa fa-check"></i><b>20.2</b> The data generating process</a></li>
<li class="chapter" data-level="20.3" data-path="sec:power.html"><a href="sec:power.html#running-the-simulation-1"><i class="fa fa-check"></i><b>20.3</b> Running the simulation</a></li>
<li class="chapter" data-level="20.4" data-path="sec:power.html"><a href="sec:power.html#evaluating-power"><i class="fa fa-check"></i><b>20.4</b> Evaluating power</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="sec:power.html"><a href="sec:power.html#checking-validity-of-our-models"><i class="fa fa-check"></i><b>20.4.1</b> Checking validity of our models</a></li>
<li class="chapter" data-level="20.4.2" data-path="sec:power.html"><a href="sec:power.html#assessing-precision-se"><i class="fa fa-check"></i><b>20.4.2</b> Assessing Precision (SE)</a></li>
<li class="chapter" data-level="20.4.3" data-path="sec:power.html"><a href="sec:power.html#assessing-power-1"><i class="fa fa-check"></i><b>20.4.3</b> Assessing power</a></li>
<li class="chapter" data-level="20.4.4" data-path="sec:power.html"><a href="sec:power.html#assessing-minimum-detectable-effects"><i class="fa fa-check"></i><b>20.4.4</b> Assessing Minimum Detectable Effects</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="sec:power.html"><a href="sec:power.html#power-for-multilevel-data"><i class="fa fa-check"></i><b>20.5</b> Power for Multilevel Data</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="potential-outcomes.html"><a href="potential-outcomes.html"><i class="fa fa-check"></i><b>21</b> Simulation under the Potential Outcomes Framework</a>
<ul>
<li class="chapter" data-level="21.1" data-path="potential-outcomes.html"><a href="potential-outcomes.html#finite-vs.-superpopulation-inference"><i class="fa fa-check"></i><b>21.1</b> Finite vs. Superpopulation inference</a></li>
<li class="chapter" data-level="21.2" data-path="potential-outcomes.html"><a href="potential-outcomes.html#data-generation-processes-for-potential-outcomes"><i class="fa fa-check"></i><b>21.2</b> Data generation processes for potential outcomes</a></li>
<li class="chapter" data-level="21.3" data-path="potential-outcomes.html"><a href="potential-outcomes.html#finite-sample-performance-measures"><i class="fa fa-check"></i><b>21.3</b> Finite sample performance measures</a></li>
<li class="chapter" data-level="21.4" data-path="potential-outcomes.html"><a href="potential-outcomes.html#nested-finite-simulation-procedure"><i class="fa fa-check"></i><b>21.4</b> Nested finite simulation procedure</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html"><i class="fa fa-check"></i><b>22</b> The Parametric bootstrap</a>
<ul>
<li class="chapter" data-level="22.1" data-path="the-parametric-bootstrap.html"><a href="the-parametric-bootstrap.html#air-conditioners-a-stolen-case-study"><i class="fa fa-check"></i><b>22.1</b> Air conditioners: a stolen case study</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="coding-tidbits.html"><a href="coding-tidbits.html"><i class="fa fa-check"></i><b>A</b> Coding Reference</a>
<ul>
<li class="chapter" data-level="A.1" data-path="coding-tidbits.html"><a href="coding-tidbits.html#more-repeating-oneself"><i class="fa fa-check"></i><b>A.1</b> How to repeat yourself</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="coding-tidbits.html"><a href="coding-tidbits.html#using-replicate"><i class="fa fa-check"></i><b>A.1.1</b> Using <code>replicate()</code></a></li>
<li class="chapter" data-level="A.1.2" data-path="coding-tidbits.html"><a href="coding-tidbits.html#using-map"><i class="fa fa-check"></i><b>A.1.2</b> Using <code>map()</code></a></li>
<li class="chapter" data-level="A.1.3" data-path="coding-tidbits.html"><a href="coding-tidbits.html#map-with-no-inputs"><i class="fa fa-check"></i><b>A.1.3</b> map with no inputs</a></li>
<li class="chapter" data-level="A.1.4" data-path="coding-tidbits.html"><a href="coding-tidbits.html#other-approaches-for-repetition"><i class="fa fa-check"></i><b>A.1.4</b> Other approaches for repetition</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="coding-tidbits.html"><a href="coding-tidbits.html#default-arguments"><i class="fa fa-check"></i><b>A.2</b> Default arguments for functions</a></li>
<li class="chapter" data-level="A.3" data-path="coding-tidbits.html"><a href="coding-tidbits.html#profiling-code"><i class="fa fa-check"></i><b>A.3</b> Profiling Code</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="coding-tidbits.html"><a href="coding-tidbits.html#using-sys.time-and-system.time"><i class="fa fa-check"></i><b>A.3.1</b> Using <code>Sys.time()</code> and <code>system.time()</code></a></li>
<li class="chapter" data-level="A.3.2" data-path="coding-tidbits.html"><a href="coding-tidbits.html#the-tictoc-package"><i class="fa fa-check"></i><b>A.3.2</b> The <code>tictoc</code> package</a></li>
<li class="chapter" data-level="A.3.3" data-path="coding-tidbits.html"><a href="coding-tidbits.html#the-bench-package"><i class="fa fa-check"></i><b>A.3.3</b> The <code>bench</code> package</a></li>
<li class="chapter" data-level="A.3.4" data-path="coding-tidbits.html"><a href="coding-tidbits.html#profiling-with-profvis"><i class="fa fa-check"></i><b>A.3.4</b> Profiling with <code>profvis</code></a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="coding-tidbits.html"><a href="coding-tidbits.html#optimize-code"><i class="fa fa-check"></i><b>A.4</b> Optimizing code (and why you often shouldn’t)</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="coding-tidbits.html"><a href="coding-tidbits.html#hand-building-functions"><i class="fa fa-check"></i><b>A.4.1</b> Hand-building functions</a></li>
<li class="chapter" data-level="A.4.2" data-path="coding-tidbits.html"><a href="coding-tidbits.html#sec_comp_efficiency"><i class="fa fa-check"></i><b>A.4.2</b> Computational efficiency versus simplicity</a></li>
<li class="chapter" data-level="A.4.3" data-path="coding-tidbits.html"><a href="coding-tidbits.html#reusing-code-to-speed-up-computation"><i class="fa fa-check"></i><b>A.4.3</b> Reusing code to speed up computation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="further-readings-and-resources.html"><a href="further-readings-and-resources.html"><i class="fa fa-check"></i><b>B</b> Further readings and resources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Designing Monte Carlo Simulations in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="special-topics-on-reporting-simulation-results" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> Special Topics on Reporting Simulation Results<a href="special-topics-on-reporting-simulation-results.html#special-topics-on-reporting-simulation-results" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter we cover some special topics on reporting simulation results.
We first walk through some examples of how to do regression modeling.
We then dive more deeply into what to do when you have only a few iterations per scenario, and then we discuss what to do when you are evaluating methods that sometimes fail to converge or give an answer.</p>
<div id="using-regression-to-analyze-simulation-results" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Using regression to analyze simulation results<a href="special-topics-on-reporting-simulation-results.html#using-regression-to-analyze-simulation-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Chapter <a href="presentation-of-results.html#presentation-of-results">12</a> we saw some examples of using regression and ANOVA on a set of simulation results to summarize overall patterns across scenarios.
In this chapter we will provide some further in-depth examples along with the R code for doing this sort of thing.</p>
<div id="example-1-biserial-revisited-1" class="section level3 hasAnchor" number="14.1.1">
<h3><span class="header-section-number">14.1.1</span> Example 1: Biserial, revisited<a href="special-topics-on-reporting-simulation-results.html#example-1-biserial-revisited-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As our first in depth example, we walk through the analysis that produces the final ANOVA summary table for the biserial correlation example in Chapter <a href="presentation-of-results.html#presentation-of-results">12</a>.
In the visualization there, we saw that several factors appeared to impact bias.
On the eta table presented later in that same chapter, we saw a table that decomposed the variance across several factors so we could see which simulation factors mattered most for bias.</p>
<p>To build that table, we first fit a regression model, regressing bias on all the simulation factors.
We first convert each factor to a factor variable, so that R does not assume a continuous relationship.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="special-topics-on-reporting-simulation-results.html#cb424-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">5</span>)</span>
<span id="cb424-2"><a href="special-topics-on-reporting-simulation-results.html#cb424-2" tabindex="-1"></a>mod <span class="ot">=</span> <span class="fu">lm</span>( bias <span class="sc">~</span> fixed <span class="sc">+</span> rho <span class="sc">+</span> <span class="fu">I</span>(rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> p1 <span class="sc">+</span> n, <span class="at">data =</span> r_F)</span>
<span id="cb424-3"><a href="special-topics-on-reporting-simulation-results.html#cb424-3" tabindex="-1"></a><span class="fu">summary</span>(mod, <span class="at">digits=</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = bias ~ fixed + rho + I(rho^2) + p1 + n, data = r_F)
## 
## Residuals:
##        Min         1Q     Median         3Q 
## -0.0215935 -0.0013608  0.0003823  0.0015677 
##        Max 
##  0.0081802 
## 
## Coefficients:
##                        Estimate  Std. Error
## (Intercept)         -0.00186446  0.00017971
## fixedSample cut-off -0.00363520  0.00009733
## rho                 -0.00942338  0.00069578
## I(rho^2)             0.00720857  0.00070868
## p1p1 = 1/3           0.00358696  0.00015390
## p1p1 = 1/4           0.00482709  0.00015390
## p1p1 = 1/5           0.00547657  0.00015390
## p1p1 = 1/8           0.00635532  0.00015390
## n.L                  0.00362949  0.00010882
## n.Q                 -0.00103981  0.00010882
## n.C                  0.00027941  0.00010882
## n^4                  0.00001976  0.00010882
##                     t value Pr(&gt;|t|)    
## (Intercept)         -10.375   &lt;2e-16 ***
## fixedSample cut-off -37.347   &lt;2e-16 ***
## rho                 -13.544   &lt;2e-16 ***
## I(rho^2)             10.172   &lt;2e-16 ***
## p1p1 = 1/3           23.307   &lt;2e-16 ***
## p1p1 = 1/4           31.365   &lt;2e-16 ***
## p1p1 = 1/5           35.585   &lt;2e-16 ***
## p1p1 = 1/8           41.295   &lt;2e-16 ***
## n.L                  33.352   &lt;2e-16 ***
## n.Q                  -9.555   &lt;2e-16 ***
## n.C                   2.568   0.0103 *  
## n^4                   0.182   0.8559    
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.003372 on 4788 degrees of freedom
## Multiple R-squared:  0.5107, Adjusted R-squared:  0.5096 
## F-statistic: 454.4 on 11 and 4788 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The above printout gives main effects for each factor, averaged across the others.
Because <code>p1</code> and <code>n</code> are ordered factors, the <code>lm()</code> command automatically generates linear, quadratic, cubic and fourth order contrasts for them.
We smooth our <code>rho</code> factor, which has many levels of a continuous measure, with a quadratic curve.
We could instead use splines or some local linear regression if we were worried about model fit for a complex relationship.</p>
<p>The main effects are summaries of trends across contexts.
For example, averaged across the other contexts, the “sample cutoff” condition is around 0.004 lower than the population (the baseline condition).</p>
<p>As shown in Chapter <a href="presentation-of-results.html#presentation-of-results">12</a>, we can also use ANOVA to get a sense of the major sources of variation in the simulation results (e.g., identifying which factors have negligible/minor influence on the bias of an estimator).
To do this, we use <code>aov()</code> to fit an analysis of variance model:</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="special-topics-on-reporting-simulation-results.html#cb426-1" tabindex="-1"></a>anova_table <span class="ot">&lt;-</span> <span class="fu">aov</span>(bias <span class="sc">~</span> rho <span class="sc">*</span> p1 <span class="sc">*</span> fixed <span class="sc">*</span> n, <span class="at">data =</span> r_F)</span>
<span id="cb426-2"><a href="special-topics-on-reporting-simulation-results.html#cb426-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>( <span class="fu">summary</span>(anova_table)[[<span class="dv">1</span>]],</span>
<span id="cb426-3"><a href="special-topics-on-reporting-simulation-results.html#cb426-3" tabindex="-1"></a>              <span class="at">digits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>) )</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">Sum Sq</th>
<th align="right">Mean Sq</th>
<th align="right">F value</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">rho</td>
<td align="right">1</td>
<td align="right">0.0024</td>
<td align="right">0.0024</td>
<td align="right">1673.3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">p1</td>
<td align="right">4</td>
<td align="right">0.0236</td>
<td align="right">0.0059</td>
<td align="right">4036.4</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">fixed</td>
<td align="right">1</td>
<td align="right">0.0159</td>
<td align="right">0.0159</td>
<td align="right">10854.5</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">n</td>
<td align="right">4</td>
<td align="right">0.0138</td>
<td align="right">0.0034</td>
<td align="right">2354.6</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">rho:p1</td>
<td align="right">4</td>
<td align="right">0.0017</td>
<td align="right">0.0004</td>
<td align="right">294.7</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">rho:fixed</td>
<td align="right">1</td>
<td align="right">0.0034</td>
<td align="right">0.0034</td>
<td align="right">2354.7</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">p1:fixed</td>
<td align="right">4</td>
<td align="right">0.0017</td>
<td align="right">0.0004</td>
<td align="right">288.0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">rho:n</td>
<td align="right">4</td>
<td align="right">0.0020</td>
<td align="right">0.0005</td>
<td align="right">342.3</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">p1:n</td>
<td align="right">16</td>
<td align="right">0.0198</td>
<td align="right">0.0012</td>
<td align="right">847.5</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">fixed:n</td>
<td align="right">4</td>
<td align="right">0.0134</td>
<td align="right">0.0033</td>
<td align="right">2286.0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">rho:p1:fixed</td>
<td align="right">4</td>
<td align="right">0.0005</td>
<td align="right">0.0001</td>
<td align="right">80.9</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">rho:p1:n</td>
<td align="right">16</td>
<td align="right">0.0015</td>
<td align="right">0.0001</td>
<td align="right">62.9</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">rho:fixed:n</td>
<td align="right">4</td>
<td align="right">0.0029</td>
<td align="right">0.0007</td>
<td align="right">501.2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">p1:fixed:n</td>
<td align="right">16</td>
<td align="right">0.0014</td>
<td align="right">0.0001</td>
<td align="right">61.1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">rho:p1:fixed:n</td>
<td align="right">16</td>
<td align="right">0.0004</td>
<td align="right">0.0000</td>
<td align="right">18.4</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">4700</td>
<td align="right">0.0069</td>
<td align="right">0.0000</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>The advantage here is the multiple levels of our categorical factors get bundled together in our table of results, making a tidier display.
Note we are including interactions between our simulation factors.
The prior linear regression model was just estimating main effects of the factors, and not estimating these more complex relationships.</p>
<p>The eta table in Chapter <a href="presentation-of-results.html#presentation-of-results">12</a> is a summary of this anova table, which we generate as follows:</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="special-topics-on-reporting-simulation-results.html#cb427-1" tabindex="-1"></a><span class="fu">library</span>(lsr)</span>
<span id="cb427-2"><a href="special-topics-on-reporting-simulation-results.html#cb427-2" tabindex="-1"></a><span class="fu">etaSquared</span>(anova_table) <span class="sc">%&gt;%</span></span>
<span id="cb427-3"><a href="special-topics-on-reporting-simulation-results.html#cb427-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb427-4"><a href="special-topics-on-reporting-simulation-results.html#cb427-4" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;source&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb427-5"><a href="special-topics-on-reporting-simulation-results.html#cb427-5" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">order =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">str_count</span>(source, <span class="st">&quot;:&quot;</span> ) ) <span class="sc">%&gt;%</span></span>
<span id="cb427-6"><a href="special-topics-on-reporting-simulation-results.html#cb427-6" tabindex="-1"></a>  <span class="fu">group_by</span>( order ) <span class="sc">%&gt;%</span></span>
<span id="cb427-7"><a href="special-topics-on-reporting-simulation-results.html#cb427-7" tabindex="-1"></a>  <span class="fu">arrange</span>( <span class="sc">-</span>eta.sq, <span class="at">.by_group =</span> <span class="cn">TRUE</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb427-8"><a href="special-topics-on-reporting-simulation-results.html#cb427-8" tabindex="-1"></a>  <span class="fu">relocate</span>( order ) </span></code></pre></div>
<p>We group the results by the order of the interaction, so that we can see the main effects first, then two-way interactions, and so on.
We then sort within each group to put the high importance factors first.
The resulting variance decomposition table shows the amount of variation explained by each combination of factors.</p>
</div>
<div id="example-2-cluster-rct-example-revisited" class="section level3 hasAnchor" number="14.1.2">
<h3><span class="header-section-number">14.1.2</span> Example 2: Cluster RCT example, revisited<a href="special-topics-on-reporting-simulation-results.html#example-2-cluster-rct-example-revisited" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we have several methods to compare, we can use meta-regression to understand how these methods change as other simulation factors change.
We next illustrate this with our running Cluster RCT example.</p>
<p>We first turn our simulation levels (except for ICC, which has several levels) into factors, so R does not assume that sample size, for example, should be treated as a continuous variable:</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="special-topics-on-reporting-simulation-results.html#cb428-1" tabindex="-1"></a>sres_f <span class="ot">&lt;-</span></span>
<span id="cb428-2"><a href="special-topics-on-reporting-simulation-results.html#cb428-2" tabindex="-1"></a>  sres <span class="sc">%&gt;%</span></span>
<span id="cb428-3"><a href="special-topics-on-reporting-simulation-results.html#cb428-3" tabindex="-1"></a>  <span class="fu">mutate</span>( </span>
<span id="cb428-4"><a href="special-topics-on-reporting-simulation-results.html#cb428-4" tabindex="-1"></a>    <span class="fu">across</span>( <span class="fu">c</span>( n_bar, J, size_coef, alpha ), factor ),</span>
<span id="cb428-5"><a href="special-topics-on-reporting-simulation-results.html#cb428-5" tabindex="-1"></a>    <span class="at">ICC =</span> <span class="fu">as.numeric</span>(ICC)</span>
<span id="cb428-6"><a href="special-topics-on-reporting-simulation-results.html#cb428-6" tabindex="-1"></a>  )</span>
<span id="cb428-7"><a href="special-topics-on-reporting-simulation-results.html#cb428-7" tabindex="-1"></a></span>
<span id="cb428-8"><a href="special-topics-on-reporting-simulation-results.html#cb428-8" tabindex="-1"></a><span class="co"># Run the regression</span></span>
<span id="cb428-9"><a href="special-topics-on-reporting-simulation-results.html#cb428-9" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>( bias <span class="sc">~</span> (n_bar <span class="sc">+</span> J <span class="sc">+</span> size_coef <span class="sc">+</span> ICC <span class="sc">+</span> alpha) <span class="sc">*</span> method, </span>
<span id="cb428-10"><a href="special-topics-on-reporting-simulation-results.html#cb428-10" tabindex="-1"></a>         <span class="at">data =</span> sres_f )</span>
<span id="cb428-11"><a href="special-topics-on-reporting-simulation-results.html#cb428-11" tabindex="-1"></a></span>
<span id="cb428-12"><a href="special-topics-on-reporting-simulation-results.html#cb428-12" tabindex="-1"></a><span class="co"># View the results</span></span>
<span id="cb428-13"><a href="special-topics-on-reporting-simulation-results.html#cb428-13" tabindex="-1"></a><span class="fu">tidy</span>( M ) <span class="sc">%&gt;%</span></span>
<span id="cb428-14"><a href="special-topics-on-reporting-simulation-results.html#cb428-14" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>( <span class="at">digits =</span> <span class="dv">3</span> )</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.002</td>
<td align="right">0.003</td>
<td align="right">0.872</td>
<td align="right">0.384</td>
</tr>
<tr class="even">
<td align="left">n_bar80</td>
<td align="right">-0.003</td>
<td align="right">0.002</td>
<td align="right">-1.295</td>
<td align="right">0.196</td>
</tr>
<tr class="odd">
<td align="left">n_bar320</td>
<td align="right">-0.001</td>
<td align="right">0.002</td>
<td align="right">-0.657</td>
<td align="right">0.511</td>
</tr>
<tr class="even">
<td align="left">J20</td>
<td align="right">-0.002</td>
<td align="right">0.002</td>
<td align="right">-0.991</td>
<td align="right">0.322</td>
</tr>
<tr class="odd">
<td align="left">J80</td>
<td align="right">-0.002</td>
<td align="right">0.002</td>
<td align="right">-0.885</td>
<td align="right">0.376</td>
</tr>
<tr class="even">
<td align="left">size_coef0.2</td>
<td align="right">0.003</td>
<td align="right">0.002</td>
<td align="right">1.537</td>
<td align="right">0.125</td>
</tr>
<tr class="odd">
<td align="left">ICC</td>
<td align="right">0.001</td>
<td align="right">0.003</td>
<td align="right">0.272</td>
<td align="right">0.786</td>
</tr>
<tr class="even">
<td align="left">alpha0.5</td>
<td align="right">-0.002</td>
<td align="right">0.002</td>
<td align="right">-1.179</td>
<td align="right">0.239</td>
</tr>
<tr class="odd">
<td align="left">alpha0.8</td>
<td align="right">0.001</td>
<td align="right">0.002</td>
<td align="right">0.419</td>
<td align="right">0.676</td>
</tr>
<tr class="even">
<td align="left">methodLR</td>
<td align="right">-0.012</td>
<td align="right">0.004</td>
<td align="right">-3.060</td>
<td align="right">0.002</td>
</tr>
<tr class="odd">
<td align="left">methodMLM</td>
<td align="right">0.001</td>
<td align="right">0.004</td>
<td align="right">0.191</td>
<td align="right">0.849</td>
</tr>
<tr class="even">
<td align="left">n_bar80:methodLR</td>
<td align="right">0.000</td>
<td align="right">0.003</td>
<td align="right">0.037</td>
<td align="right">0.971</td>
</tr>
<tr class="odd">
<td align="left">n_bar320:methodLR</td>
<td align="right">0.000</td>
<td align="right">0.003</td>
<td align="right">-0.004</td>
<td align="right">0.997</td>
</tr>
<tr class="even">
<td align="left">n_bar80:methodMLM</td>
<td align="right">0.000</td>
<td align="right">0.003</td>
<td align="right">-0.170</td>
<td align="right">0.865</td>
</tr>
<tr class="odd">
<td align="left">n_bar320:methodMLM</td>
<td align="right">-0.001</td>
<td align="right">0.003</td>
<td align="right">-0.362</td>
<td align="right">0.718</td>
</tr>
<tr class="even">
<td align="left">J20:methodLR</td>
<td align="right">0.005</td>
<td align="right">0.003</td>
<td align="right">1.722</td>
<td align="right">0.085</td>
</tr>
<tr class="odd">
<td align="left">J80:methodLR</td>
<td align="right">0.006</td>
<td align="right">0.003</td>
<td align="right">1.946</td>
<td align="right">0.052</td>
</tr>
<tr class="even">
<td align="left">J20:methodMLM</td>
<td align="right">0.001</td>
<td align="right">0.003</td>
<td align="right">0.354</td>
<td align="right">0.723</td>
</tr>
<tr class="odd">
<td align="left">J80:methodMLM</td>
<td align="right">0.001</td>
<td align="right">0.003</td>
<td align="right">0.420</td>
<td align="right">0.675</td>
</tr>
<tr class="even">
<td align="left">size_coef0.2:methodLR</td>
<td align="right">0.016</td>
<td align="right">0.002</td>
<td align="right">6.741</td>
<td align="right">0.000</td>
</tr>
<tr class="odd">
<td align="left">size_coef0.2:methodMLM</td>
<td align="right">0.003</td>
<td align="right">0.002</td>
<td align="right">1.294</td>
<td align="right">0.196</td>
</tr>
<tr class="even">
<td align="left">ICC:methodLR</td>
<td align="right">0.000</td>
<td align="right">0.004</td>
<td align="right">-0.062</td>
<td align="right">0.951</td>
</tr>
<tr class="odd">
<td align="left">ICC:methodMLM</td>
<td align="right">-0.006</td>
<td align="right">0.004</td>
<td align="right">-1.482</td>
<td align="right">0.139</td>
</tr>
<tr class="even">
<td align="left">alpha0.5:methodLR</td>
<td align="right">0.006</td>
<td align="right">0.003</td>
<td align="right">2.210</td>
<td align="right">0.027</td>
</tr>
<tr class="odd">
<td align="left">alpha0.8:methodLR</td>
<td align="right">0.017</td>
<td align="right">0.003</td>
<td align="right">5.868</td>
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="left">alpha0.5:methodMLM</td>
<td align="right">0.001</td>
<td align="right">0.003</td>
<td align="right">0.434</td>
<td align="right">0.664</td>
</tr>
<tr class="odd">
<td align="left">alpha0.8:methodMLM</td>
<td align="right">0.003</td>
<td align="right">0.003</td>
<td align="right">1.091</td>
<td align="right">0.275</td>
</tr>
</tbody>
</table>
<p>With even a modestly complex simulation, we can quickly generate a lot of regression coefficients, making our meta-regression somewhat hard to interpret.
The above model does not even have interactions between the simulation factors, even though the plots we have seen strongly suggest interactions among them.
That said, picking out the significant coefficients is a quick way to obtain clues as to what is driving performance.
For instance, several features interact with the LR method for bias.
The other two methods seem less impacted.</p>
<div id="using-lasso-to-simplify-the-model" class="section level4 hasAnchor" number="14.1.2.1">
<h4><span class="header-section-number">14.1.2.1</span> Using LASSO to simplify the model<a href="special-topics-on-reporting-simulation-results.html#using-lasso-to-simplify-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<!-- LWM: Not sure if the following is completely off the rails.  Or what we want to say about modeling more broadly.  The Josh work also is in the background, possibly worth considering, about using random effects when number of simulations are few -->
<p>We can simplify a meta regression model using LASSO regression, to drop coefficients that are less relevant.
This requires some work to make our model matrix of dummy variables with all the interactions.
If using LASSO, we recommend fitting a separate model to each method being considered;
the set of fit LASSO models can then be compared to see which methods react to what factors, and how.</p>
<p>We first illustrate with LR, and then extend to all three.
To use the LASSO we have to prepare our data first by hand—this involves converting all our factors to sets of dummy variables for the regression.
We also generate all interaction terms up to the cubic level.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="special-topics-on-reporting-simulation-results.html#cb429-1" tabindex="-1"></a><span class="fu">library</span>(modelr)</span>
<span id="cb429-2"><a href="special-topics-on-reporting-simulation-results.html#cb429-2" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb429-3"><a href="special-topics-on-reporting-simulation-results.html#cb429-3" tabindex="-1"></a></span>
<span id="cb429-4"><a href="special-topics-on-reporting-simulation-results.html#cb429-4" tabindex="-1"></a>sres_f_LR <span class="ot">&lt;-</span> sres_f <span class="sc">%&gt;%</span></span>
<span id="cb429-5"><a href="special-topics-on-reporting-simulation-results.html#cb429-5" tabindex="-1"></a>  <span class="fu">filter</span>( method <span class="sc">==</span> <span class="st">&quot;LR&quot;</span> )</span>
<span id="cb429-6"><a href="special-topics-on-reporting-simulation-results.html#cb429-6" tabindex="-1"></a></span>
<span id="cb429-7"><a href="special-topics-on-reporting-simulation-results.html#cb429-7" tabindex="-1"></a><span class="co"># Create model matrix</span></span>
<span id="cb429-8"><a href="special-topics-on-reporting-simulation-results.html#cb429-8" tabindex="-1"></a>form <span class="ot">&lt;-</span> bias <span class="sc">~</span> ( n_bar <span class="sc">+</span> J <span class="sc">+</span> size_coef <span class="sc">+</span> ICC <span class="sc">+</span> alpha )<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb429-9"><a href="special-topics-on-reporting-simulation-results.html#cb429-9" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(form, <span class="at">data =</span> sres_f_LR)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb429-10"><a href="special-topics-on-reporting-simulation-results.html#cb429-10" tabindex="-1"></a><span class="co">#          The [,-1] drops the intercept</span></span>
<span id="cb429-11"><a href="special-topics-on-reporting-simulation-results.html#cb429-11" tabindex="-1"></a><span class="fu">dim</span>(X)</span></code></pre></div>
<pre><code>## [1] 270  71</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="special-topics-on-reporting-simulation-results.html#cb431-1" tabindex="-1"></a><span class="co"># Fit LASSO</span></span>
<span id="cb431-2"><a href="special-topics-on-reporting-simulation-results.html#cb431-2" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X, sres_f_LR<span class="sc">$</span>bias, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb431-3"><a href="special-topics-on-reporting-simulation-results.html#cb431-3" tabindex="-1"></a></span>
<span id="cb431-4"><a href="special-topics-on-reporting-simulation-results.html#cb431-4" tabindex="-1"></a><span class="co"># Non-zero coefficients</span></span>
<span id="cb431-5"><a href="special-topics-on-reporting-simulation-results.html#cb431-5" tabindex="-1"></a><span class="fu">coef</span>(fit, <span class="at">s =</span> <span class="st">&quot;lambda.1se&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb431-6"><a href="special-topics-on-reporting-simulation-results.html#cb431-6" tabindex="-1"></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span></span>
<span id="cb431-7"><a href="special-topics-on-reporting-simulation-results.html#cb431-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb431-8"><a href="special-topics-on-reporting-simulation-results.html#cb431-8" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb431-9"><a href="special-topics-on-reporting-simulation-results.html#cb431-9" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">abs</span>(lambda<span class="fl">.1</span>se) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb431-10"><a href="special-topics-on-reporting-simulation-results.html#cb431-10" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">lambda.1se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">0.004</td>
</tr>
<tr class="even">
<td align="left">size_coef0.2</td>
<td align="right">0.003</td>
</tr>
<tr class="odd">
<td align="left">size_coef0.2:alpha0.8</td>
<td align="right">0.022</td>
</tr>
</tbody>
</table>
<p>Note we have 71 covariates due to the many, many interactions and the fact that our sample sizes, etc., are all factors, not continuous.</p>
<p>When using regression, and especially LASSO, which levels are baseline can impact the final results.
We have our smallest sample sizes, no variation, 0 ICC, and no <code>size_coef</code> as baseline.
We might imagine that other choices of baseline could suddenly make other factors appear with large coefficients.
One trick to avoid selecting a baseline is to give dummy variables for all the factors, and fit LASSO with the colinear terms.
Due to regularization, this would still work; we do not pursue this here, however.</p>
<p>We next bundle the above to make three models, one for each method.
We first rescale ICC to be on a 5 point scale to control it’s relative coefficient size to the dummy variables, and then add a new feature of “zeroICC” as well (recalling the prior plots that showed ICC being 0 was unusual).</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="special-topics-on-reporting-simulation-results.html#cb432-1" tabindex="-1"></a>meth <span class="ot">=</span> <span class="fu">c</span>( <span class="st">&quot;LR&quot;</span>, <span class="st">&quot;MLM&quot;</span>, <span class="st">&quot;Agg&quot;</span> )</span>
<span id="cb432-2"><a href="special-topics-on-reporting-simulation-results.html#cb432-2" tabindex="-1"></a>sres_f<span class="sc">$</span>zeroICC <span class="ot">=</span> <span class="fu">ifelse</span>( sres_f<span class="sc">$</span>ICC <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span> )</span>
<span id="cb432-3"><a href="special-topics-on-reporting-simulation-results.html#cb432-3" tabindex="-1"></a>sres_f<span class="sc">$</span>ICCsc <span class="ot">=</span> sres_f<span class="sc">$</span>ICC <span class="sc">*</span> <span class="dv">5</span> <span class="co"># rescale ICC to be on a 5 point scale</span></span>
<span id="cb432-4"><a href="special-topics-on-reporting-simulation-results.html#cb432-4" tabindex="-1"></a></span>
<span id="cb432-5"><a href="special-topics-on-reporting-simulation-results.html#cb432-5" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">map</span>( meth, <span class="cf">function</span>(m) {</span>
<span id="cb432-6"><a href="special-topics-on-reporting-simulation-results.html#cb432-6" tabindex="-1"></a>  </span>
<span id="cb432-7"><a href="special-topics-on-reporting-simulation-results.html#cb432-7" tabindex="-1"></a>  sres_f_LR <span class="ot">&lt;-</span> sres_f <span class="sc">%&gt;%</span></span>
<span id="cb432-8"><a href="special-topics-on-reporting-simulation-results.html#cb432-8" tabindex="-1"></a>    <span class="fu">filter</span>( method <span class="sc">==</span> m )</span>
<span id="cb432-9"><a href="special-topics-on-reporting-simulation-results.html#cb432-9" tabindex="-1"></a>  </span>
<span id="cb432-10"><a href="special-topics-on-reporting-simulation-results.html#cb432-10" tabindex="-1"></a>  form <span class="ot">&lt;-</span> bias <span class="sc">~</span> ( n_bar <span class="sc">+</span> J <span class="sc">+</span> size_coef <span class="sc">+</span> ICCsc <span class="sc">+</span> alpha <span class="sc">+</span> zeroICC )<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb432-11"><a href="special-topics-on-reporting-simulation-results.html#cb432-11" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(form, <span class="at">data =</span> sres_f_LR)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb432-12"><a href="special-topics-on-reporting-simulation-results.html#cb432-12" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X, sres_f_LR<span class="sc">$</span>bias, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb432-13"><a href="special-topics-on-reporting-simulation-results.html#cb432-13" tabindex="-1"></a>  </span>
<span id="cb432-14"><a href="special-topics-on-reporting-simulation-results.html#cb432-14" tabindex="-1"></a>  <span class="fu">coef</span>(fit, <span class="at">s =</span> <span class="st">&quot;lambda.min&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb432-15"><a href="special-topics-on-reporting-simulation-results.html#cb432-15" tabindex="-1"></a>    <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span></span>
<span id="cb432-16"><a href="special-topics-on-reporting-simulation-results.html#cb432-16" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb432-17"><a href="special-topics-on-reporting-simulation-results.html#cb432-17" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb432-18"><a href="special-topics-on-reporting-simulation-results.html#cb432-18" tabindex="-1"></a>    <span class="fu">rename</span>( <span class="at">estimate =</span> lambda.min ) <span class="sc">%&gt;%</span></span>
<span id="cb432-19"><a href="special-topics-on-reporting-simulation-results.html#cb432-19" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">abs</span>(estimate) <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb432-20"><a href="special-topics-on-reporting-simulation-results.html#cb432-20" tabindex="-1"></a>} )</span>
<span id="cb432-21"><a href="special-topics-on-reporting-simulation-results.html#cb432-21" tabindex="-1"></a></span>
<span id="cb432-22"><a href="special-topics-on-reporting-simulation-results.html#cb432-22" tabindex="-1"></a>models <span class="ot">&lt;-</span> </span>
<span id="cb432-23"><a href="special-topics-on-reporting-simulation-results.html#cb432-23" tabindex="-1"></a>  models <span class="sc">%&gt;%</span> </span>
<span id="cb432-24"><a href="special-topics-on-reporting-simulation-results.html#cb432-24" tabindex="-1"></a>  <span class="fu">set_names</span>(meth) <span class="sc">%&gt;%</span> </span>
<span id="cb432-25"><a href="special-topics-on-reporting-simulation-results.html#cb432-25" tabindex="-1"></a>  <span class="fu">bind_rows</span>( <span class="at">.id =</span> <span class="st">&quot;model&quot;</span> )</span>
<span id="cb432-26"><a href="special-topics-on-reporting-simulation-results.html#cb432-26" tabindex="-1"></a></span>
<span id="cb432-27"><a href="special-topics-on-reporting-simulation-results.html#cb432-27" tabindex="-1"></a>m_res <span class="ot">&lt;-</span> models <span class="sc">%&gt;%</span> </span>
<span id="cb432-28"><a href="special-topics-on-reporting-simulation-results.html#cb432-28" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>( model, term, estimate ) <span class="sc">%&gt;%</span></span>
<span id="cb432-29"><a href="special-topics-on-reporting-simulation-results.html#cb432-29" tabindex="-1"></a>  <span class="fu">pivot_wider</span>( <span class="at">names_from=</span><span class="st">&quot;model&quot;</span>, <span class="at">values_from=</span><span class="st">&quot;estimate&quot;</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb432-30"><a href="special-topics-on-reporting-simulation-results.html#cb432-30" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">order =</span> <span class="fu">str_count</span>(term, <span class="st">&quot;:&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb432-31"><a href="special-topics-on-reporting-simulation-results.html#cb432-31" tabindex="-1"></a>  <span class="fu">arrange</span>(order) <span class="sc">%&gt;%</span></span>
<span id="cb432-32"><a href="special-topics-on-reporting-simulation-results.html#cb432-32" tabindex="-1"></a>  <span class="fu">relocate</span>(order)</span>
<span id="cb432-33"><a href="special-topics-on-reporting-simulation-results.html#cb432-33" tabindex="-1"></a></span>
<span id="cb432-34"><a href="special-topics-on-reporting-simulation-results.html#cb432-34" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb432-35"><a href="special-topics-on-reporting-simulation-results.html#cb432-35" tabindex="-1"></a>m_res <span class="sc">%&gt;%</span></span>
<span id="cb432-36"><a href="special-topics-on-reporting-simulation-results.html#cb432-36" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>( <span class="at">digits =</span> <span class="dv">3</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb432-37"><a href="special-topics-on-reporting-simulation-results.html#cb432-37" tabindex="-1"></a>  <span class="fu">print</span>( <span class="at">na.print =</span> <span class="st">&quot;&quot;</span> )</span></code></pre></div>
<pre><code>## 
## 
## | order|term                           |    LR|    MLM|   Agg|
## |-----:|:------------------------------|-----:|------:|-----:|
## |     0|(Intercept)                    | 0.000|  0.001| 0.001|
## |     0|size_coef0.2                   | 0.003|  0.001|      |
## |     0|n_bar80                        |      |  0.000|      |
## |     1|J20:alpha0.8                   | 0.001|       |      |
## |     1|size_coef0.2:ICCsc             | 0.000|       |      |
## |     1|size_coef0.2:alpha0.5          | 0.007|       |      |
## |     1|size_coef0.2:alpha0.8          | 0.026|  0.003|      |
## |     1|n_bar80:ICCsc                  |      |  0.000|      |
## |     1|J20:ICCsc                      |      |  0.000|      |
## |     1|ICCsc:alpha0.5                 |      |  0.000|      |
## |     2|n_bar320:J20:ICCsc             | 0.000| -0.001|      |
## |     2|n_bar80:J20:alpha0.8           | 0.003|  0.005|      |
## |     2|n_bar320:size_coef0.2:alpha0.5 | 0.003|  0.001|      |
## |     2|J80:size_coef0.2:alpha0.5      | 0.001|       |      |
## |     2|J20:size_coef0.2:alpha0.8      | 0.007|       |      |
## |     2|J80:size_coef0.2:alpha0.8      | 0.008|       |      |
## |     2|size_coef0.2:ICCsc:alpha0.8    | 0.000|       |      |
## |     2|n_bar80:size_coef0.2:ICCsc     |      |  0.000|      |
## |     2|J80:size_coef0.2:zeroICC       |      |  0.002|      |
## |     2|size_coef0.2:alpha0.5:zeroICC  |      |  0.002|      |
## |     2|size_coef0.2:alpha0.8:zeroICC  |      |  0.014|      |</code></pre>
<p>Of course, this is table is hard to read. Better to instead plot the coefficients:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="special-topics-on-reporting-simulation-results.html#cb434-1" tabindex="-1"></a>lvl <span class="ot">=</span> m_res<span class="sc">$</span>term</span>
<span id="cb434-2"><a href="special-topics-on-reporting-simulation-results.html#cb434-2" tabindex="-1"></a>m_resL <span class="ot">&lt;-</span> m_res <span class="sc">%&gt;%</span></span>
<span id="cb434-3"><a href="special-topics-on-reporting-simulation-results.html#cb434-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>( <span class="sc">-</span><span class="fu">c</span>( order, term ), </span>
<span id="cb434-4"><a href="special-topics-on-reporting-simulation-results.html#cb434-4" tabindex="-1"></a>                <span class="at">names_to =</span> <span class="st">&quot;model&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;estimate&quot;</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb434-5"><a href="special-topics-on-reporting-simulation-results.html#cb434-5" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">term =</span> <span class="fu">factor</span>(term, <span class="at">levels =</span> <span class="fu">rev</span>(lvl) ) )</span>
<span id="cb434-6"><a href="special-topics-on-reporting-simulation-results.html#cb434-6" tabindex="-1"></a></span>
<span id="cb434-7"><a href="special-topics-on-reporting-simulation-results.html#cb434-7" tabindex="-1"></a><span class="fu">ggplot</span>( m_resL,</span>
<span id="cb434-8"><a href="special-topics-on-reporting-simulation-results.html#cb434-8" tabindex="-1"></a>        <span class="fu">aes</span>( <span class="at">x =</span> term, <span class="at">y =</span> estimate, </span>
<span id="cb434-9"><a href="special-topics-on-reporting-simulation-results.html#cb434-9" tabindex="-1"></a>             <span class="at">fill =</span> model, <span class="at">group =</span> model ) ) <span class="sc">+</span></span>
<span id="cb434-10"><a href="special-topics-on-reporting-simulation-results.html#cb434-10" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> model ) <span class="sc">+</span></span>
<span id="cb434-11"><a href="special-topics-on-reporting-simulation-results.html#cb434-11" tabindex="-1"></a>  <span class="fu">geom_bar</span>( <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span> ) <span class="sc">+</span></span>
<span id="cb434-12"><a href="special-topics-on-reporting-simulation-results.html#cb434-12" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span> ) <span class="sc">+</span></span>
<span id="cb434-13"><a href="special-topics-on-reporting-simulation-results.html#cb434-13" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 35 rows containing missing values or
## values outside the scale range (`geom_bar()`).</code></pre>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-252-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Here we see how LR stands out, but also how MLM stands out under different simulation factor combinations (see, e.g., the interaction of zeroICC, alpha being 0.8, and size_coef being 0.2).
This aggregate plot provides some understanding of how the methods are similar, and dissimilar.</p>
<p>For another example we turn to the standard error.
Here we regress <span class="math inline">\(log(SE)\)</span> onto the coefficients.
We then exponentiate the estimated coefficients to get the relative change in SE as a function of the factors.
We can interpret an exponentiated coefficient of, for example, 0.64 for MLM for <code>n_bar80</code> as a 36% reduction of the standard error when we increase n_bar from the baseline of 20 to 80.
We use ordinary least squares and include all interactions up to three way interactions.
We will then simply drop all the tiny coefficients, rather than use the full LASSO machinery, to simplify our output.
This results in a plot similar to the above:</p>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-253-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Our plot clearly shows that the three methods are basically the same in terms of uncertainty estimation, with a few differences when alpha is 0.8.
We also see some interesting trends, such as the impact of n_bar declines when ICC is higher (see the positive interaction terms at right of plot).</p>
</div>
</div>
</div>
<div id="using-regression-trees-to-find-important-factors" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Using regression trees to find important factors<a href="special-topics-on-reporting-simulation-results.html#using-regression-trees-to-find-important-factors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With more complex experiments, where the various factors are interacting with each other in strange ways, it can be a bit tricky to decipher which factors are important and what patterns are stable.
Another exploration approach we might use is regression trees.</p>
<p>We wrote a utility method, a wrapper to the <code>rpart</code> package, to do this (<a href="code/create_analysis_tree.R">script here</a>).
Here, for example, we see what predicts larger bias amounts:</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="special-topics-on-reporting-simulation-results.html#cb436-1" tabindex="-1"></a><span class="fu">source</span>( here<span class="sc">::</span><span class="fu">here</span>( <span class="st">&quot;code/create_analysis_tree.R&quot;</span> ) )</span>
<span id="cb436-2"><a href="special-topics-on-reporting-simulation-results.html#cb436-2" tabindex="-1"></a></span>
<span id="cb436-3"><a href="special-topics-on-reporting-simulation-results.html#cb436-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12411</span>)</span>
<span id="cb436-4"><a href="special-topics-on-reporting-simulation-results.html#cb436-4" tabindex="-1"></a><span class="fu">create_analysis_tree</span>( sres_f,</span>
<span id="cb436-5"><a href="special-topics-on-reporting-simulation-results.html#cb436-5" tabindex="-1"></a>                      <span class="at">outcome =</span> <span class="st">&quot;bias&quot;</span>,</span>
<span id="cb436-6"><a href="special-topics-on-reporting-simulation-results.html#cb436-6" tabindex="-1"></a>                      <span class="at">predictor_vars =</span> <span class="fu">c</span>(<span class="st">&quot;method&quot;</span>, <span class="st">&quot;n_bar&quot;</span>, <span class="st">&quot;J&quot;</span>,</span>
<span id="cb436-7"><a href="special-topics-on-reporting-simulation-results.html#cb436-7" tabindex="-1"></a>                                         <span class="st">&quot;size_coef&quot;</span>, <span class="st">&quot;ICC&quot;</span>, <span class="st">&quot;alpha&quot;</span>),</span>
<span id="cb436-8"><a href="special-topics-on-reporting-simulation-results.html#cb436-8" tabindex="-1"></a>                      <span class="at">tree_title =</span> <span class="st">&quot;Cluster RCT Bias Analysis Tree&quot;</span> )</span></code></pre></div>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-254-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>The default pruning is based on a cross-fitting evaluation, but our sample size is not too terribly high (just the number of simulation scenarios fit) so this is quite unstable.
Rerunning the code with a different seed will generally give a different tree.
We find that it is often worth forcibly simplifying the tree.
Trees are built greedily, so forcibly trimming often leaves you only with the big things.
For example:</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="special-topics-on-reporting-simulation-results.html#cb437-1" tabindex="-1"></a><span class="fu">create_analysis_tree</span>( sres_f,</span>
<span id="cb437-2"><a href="special-topics-on-reporting-simulation-results.html#cb437-2" tabindex="-1"></a>                      <span class="at">outcome =</span> <span class="st">&quot;bias&quot;</span>,</span>
<span id="cb437-3"><a href="special-topics-on-reporting-simulation-results.html#cb437-3" tabindex="-1"></a>                      <span class="at">predictor_vars =</span> <span class="fu">c</span>(<span class="st">&quot;method&quot;</span>, <span class="st">&quot;n_bar&quot;</span>, <span class="st">&quot;J&quot;</span>,</span>
<span id="cb437-4"><a href="special-topics-on-reporting-simulation-results.html#cb437-4" tabindex="-1"></a>                                         <span class="st">&quot;size_coef&quot;</span>, <span class="st">&quot;ICC&quot;</span>, <span class="st">&quot;alpha&quot;</span>),</span>
<span id="cb437-5"><a href="special-topics-on-reporting-simulation-results.html#cb437-5" tabindex="-1"></a>                      <span class="at">tree_title =</span> <span class="st">&quot;Smaller Cluster RCT Bias Analysis Tree&quot;</span>, </span>
<span id="cb437-6"><a href="special-topics-on-reporting-simulation-results.html#cb437-6" tabindex="-1"></a>                      <span class="at">min_leaves =</span> <span class="dv">5</span>, <span class="at">max_leaves =</span> <span class="dv">10</span> )</span></code></pre></div>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-255-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>This tree gives a very straightforward story: if <code>size_coef</code> is not 0 and we are using LR, then alpha drives bias.</p>
<p>We can also zero in on specific methods to understand how they engage with the simulation factors, like so:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="special-topics-on-reporting-simulation-results.html#cb438-1" tabindex="-1"></a><span class="fu">create_analysis_tree</span>( <span class="fu">filter</span>( sres_f, method<span class="sc">==</span><span class="st">&quot;LR&quot;</span> ),</span>
<span id="cb438-2"><a href="special-topics-on-reporting-simulation-results.html#cb438-2" tabindex="-1"></a>                      <span class="at">outcome =</span> <span class="st">&quot;bias&quot;</span>,</span>
<span id="cb438-3"><a href="special-topics-on-reporting-simulation-results.html#cb438-3" tabindex="-1"></a>                      <span class="at">min_leaves =</span> <span class="dv">4</span>,</span>
<span id="cb438-4"><a href="special-topics-on-reporting-simulation-results.html#cb438-4" tabindex="-1"></a>                      <span class="at">predictor_vars =</span> <span class="fu">c</span>(<span class="st">&quot;n_bar&quot;</span>, <span class="st">&quot;J&quot;</span>,</span>
<span id="cb438-5"><a href="special-topics-on-reporting-simulation-results.html#cb438-5" tabindex="-1"></a>                                         <span class="st">&quot;size_coef&quot;</span>, <span class="st">&quot;ICC&quot;</span>, <span class="st">&quot;alpha&quot;</span>),</span>
<span id="cb438-6"><a href="special-topics-on-reporting-simulation-results.html#cb438-6" tabindex="-1"></a>                      <span class="at">tree_title =</span> <span class="st">&quot;Drivers of Bias for LR method&quot;</span> )</span></code></pre></div>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-256-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We force more leaves to get at some more nuance.
We again immediately see, for the LR method, that bias is large when we have non-zero size coefficient <em>and</em> a large alpha value.
Then, when <span class="math inline">\(J\)</span> is small, bias is even larger.</p>
<p>Generally we would not use a tree like this for a final reporting of results, but they can be important tools for <em>understanding</em> your results, which leads to how to make and select more conventional figures for an outward facing document.</p>
</div>
<div id="analyzing-results-with-few-iterations-per-scenario" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Analyzing results with few iterations per scenario<a href="special-topics-on-reporting-simulation-results.html#analyzing-results-with-few-iterations-per-scenario" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When each simulation iteration is expensive to run (e.g., if fitting your model takes several minutes), then running thousands of iterations for many scenarios may not be computationally feasible.
But running simulations with only a small number of iterations will yield very noisy estimates of estimator performance for that scenario.</p>
<p>Now, if the methods being evaluated are substantially different, then differences in performance might still be evident even with only a few iterations.
More generally, however, the Monte Carlo Standard Errors (MCSEs) may be so large that you will have a hard time discriminating between systematic patterns and noise.</p>
<p>One tool to handle few iterations is aggregation: if you average across scenarios, those averages will have more precise estimates of (average) performance than the estimates of performance within the scenarios.
Do not, by contrast, trust the bundling approach–the MCSEs will make your boxes wider, and give the impression that there is more variation across scenarios than there really is.</p>
<p>Meta regression approaches such as we saw above can be particularly useful: a regression will effectively average performance across scenario, and give summaries of overall trends.
You can even fit random effects regression, specifically accounting for the noise in the scenario-specific performance measures.
For more on using random effects for your meta regression see <span class="citation">@gilbert2024multilevel</span>.</p>
<div id="example-clusterrct-with-only-100-replicates-per-scenario" class="section level3 hasAnchor" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> Example: ClusterRCT with only 100 replicates per scenario<a href="special-topics-on-reporting-simulation-results.html#example-clusterrct-with-only-100-replicates-per-scenario" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the prior chapter we analyzed the results of our cluster RCT simulation with 1000 iterations per scenario.
But say we only had 25 per scenario.
Using the prior chapter as a guide, we next recreate some of the plots to show how MCSE can distort the picture of what is going on.</p>
<p>First, we look at our single plot of the raw results.
Before we plot, however, we calculate MCSEs and add them to the plot as error bars.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="special-topics-on-reporting-simulation-results.html#cb439-1" tabindex="-1"></a>sres_sub <span class="ot">&lt;-</span> </span>
<span id="cb439-2"><a href="special-topics-on-reporting-simulation-results.html#cb439-2" tabindex="-1"></a>  ssres <span class="sc">%&gt;%</span></span>
<span id="cb439-3"><a href="special-topics-on-reporting-simulation-results.html#cb439-3" tabindex="-1"></a>  <span class="fu">filter</span>( n_bar <span class="sc">==</span> <span class="dv">320</span>, J <span class="sc">==</span> <span class="dv">20</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb439-4"><a href="special-topics-on-reporting-simulation-results.html#cb439-4" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">bias.mcse =</span> SE <span class="sc">/</span> <span class="fu">sqrt</span>( R ) )</span>
<span id="cb439-5"><a href="special-topics-on-reporting-simulation-results.html#cb439-5" tabindex="-1"></a></span>
<span id="cb439-6"><a href="special-topics-on-reporting-simulation-results.html#cb439-6" tabindex="-1"></a>dodge <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.35</span>)</span>
<span id="cb439-7"><a href="special-topics-on-reporting-simulation-results.html#cb439-7" tabindex="-1"></a><span class="fu">ggplot</span>( sres_sub, <span class="fu">aes</span>( <span class="fu">as.factor</span>(alpha), bias, </span>
<span id="cb439-8"><a href="special-topics-on-reporting-simulation-results.html#cb439-8" tabindex="-1"></a>                       <span class="at">col=</span>method, <span class="at">pch=</span>method, <span class="at">group=</span>method ) ) <span class="sc">+</span></span>
<span id="cb439-9"><a href="special-topics-on-reporting-simulation-results.html#cb439-9" tabindex="-1"></a>  <span class="fu">facet_grid</span>( size_coef <span class="sc">~</span> ICC, <span class="at">labeller =</span> label_both ) <span class="sc">+</span></span>
<span id="cb439-10"><a href="special-topics-on-reporting-simulation-results.html#cb439-10" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">position =</span> dodge ) <span class="sc">+</span> </span>
<span id="cb439-11"><a href="special-topics-on-reporting-simulation-results.html#cb439-11" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>( <span class="at">ymin =</span> bias <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>bias.mcse, </span>
<span id="cb439-12"><a href="special-topics-on-reporting-simulation-results.html#cb439-12" tabindex="-1"></a>                      <span class="at">ymax =</span> bias <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>bias.mcse ), </span>
<span id="cb439-13"><a href="special-topics-on-reporting-simulation-results.html#cb439-13" tabindex="-1"></a>                 <span class="at">width =</span> <span class="dv">0</span>,</span>
<span id="cb439-14"><a href="special-topics-on-reporting-simulation-results.html#cb439-14" tabindex="-1"></a>                 <span class="at">position =</span> dodge ) <span class="sc">+</span></span>
<span id="cb439-15"><a href="special-topics-on-reporting-simulation-results.html#cb439-15" tabindex="-1"></a>  <span class="fu">geom_line</span>( <span class="at">position =</span> dodge ) <span class="sc">+</span></span>
<span id="cb439-16"><a href="special-topics-on-reporting-simulation-results.html#cb439-16" tabindex="-1"></a>  <span class="fu">geom_hline</span>( <span class="at">yintercept =</span> <span class="dv">0</span> ) <span class="sc">+</span></span>
<span id="cb439-17"><a href="special-topics-on-reporting-simulation-results.html#cb439-17" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb439-18"><a href="special-topics-on-reporting-simulation-results.html#cb439-18" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>( <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.10</span>,<span class="fl">0.10</span>) )</span></code></pre></div>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-258-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Our uncertainty is much less when ICC is 0; this is because our estimators are far more precise due to not having cluster variation to contend with.
Other than the ICC = 0 case, we see substantial amounts of uncertainty, making it very hard to tell the different estimators apart.
In the top row, second plot from left, we see that the three estimators are co-dependent: they all react similarly to the same datasets, so if we end up with datasets that randomly lead to large estimates, all three will give large estimates.
The shape we are seeing is not a systematic bias, but rather a shared random variation.</p>
<p>Here is the same plot with the full 1000 replicates, with the 100 replicate results overlaid in light color for comparison:</p>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-259-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>The MCSEs have shrunk by around <span class="math inline">\(1/\sqrt{10} = 0.32\)</span>, as we would expect (generally the MCSEs will be on the order of <span class="math inline">\(1/\sqrt{R}\)</span>, where <span class="math inline">\(R\)</span> is the number of replicates, so to halve the MCSE you need to quadruple the number of replicates).
Also note the ICC=0.2 top facet has shifted to a flat, slightly elevated line: we do not yet know if the elevation is real, just as we did not know if the dip in the prior plot was real.
Our confidence intervals are still including 0: it is possible there is no bias at all when the size coefficient is 0 (in fact we are fairly sure it is indeed the case).</p>
<p>Moving back to our “small replicates” simulation, we can use aggregation to smooth out some of our uncertainty.
For example, if we aggregate across 9 scenarios, our number of replicates goes from 100 to 900; our MCSEs should then be about a third the size.
To calculate an aggregated MCSE, we aggregate our scenario-specific MCSEs as follows:
<span class="math display">\[ MCSE_{agg} = \sqrt{ \frac{1}{K^2} \sum_{k=1}^{K} MCSE_k^2 } \]</span></p>
<p>where <span class="math inline">\(MCSE_k\)</span> is the Monte Carlo Standard Error for scenario <span class="math inline">\(k\)</span>, and <span class="math inline">\(K\)</span> is the number of scenarios being averaged.
Assuming a collection of estimates are independent, the overall <span class="math inline">\(SE^2\)</span> of an average is the average <span class="math inline">\(SE^2\)</span> divided by <span class="math inline">\(K\)</span>.
In code we have:</p>
<p>Recall that the <code>SE</code> variable is simply the standard deviation of the estimates.</p>
<p>We can then make our aggregated bias plot, aggregating across <code>n_bar</code> and <code>J</code>:</p>
<p><img src="Designing-Simulations-in-R_files/figure-html/unnamed-chunk-262-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Even with the additional replicates per point, we see noticeable noise in our plot: look at the top-right ICC of 0.8 facet, for example.
Also note how our three methods continue to track each other up and down in top row, giving a sense of a shared error.
This is because all methods are analyzing the same set of datasets; they have shared uncertainty.
This uncertainty can be deceptive.
It can also be a boon: if we are explicitly comparing the performance of one method vs another, the shared uncertainty can be subtracted out, similar to what happens in a blocked experiment <span class="citation">[@gilbert2024multilevel]</span>.</p>
<p>One way to take advantage of this is to fit a multilevel regression model to our raw simulation results with a random effect for dataset.
We next fit such a model, taking advantage of the fact that bias is simply the average of the error across replicates.
We first make a unique ID for each scenario and dataset, and then fit the model with a random effect for both.
The first random effect allows for specific scenarios to have more or less bias beyond what our model predicts.
The second random effect allows for a given dataset to have a larger or smaller error than expected, shared across the three estimators.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="special-topics-on-reporting-simulation-results.html#cb440-1" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb440-2"><a href="special-topics-on-reporting-simulation-results.html#cb440-2" tabindex="-1"></a>res_small <span class="ot">&lt;-</span> res_small <span class="sc">%&gt;%</span></span>
<span id="cb440-3"><a href="special-topics-on-reporting-simulation-results.html#cb440-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb440-4"><a href="special-topics-on-reporting-simulation-results.html#cb440-4" tabindex="-1"></a>    <span class="at">error =</span> ATE_hat <span class="sc">-</span> ATE,</span>
<span id="cb440-5"><a href="special-topics-on-reporting-simulation-results.html#cb440-5" tabindex="-1"></a>    <span class="at">simID =</span> <span class="fu">paste</span>(n_bar, J, size_coef, ICC, alpha, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>),</span>
<span id="cb440-6"><a href="special-topics-on-reporting-simulation-results.html#cb440-6" tabindex="-1"></a>    <span class="at">dataID =</span> <span class="fu">paste</span>( simID, runID, <span class="at">sep=</span><span class="st">&quot;_&quot;</span> ),</span>
<span id="cb440-7"><a href="special-topics-on-reporting-simulation-results.html#cb440-7" tabindex="-1"></a>    <span class="at">J =</span> <span class="fu">as.factor</span>(J),</span>
<span id="cb440-8"><a href="special-topics-on-reporting-simulation-results.html#cb440-8" tabindex="-1"></a>    <span class="at">n_bar =</span> <span class="fu">as.factor</span>(n_bar),</span>
<span id="cb440-9"><a href="special-topics-on-reporting-simulation-results.html#cb440-9" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fu">as.factor</span>(alpha),</span>
<span id="cb440-10"><a href="special-topics-on-reporting-simulation-results.html#cb440-10" tabindex="-1"></a>    <span class="at">size_coef =</span> <span class="fu">as.factor</span>(size_coef)</span>
<span id="cb440-11"><a href="special-topics-on-reporting-simulation-results.html#cb440-11" tabindex="-1"></a>  )</span>
<span id="cb440-12"><a href="special-topics-on-reporting-simulation-results.html#cb440-12" tabindex="-1"></a></span>
<span id="cb440-13"><a href="special-topics-on-reporting-simulation-results.html#cb440-13" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lmer</span>( </span>
<span id="cb440-14"><a href="special-topics-on-reporting-simulation-results.html#cb440-14" tabindex="-1"></a>  error <span class="sc">~</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dataID) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>simID),</span>
<span id="cb440-15"><a href="special-topics-on-reporting-simulation-results.html#cb440-15" tabindex="-1"></a>  <span class="at">data =</span> res_small </span>
<span id="cb440-16"><a href="special-topics-on-reporting-simulation-results.html#cb440-16" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;),
## opt$par, ctrl = control$checkConv, : Model failed
## to converge with max|grad| = 0.00462697 (tol =
## 0.002, component 1)</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="special-topics-on-reporting-simulation-results.html#cb442-1" tabindex="-1"></a>arm<span class="sc">::</span><span class="fu">display</span>(M)</span></code></pre></div>
<pre><code>## lmer(formula = error ~ method + (1 | dataID) + (1 | simID), data = res_small)
##             coef.est coef.se
## (Intercept) 0.00     0.00   
## methodLR    0.01     0.00   
## methodMLM   0.00     0.00   
## 
## Error terms:
##  Groups   Name        Std.Dev.
##  dataID   (Intercept) 0.39    
##  simID    (Intercept) 0.01    
##  Residual             0.06    
## ---
## number of obs: 81000, groups: dataID, 27000; simID, 270
## AIC = -95344.2, DIC = -95430.3
## deviance = -95393.3</code></pre>
<p>We can look at how much each source of variation explains the overall error:</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="special-topics-on-reporting-simulation-results.html#cb444-1" tabindex="-1"></a>ranef_vars <span class="ot">&lt;-</span></span>
<span id="cb444-2"><a href="special-topics-on-reporting-simulation-results.html#cb444-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">VarCorr</span>(M)) <span class="sc">%&gt;%</span></span>
<span id="cb444-3"><a href="special-topics-on-reporting-simulation-results.html#cb444-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">grp =</span> grp, <span class="at">sd =</span> vcov) <span class="sc">%&gt;%</span></span>
<span id="cb444-4"><a href="special-topics-on-reporting-simulation-results.html#cb444-4" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">sd =</span> <span class="fu">sqrt</span>(sd),</span>
<span id="cb444-5"><a href="special-topics-on-reporting-simulation-results.html#cb444-5" tabindex="-1"></a>          <span class="at">ICC =</span> sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(sd<span class="sc">^</span><span class="dv">2</span> ) )</span>
<span id="cb444-6"><a href="special-topics-on-reporting-simulation-results.html#cb444-6" tabindex="-1"></a></span>
<span id="cb444-7"><a href="special-topics-on-reporting-simulation-results.html#cb444-7" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(ranef_vars, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">grp</th>
<th align="right">sd</th>
<th align="right">ICC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dataID</td>
<td align="right">0.39</td>
<td align="right">0.98</td>
</tr>
<tr class="even">
<td align="left">simID</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">Residual</td>
<td align="right">0.06</td>
<td align="right">0.02</td>
</tr>
</tbody>
</table>
<p>The random variation for <code>simID</code> captures unexplained variation due to the interactions of the simulation factors.
It appears to be a trivial amount; almost all the variation is due to the dataset.
This makes sense: each datasets is unbalanced due to random assignment, and that estimation error is part of the dataset random effect.</p>
<p>So far we have not included any simulation factors: we are pushing variation across simulation into the random effect terms. We can instead include the simulation factors as fixed effects, to see how they impact bias.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="special-topics-on-reporting-simulation-results.html#cb445-1" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>( </span>
<span id="cb445-2"><a href="special-topics-on-reporting-simulation-results.html#cb445-2" tabindex="-1"></a>  error <span class="sc">~</span> method<span class="sc">*</span>(J <span class="sc">+</span> n_bar <span class="sc">+</span> ICC <span class="sc">+</span> alpha <span class="sc">+</span> size_coef) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>dataID) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>simID),</span>
<span id="cb445-3"><a href="special-topics-on-reporting-simulation-results.html#cb445-3" tabindex="-1"></a>  <span class="at">data =</span> res_small </span>
<span id="cb445-4"><a href="special-topics-on-reporting-simulation-results.html#cb445-4" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;),
## opt$par, ctrl = control$checkConv, : Model failed
## to converge with max|grad| = 0.0169698 (tol =
## 0.002, component 1)</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="special-topics-on-reporting-simulation-results.html#cb447-1" tabindex="-1"></a>texreg<span class="sc">::</span><span class="fu">screenreg</span>(M2)</span></code></pre></div>
<pre><code>## 
## ======================================
##                          Model 1      
## --------------------------------------
## (Intercept)                   0.00    
##                              (0.01)   
## methodLR                     -0.01 ***
##                              (0.00)   
## methodMLM                     0.00    
##                              (0.00)   
## J20                          -0.01    
##                              (0.01)   
## J80                          -0.01    
##                              (0.01)   
## n_bar80                      -0.00    
##                              (0.01)   
## n_bar320                      0.00    
##                              (0.01)   
## ICC                           0.00    
##                              (0.01)   
## alpha0.5                     -0.00    
##                              (0.01)   
## alpha0.8                      0.01    
##                              (0.01)   
## size_coef0.2                  0.01    
##                              (0.00)   
## methodLR:J20                  0.01 ***
##                              (0.00)   
## methodMLM:J20                 0.00    
##                              (0.00)   
## methodLR:J80                  0.01 ***
##                              (0.00)   
## methodMLM:J80                 0.00    
##                              (0.00)   
## methodLR:n_bar80              0.00 *  
##                              (0.00)   
## methodMLM:n_bar80            -0.00    
##                              (0.00)   
## methodLR:n_bar320             0.00    
##                              (0.00)   
## methodMLM:n_bar320           -0.00    
##                              (0.00)   
## methodLR:ICC                 -0.00    
##                              (0.00)   
## methodMLM:ICC                -0.01 ***
##                              (0.00)   
## methodLR:alpha0.5             0.01 ***
##                              (0.00)   
## methodMLM:alpha0.5            0.00    
##                              (0.00)   
## methodLR:alpha0.8             0.02 ***
##                              (0.00)   
## methodMLM:alpha0.8            0.00 *  
##                              (0.00)   
## methodLR:size_coef0.2         0.02 ***
##                              (0.00)   
## methodMLM:size_coef0.2        0.00 ** 
##                              (0.00)   
## --------------------------------------
## AIC                      -95700.20    
## BIC                      -95421.14    
## Log Likelihood            47880.10    
## Num. obs.                 81000       
## Num. groups: dataID       27000       
## Num. groups: simID          270       
## Var: dataID (Intercept)       0.15    
## Var: simID (Intercept)        0.00    
## Var: Residual                 0.00    
## ======================================
## *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
<p>The above models allow us to estimate how bias varies with method and simulation factor, while accounting for the uncertainty in the simulation.</p>
<p>Finally, we can see how much variation has been explained by comparing the random effect variances:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="special-topics-on-reporting-simulation-results.html#cb449-1" tabindex="-1"></a>ranef_vars1 <span class="ot">&lt;-</span></span>
<span id="cb449-2"><a href="special-topics-on-reporting-simulation-results.html#cb449-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">VarCorr</span>(M)) <span class="sc">%&gt;%</span></span>
<span id="cb449-3"><a href="special-topics-on-reporting-simulation-results.html#cb449-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">grp =</span> grp, <span class="at">sd =</span> vcov) <span class="sc">%&gt;%</span></span>
<span id="cb449-4"><a href="special-topics-on-reporting-simulation-results.html#cb449-4" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">sd =</span> <span class="fu">sqrt</span>(sd),</span>
<span id="cb449-5"><a href="special-topics-on-reporting-simulation-results.html#cb449-5" tabindex="-1"></a>          <span class="at">ICC =</span> sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(sd<span class="sc">^</span><span class="dv">2</span> ) )</span>
<span id="cb449-6"><a href="special-topics-on-reporting-simulation-results.html#cb449-6" tabindex="-1"></a>ranef_vars2 <span class="ot">&lt;-</span></span>
<span id="cb449-7"><a href="special-topics-on-reporting-simulation-results.html#cb449-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(<span class="fu">VarCorr</span>(M2)) <span class="sc">%&gt;%</span></span>
<span id="cb449-8"><a href="special-topics-on-reporting-simulation-results.html#cb449-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">grp =</span> grp, <span class="at">sd =</span> vcov) <span class="sc">%&gt;%</span></span>
<span id="cb449-9"><a href="special-topics-on-reporting-simulation-results.html#cb449-9" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">sd =</span> <span class="fu">sqrt</span>(sd),</span>
<span id="cb449-10"><a href="special-topics-on-reporting-simulation-results.html#cb449-10" tabindex="-1"></a>          <span class="at">ICC =</span> sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(sd<span class="sc">^</span><span class="dv">2</span> ) )</span>
<span id="cb449-11"><a href="special-topics-on-reporting-simulation-results.html#cb449-11" tabindex="-1"></a>rr <span class="ot">=</span> <span class="fu">left_join</span>( ranef_vars1, ranef_vars2, <span class="at">by =</span> <span class="st">&quot;grp&quot;</span>, </span>
<span id="cb449-12"><a href="special-topics-on-reporting-simulation-results.html#cb449-12" tabindex="-1"></a>                <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;.null&quot;</span>, <span class="st">&quot;.full&quot;</span>) )</span>
<span id="cb449-13"><a href="special-topics-on-reporting-simulation-results.html#cb449-13" tabindex="-1"></a>rr <span class="ot">&lt;-</span> rr <span class="sc">%&gt;%</span></span>
<span id="cb449-14"><a href="special-topics-on-reporting-simulation-results.html#cb449-14" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">sd.red =</span> sd.full <span class="sc">/</span> sd.null )</span>
<span id="cb449-15"><a href="special-topics-on-reporting-simulation-results.html#cb449-15" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(rr, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">grp</th>
<th align="right">sd.null</th>
<th align="right">ICC.null</th>
<th align="right">sd.full</th>
<th align="right">ICC.full</th>
<th align="right">sd.red</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dataID</td>
<td align="right">0.39</td>
<td align="right">0.98</td>
<td align="right">0.39</td>
<td align="right">0.98</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">simID</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
<td align="right">0.00</td>
<td align="right">0.89</td>
</tr>
<tr class="odd">
<td align="left">Residual</td>
<td align="right">0.06</td>
<td align="right">0.02</td>
<td align="right">0.06</td>
<td align="right">0.02</td>
<td align="right">0.99</td>
</tr>
</tbody>
</table>
<!-- LWM: This is not working cleanly, and we are not seeing reduction in unexplained simulation variation at all ---- cut, update, do what? --->
</div>
</div>
<div id="what-to-do-with-warnings-in-simulations" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> What to do with warnings in simulations<a href="special-topics-on-reporting-simulation-results.html#what-to-do-with-warnings-in-simulations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sometimes our analytic strategy might give some sort of warning (or fail altogether).
For example, from the cluster randomized experiment case study we have:</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="special-topics-on-reporting-simulation-results.html#cb450-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101012</span>)  <span class="co"># (I picked this to show a warning.)</span></span>
<span id="cb450-2"><a href="special-topics-on-reporting-simulation-results.html#cb450-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">gen_cluster_RCT</span>( <span class="at">J =</span> <span class="dv">50</span>, <span class="at">n_bar =</span> <span class="dv">100</span>, <span class="at">sigma2_u =</span> <span class="dv">0</span> )</span>
<span id="cb450-3"><a href="special-topics-on-reporting-simulation-results.html#cb450-3" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>( Yobs <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Z <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>sid), <span class="at">data=</span>dat )</span></code></pre></div>
<pre><code>## boundary (singular) fit: see help(&#39;isSingular&#39;)</code></pre>
<p>We have to make a deliberate decision as to what to do about this:</p>
<ul>
<li>Keep these “weird” trials?</li>
<li>Drop them?</li>
</ul>
<p>Generally, when a method fails or gives a warning is something to investigate in its own right.
Ideally, failure would not be too common, meaning we could drop those trials, or keep them, without really impacting our overall results.
But one should at least know what one is ignoring.</p>
<p>If you decide to drop them, you should drop the entire simulation iteration including the other estimators, even if they worked fine!
If there is something particularly unusual about the dataset, then dropping for one estimator, and keeping for the others that maybe didn’t give a warning, but did struggle to estimate the estimand, would be unfair: in the final performance measures the estimators that did not give a warning could be being held to a higher standard, making the comparisons between estimators biased.</p>
<p>If your estimators generate warnings, you should calculate the rate of errors or warning messages as a performance measure.
Especially if you drop some trials, it is important to see how often things are acting pecularly.</p>
<p>As discussed earlier, the main tool for doing this is the <code>quietly()</code> function:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="special-topics-on-reporting-simulation-results.html#cb452-1" tabindex="-1"></a>quiet_lmer <span class="ot">=</span> <span class="fu">quietly</span>( lmer )</span>
<span id="cb452-2"><a href="special-topics-on-reporting-simulation-results.html#cb452-2" tabindex="-1"></a>qmod <span class="ot">&lt;-</span> <span class="fu">quiet_lmer</span>( Yobs <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Z <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>sid), <span class="at">data=</span>dat )</span>
<span id="cb452-3"><a href="special-topics-on-reporting-simulation-results.html#cb452-3" tabindex="-1"></a>qmod</span></code></pre></div>
<pre><code>## $result
## Linear mixed model fit by REML [&#39;lmerModLmerTest&#39;]
## Formula: ..1
##    Data: ..2
## REML criterion at convergence: 14026.44
## Random effects:
##  Groups   Name        Std.Dev.
##  sid      (Intercept) 0.0000  
##  Residual             0.9828  
## Number of obs: 5000, groups:  sid, 50
## Fixed Effects:
## (Intercept)            Z  
##   -0.013930    -0.008804  
## optimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings 
## 
## $output
## [1] &quot;&quot;
## 
## $warnings
## character(0)
## 
## $messages
## [1] &quot;boundary (singular) fit: see help(&#39;isSingular&#39;)\n&quot;</code></pre>
<p>You then might have, in your analyzing code:</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="special-topics-on-reporting-simulation-results.html#cb454-1" tabindex="-1"></a>analyze_data <span class="ot">&lt;-</span> <span class="cf">function</span>( dat ) {</span>
<span id="cb454-2"><a href="special-topics-on-reporting-simulation-results.html#cb454-2" tabindex="-1"></a>    </span>
<span id="cb454-3"><a href="special-topics-on-reporting-simulation-results.html#cb454-3" tabindex="-1"></a>    M1 <span class="ot">&lt;-</span> <span class="fu">quiet_lmer</span>( Yobs <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> Z <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>sid), <span class="at">data=</span>dat )</span>
<span id="cb454-4"><a href="special-topics-on-reporting-simulation-results.html#cb454-4" tabindex="-1"></a>    message1 <span class="ot">=</span> <span class="fu">ifelse</span>( <span class="fu">length</span>( M1<span class="sc">$</span>message ) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span> )</span>
<span id="cb454-5"><a href="special-topics-on-reporting-simulation-results.html#cb454-5" tabindex="-1"></a>    warning1 <span class="ot">=</span> <span class="fu">ifelse</span>( <span class="fu">length</span>( M1<span class="sc">$</span>warning ) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span> )</span>
<span id="cb454-6"><a href="special-topics-on-reporting-simulation-results.html#cb454-6" tabindex="-1"></a></span>
<span id="cb454-7"><a href="special-topics-on-reporting-simulation-results.html#cb454-7" tabindex="-1"></a>    <span class="co"># Compile our results</span></span>
<span id="cb454-8"><a href="special-topics-on-reporting-simulation-results.html#cb454-8" tabindex="-1"></a>    <span class="fu">tibble</span>( <span class="at">ATE_hat =</span> <span class="fu">coef</span>(M1)[<span class="st">&quot;Z&quot;</span>],</span>
<span id="cb454-9"><a href="special-topics-on-reporting-simulation-results.html#cb454-9" tabindex="-1"></a>            <span class="at">SE_hat =</span> <span class="fu">se.coef</span>(M1)[<span class="st">&quot;Z&quot;</span>],</span>
<span id="cb454-10"><a href="special-topics-on-reporting-simulation-results.html#cb454-10" tabindex="-1"></a>            <span class="at">message =</span> message1,</span>
<span id="cb454-11"><a href="special-topics-on-reporting-simulation-results.html#cb454-11" tabindex="-1"></a>            <span class="at">warning =</span> warning1 )</span>
<span id="cb454-12"><a href="special-topics-on-reporting-simulation-results.html#cb454-12" tabindex="-1"></a>}</span></code></pre></div>
<p>Now you have your primary estimates, and also flags for whether there was a convergence issue.
In the analysis section you can then evaluate what proportion of the time there was a warning or message, and then do subset analyses to those simulation trials where there was no such warning.</p>
<p>For example, in our cluster RCT running example, we know that ICC is an important driver of when these convergence issues might occur, so we can explore how often we get a convergence message by ICC level:</p>
<!-- JEP: The results seem to be missing the `message` variable, so these calculations are broken. -->
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="special-topics-on-reporting-simulation-results.html#cb455-1" tabindex="-1"></a>res <span class="sc">%&gt;%</span> </span>
<span id="cb455-2"><a href="special-topics-on-reporting-simulation-results.html#cb455-2" tabindex="-1"></a>  <span class="fu">group_by</span>( method, ICC ) <span class="sc">%&gt;%</span></span>
<span id="cb455-3"><a href="special-topics-on-reporting-simulation-results.html#cb455-3" tabindex="-1"></a>  <span class="fu">summarise</span>( <span class="at">message =</span> <span class="fu">mean</span>( message ) ) <span class="sc">%&gt;%</span></span>
<span id="cb455-4"><a href="special-topics-on-reporting-simulation-results.html#cb455-4" tabindex="-1"></a>  <span class="fu">pivot_wider</span>( <span class="at">names_from =</span> <span class="st">&quot;method&quot;</span>, <span class="at">values_from=</span><span class="st">&quot;message&quot;</span> )</span></code></pre></div>
<pre><code>## Warning: There were 15 warnings in `summarise()`.
## The first warning was:
## ℹ In argument: `message = mean(message)`.
## ℹ In group 1: `method = &quot;Agg&quot;` `ICC = 0`.
## Caused by warning in `mean.default()`:
## ! argument is not numeric or logical: returning NA
## ℹ Run `dplyr::last_dplyr_warnings()` to see the
##   14 remaining warnings.</code></pre>
<pre><code>## # A tibble: 5 × 4
##     ICC   Agg    LR   MLM
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   0      NA    NA    NA
## 2   0.2    NA    NA    NA
## 3   0.4    NA    NA    NA
## 4   0.6    NA    NA    NA
## 5   0.8    NA    NA    NA</code></pre>
<p>We see that when the ICC is 0 we get a lot of convergence issues, but as soon as we pull away from 0 it drops off considerably.
At this point we might decide to drop those runs with a message or keep them.
In this case, we decide to keep.
It should not matter much, except possibly when ICC = 0, and we know the convergence issues are driven by trying to estimate a 0 variance, and thus is in some sense expected.
Furthermore, we know people using these methods would likely ignore these messages, and thus we are faithfully capturing how these methods would be used in practice.
We might eventually, however, want to do a separate analysis of the ICC = 0 context to see if the MLM approach is actually falling apart, or if it is just throwing warnings.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="building-good-visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="case-study-comparing-different-estimators.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/jepusto/Designing-Simulations-in-R/edit/master/075-special-topics-on-reporting.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["Designing-Simulations-in-R.pdf", "Designing-Simulations-in-R.epub"],
  "search": {
    "engine": "lunr",
    "options": null
  },
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  },
  "toolbar": {
    "position": "fixed"
  },
  "info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
